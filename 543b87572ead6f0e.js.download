;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="dfc0b4e1-4328-b037-19cc-3ef79df7afd3")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,746788,e=>{"use strict";var t=e.i(872199),r=e.i(84466),i=e.i(344188);let s=async e=>{if(!e)return null;if(!(0,r.default)(e))return{message:"Invalid email address"};let{exists:t}=await (0,i.postJson)("/data/user/exists",{email:e});if(t)return{message:"Email already in use"}};e.s(["default",0,{isValidEmail:async e=>e?(0,r.default)(e)?void 0:{message:"Invalid email address"}:{message:"Must include valid email address"},email:s,username:async e=>{if(!e)return null;if(!(0,t.default)(e,{min:2,max:15}))return{message:"Your username must be between 2 and 15 characters"};if(!e.match(/^[0-9a-zA-Z]+$/))return{message:"Your username can only contain alphanumeric characters (letters A-Z, numbers 0-9)"};let{exists:r}=await (0,i.postJson)("/data/user/exists",{username:e});if(r)return{message:"Username is taken"}},teamUsername:async e=>{if(!e)return null;if(!(0,t.default)(e,{min:2,max:28}))return{message:"Your username must be between 2 and 28 characters"};if(!e.match(/^[0-9a-zA-Z-]+$/))return{message:"Username can only contain alphanumeric characters (letters A-Z, numbers 0-9) and hyphens."};if(e.match(/^-.*|.*-$|.*--.*/))return{message:"A username can not start or end with hyphens, or contain two consecutive hyphens."};let{exists:r}=await (0,i.postJson)("/data/user/exists",{username:e});if(r)return{message:"Username is taken"}},password:e=>e?(0,t.default)(e,{min:8})?void 0:{message:"Must be at least 8 characters"}:null,school:e=>null,replTitle:e=>{if(!(0,t.default)(e,{min:1,max:60}))return{message:"Titles must be between 1 and 60 characters"}},replDescription:e=>{if(!(0,t.default)(e,{min:0,max:1e3}))return{message:"Titles must be between 0 and 1000 characters"}},orgName:async e=>e?(0,t.default)(e,{min:2,max:40})?e.match(/^[0-9a-zA-Z ]+$/)?void 0:{message:"Organization name can only contain alphanumeric characters (letters A-Z, numbers 0-9)"}:{message:"Organization name must be between 2 and 40 characters"}:{message:"Organization name cannot be empty"},orgBio:async e=>{if(!(0,t.default)(e,{min:0,max:1e4}))return{message:"Bio must be between 0 and 10000 characters"}},workspaceName:async e=>e?(0,t.default)(e,{min:2,max:40})?e.match(/^[0-9a-zA-Z ]+$/)?void 0:{message:"Workspace name can only contain alphanumeric characters (letters A-Z, numbers 0-9)"}:{message:"Workspace name must be between 2 and 40 characters"}:{message:"Workspace name cannot be empty"}}])},68278,e=>{"use strict";var t=e.i(389959),r=e.i(830675),i=e.i(973245),s=e.i(951262);let a={},o=i.gql`
    mutation SaveUserAuth($input: SaveUserAuthInput!) {
  saveUserAuth(input: $input) {
    ... on CurrentUser {
      id
    }
    ... on UnauthorizedError {
      message
    }
    ... on UserError {
      message
    }
    ... on TooManyRequestsError {
      message
    }
    ... on ServiceUnavailable {
      message
    }
  }
}
    `;var n=e.i(294426);let l={type:"error",message:"Something unexpected happened, please try again."};function c(){let e,[i]=(e={...a,...void 0},s.useMutation(o,e));return(0,t.useCallback)(async({userCredential:e,oauthProviderId:t,scopes:s})=>{let a,o=(0,n.getAccessTokenFromCredential)(t,e);if(!o||!o.accessToken)return r.captureException(Error(`Failed to extract token from ${t} credential`)),l;try{a=await i({variables:{input:{provider:t,token:o.accessToken,scopes:s}}})}catch(e){return r.captureException(Error(`Failed to save ${t} Auth state`)),l}return a.data?"CurrentUser"!==a.data.saveUserAuth.__typename?{type:"error",message:a.data.saveUserAuth.message}:{type:"success"}:(r.captureException(Error(`Unexpected error trying to save ${t} Auth state`)),l)},[i])}e.s(["useSaveUserAuth",()=>c],68278)},444903,e=>{"use strict";var t=e.i(276385),r=e.i(116235);function i(e){return(0,t.jsx)(r.default,{...e,children:(0,t.jsx)("path",{d:"M20.34 8.5c-.128.1-2.38 1.37-2.38 4.192 0 3.265 2.866 4.42 2.952 4.449-.013.07-.456 1.582-1.512 3.122-.941 1.355-1.925 2.708-3.42 2.708-1.497 0-1.882-.869-3.61-.869-1.682 0-2.28.898-3.65.898-1.368 0-2.323-1.254-3.42-2.794C4.027 18.397 3 15.588 3 12.92c0-4.277 2.781-6.546 5.518-6.546 1.454 0 2.667.955 3.58.955.869 0 2.224-1.012 3.879-1.012.627 0 2.88.057 4.363 2.183ZM15.19 4.508c.685-.812 1.169-1.938 1.169-3.065 0-.156-.014-.314-.042-.442-1.113.042-2.438.741-3.237 1.668-.627.713-1.212 1.84-1.212 2.981 0 .172.029.343.042.398.07.014.185.029.3.029.998 0 2.254-.669 2.98-1.569Z"})})}e.s(["default",()=>i])},819229,e=>{"use strict";var t=e.i(276385),r=e.i(116235);function i(e){return(0,t.jsx)(r.default,{...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12Z",clipRule:"evenodd"})})}e.s(["default",()=>i])},936706,e=>{"use strict";var t=e.i(276385),r=e.i(116235);function i(e){return(0,t.jsx)(r.default,{...e,children:(0,t.jsx)("path",{d:"M0 .21h7.098l6.561 9.167L21.826 0l1.94.035-9.14 10.66L24 23.79h-7.095l-6.193-8.543L3.147 24h-1.91l8.536-10.001L0 .21Zm6.429 1.354H2.68L17.678 22.4h3.681L6.43 1.564Z"})})}e.s(["default",()=>i])},501005,e=>{"use strict";var t=e.i(221042);let r="473079ba-e99f-4e25-a635-e9b661c7dd3e",i=0,s=null;async function a(){let e=document.createElement("script");return e.src="https://js.hcaptcha.com/1/api.js?render=explicit&host=repl.it",new Promise((t,r)=>{e.onload=function e(t){return()=>{void 0===window.hcaptcha?setTimeout(()=>{e(t)},100):t()}}(()=>{s=null,t()}),e.onerror=()=>{i++,s=new Promise((e,t)=>{setTimeout(()=>{a().then(e,t)},1.7**i*1e3+Math.floor(500*Math.random()))}),5===i&&r(Error("Failed to load captcha script after 5 times"))},window.document.head.appendChild(e)})}async function o(e,i){if("true"===t.default.env.IS_CYPRESS_AUTOMATED_TEST||"true"===t.default.env.SKIP_HCAPTCHA)return"bypassed";s&&await s;let a=window.hcaptcha;return new Promise((t,s)=>{let o=document.createElement("div"),n=a.render(o,{sitekey:e||r,size:"invisible",callback:e=>{a.reset(n),window.document.body.contains(o)&&window.document.body.removeChild(o),t(e)},"open-callback":()=>{i&&i()},"close-callback":()=>{a.reset(n),window.document.body.contains(o)&&window.document.body.removeChild(o),s(Error("HCaptcha closed"))},"chalexpired-callback":()=>{a.reset(n),window.document.body.contains(o)&&window.document.body.removeChild(o),s(Error("HCaptcha challenge expired"))},"error-callback":()=>{a.reset(n),window.document.body.contains(o)&&window.document.body.removeChild(o),s(Error("HCaptcha render error"))},"expired-callback":()=>{a.reset(n),window.document.body.contains(o)&&window.document.body.removeChild(o),s(Error("HCaptcha render expired"))}});window.document.body.appendChild(o),a.execute(n)})}s=a(),e.s(["HCAPTCHA_SITE_KEY",0,r,"default",()=>o])},978486,e=>{"use strict";var t=e.i(43856),r=e.i(221586);e.s(["useGetAgentQueryPrompt",0,()=>{let e=(0,t.useSearchParams)(),i=e?.get("prompt"),s=e?.get("stack"),a=e?.get("referrer")??e?.get("ref");if(!i&&s)return{aiPrompt:"",aiPromptEncoded:"",directQueryPrompt:"",stackOption:s,referrer:a??void 0,source:"legacy"};if(i){if("storage2"===i){let e=(0,r.getLoggedOutExperiencePrompt)();if(e)return{aiPrompt:e.prompt,aiPromptEncoded:(0,r.getEncodedAiPrompt)(e.prompt),directQueryPrompt:e.prompt??"",stackOption:e.stack,referrer:a??void 0,source:"loggedOutExperience"}}return{aiPrompt:(0,r.getDecodedAiPrompt)(i),aiPromptEncoded:(0,r.getEncodedAiPrompt)(i),directQueryPrompt:i??"",stackOption:s||"Auto",referrer:a??void 0,source:"legacy"}}let o=new URLSearchParams((e?.get("goto")??"").split("?")[1]||""),n=o.get("prompt")??"",l=o.get("stack")??"",c=o.get("referrer")??o.get("ref");return{aiPrompt:(0,r.getDecodedAiPrompt)(n),aiPromptEncoded:(0,r.getEncodedAiPrompt)(n),directQueryPrompt:n??"",stackOption:l||"Auto",referrer:c??a??void 0,source:"legacy"}}])},536262,e=>{"use strict";var t=e.i(276385),r=e.i(116235);function i(e){return(0,t.jsx)(r.default,{...e,children:(0,t.jsx)("path",{d:"M12 2.25A9.751 9.751 0 1 1 2.25 12a.75.75 0 0 1 1.5 0 8.25 8.25 0 1 0 8.251-8.25 9 9 0 0 0-6.22 2.53l-.97.97H8a.75.75 0 0 1 0 1.5H3a.752.752 0 0 1-.133-.013l-.016-.003c-.014-.002-.026-.008-.04-.011-.033-.009-.066-.017-.098-.03-.03-.013-.056-.029-.083-.045a.746.746 0 0 1-.16-.118.746.746 0 0 1-.12-.16c-.015-.028-.031-.055-.043-.084A.748.748 0 0 1 2.25 8V3a.75.75 0 0 1 1.5 0v3.19l.988-.989a10.501 10.501 0 0 1 7.26-2.951H12Z"})})}e.s(["default",()=>i])},673920,e=>{"use strict";var t=e.i(389959);function r(e){let r=(0,t.useRef)(!1);(0,t.useEffect)(()=>{r.current||(r.current=!0,e())},[e])}e.s(["useEffectOnce",()=>r])},187505,e=>{"use strict";var t=e.i(389959),r=e.i(441329),i=e.i(858248),s=e.i(709485),a=e.i(782514);function o(){let e=(0,a.useTrackingHierarchy)(),o=(0,r.useIsInBonsaiWebview)();return{trackClick:(0,t.useCallback)(t=>{let r={...e,...t,isBonsai:o};(0,i.track)(s.events.CLICK,r)},[e,o])}}e.s(["useTrackClick",()=>o])},844941,e=>{"use strict";var t=e.i(276385),r=e.i(116235);function i(e){return(0,t.jsx)(r.default,{...e,children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M23.31 11.753a.75.75 0 0 1-.75.75h-1.523v2.698a.75.75 0 0 1-1.5 0v-2.698h-2.476v3.698a.75.75 0 0 1-1.5 0v-3.698h-3.219a5.17 5.17 0 0 1-7.103 4.051 5.168 5.168 0 0 1-3.182-4.806v-.008a5.168 5.168 0 0 1 10.268-.737H22.56a.75.75 0 0 1 .75.75Zm-12.417.043-.002-.03a3.668 3.668 0 0 0-7.334-.004 3.668 3.668 0 1 0 7.336.034Z",clipRule:"evenodd"})})}e.s(["default",()=>i])},414248,e=>{"use strict";var t=e.i(276385),r=e.i(389959),i=e.i(964304),s=e.i(785240),a=e.i(756841),o=e.i(183035),n=e.i(712771),l=e.i(979530),c=e.i(269848),d=e.i(416298),u=e.i(480028),m=e.i(446530),p=e.i(613355),g=e.i(136540);let h=(0,m.cssRecord)({input:[p.rcss.position.relative],label:[p.brandStyles.typography.micro,p.rcss.color.foregroundDimmest,p.rcss.position.absolute,p.rcss.top(12),p.rcss.left(16),p.rcss.zIndex(2)],field:[p.brandStyles.typography.body.small,p.rcss.border({width:2,color:u.tokens.backgroundDefault}),p.rcss.backgroundColor.backgroundHigher,p.rcss.color.foregroundDefault,p.rcss.borderRadius(8),p.rcss.position.relative,p.rcss.display.grid,p.rcss.pl(16),p.rcss.pb(8),p.rcss.pr(48),p.rcss.width("100%"),p.rcss.zIndex(1),{paddingTop:26}],fieldWithToggle:[p.brandStyles.typography.body.small,p.rcss.border({width:2,color:u.tokens.backgroundDefault}),p.rcss.backgroundColor.backgroundHigher,p.rcss.color.foregroundDefault,p.rcss.borderRadius(8),p.rcss.position.relative,p.rcss.display.grid,p.rcss.pl(16),p.rcss.pb(8),p.rcss.pr(80),p.rcss.width("100%"),p.rcss.zIndex(1),{paddingTop:26}],fieldIcon:[p.rcss.position.absolute,p.rcss.right(16),p.rcss.bottom(16),p.rcss.zIndex(2),{"&:hover":{backgroundColor:"transparent !important"}}],toggleIcon:[p.rcss.position.absolute,p.rcss.right(16),p.rcss.bottom(16),p.rcss.zIndex(2),{"&:hover":{backgroundColor:"transparent !important"}}],toggleIconWithValidation:[p.rcss.position.absolute,p.rcss.right(48),p.rcss.bottom(16),p.rcss.zIndex(2),{"&:hover":{backgroundColor:"transparent !important"}}]});e.s(["default",0,({label:e,name:m,type:p,value:f,showToggle:v=!0,autoComplete:y,onChange:w,onBlur:x,validationResults:b})=>{let j,[k,C]=(0,r.useState)(p),P=`${m}-${(0,r.useId)()}`,S=b?b[0]:void 0;if(S)switch("state"in S?S.state:S.severity){case"error":j=(0,t.jsx)(g.IconButton,{css:h.fieldIcon,alt:S.message,children:(0,t.jsx)(d.default,{size:24,color:u.tokens.accentNegativeDefault})});break;case"success":j=(0,t.jsx)(g.IconButton,{css:h.fieldIcon,alt:S.message,children:(0,t.jsx)(o.default,{size:24,color:u.tokens.accentPositiveDefault})});break;default:j=(0,t.jsx)(g.IconButton,{css:h.fieldIcon,alt:S.message,children:(0,t.jsx)(c.default,{size:24,color:u.tokens.outlineDimmer})})}else j=void 0;let I=(0,t.jsx)(g.IconButton,{css:S?h.toggleIconWithValidation:h.toggleIcon,alt:"password"===k?"Show password":"Hide password",onClick:()=>C("password"===k?"text":"password"),children:"password"===k?(0,t.jsx)(n.default,{size:24}):(0,t.jsx)(l.default,{size:24})});return(0,t.jsxs)(a.TextField,{css:h.input,isRequired:!0,onChange:w,onBlur:x,autoComplete:y,children:[(0,t.jsx)(s.Label,{css:h.label,htmlFor:P,children:e}),(0,t.jsx)(i.Input,{css:"password"===p&&v&&S?h.fieldWithToggle:h.field,id:P,type:k,name:m,value:f,autoCorrect:"off",autoCapitalize:"off"}),"password"===p&&v?I:null,S?j:null]})}])},273325,e=>{"use strict";var t=e.i(276385),r=e.i(389959),i=e.i(183035),s=e.i(269848),a=e.i(738623),o=e.i(414248),n=e.i(294426),l=e.i(673920),c=e.i(322823),d=e.i(858248),u=e.i(709485),m=e.i(746788),p=e.i(446530),g=e.i(613355),h=e.i(612372),f=e.i(887877),v=e.i(625484);let y=(0,p.cssRecord)({form:[g.rcss.colWithGap(8),g.rcss.width("100%")]});function w({onSubmit:e,mode:p,onRedirectingChange:g,seededEmail:w}){let[x,b]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),C=(0,c.useFormField)(w,m.default.isValidEmail);(0,l.useEffectOnce)(()=>{C.validate()});let P=async t=>{if(t.preventDefault(),x)return;b(!0);let r=await (0,a.getAuthTenant)({type:"email",email:C.value});if("error"===r.type){b(!1),e({error:r.message});return}await g(!0),(0,d.track)(u.events.AUTH_FORM_SSO_REQUESTED,{provider:"saml",authenticationType:p,isTeacher:"false"});let{tenantId:i,samlProviderId:s}=r;if("error"===(await (0,n.signInWithProvider)({tenantId:i,provider:{type:"saml",providerId:s}})).type){b(!1),e({error:n.signInWithProviderErrorMessage});return}b(!1),k(!0)},S=C.error?{message:C.error.message,severity:C.error.severity??"error"}:void 0;return(0,t.jsxs)(f.Form,{onSubmit:P,css:y.form,children:[(0,t.jsx)(o.default,{type:"text",label:"Company email",name:"username",autoComplete:"email",onBlur:C.handleBlur,validationResults:S?[S]:[],onChange:C.setValue,value:C.value}),(0,t.jsx)(v.View,{gap:24,children:(0,t.jsx)(h.default,{type:"submit",variant:"primary",stretch:!0,loading:x,disabled:!C.isValid||j,iconRight:x?(0,t.jsx)(s.default,{}):j?(0,t.jsx)(i.default,{}):void 0,dataCy:"saml-log-in-btn",text:"Log in with SSO"})})]})}e.s(["default",()=>w])},441648,751010,364839,285030,484059,832970,14950,e=>{"use strict";let t;var r,i=e.i(276385),s=e.i(761201),a=e.i(446530),o=e.i(613355),n=e.i(960178),l=e.i(625484);let c=(0,a.cssRecord)({signupFormEmailDisclaimerContainer:[o.rcss.width("100%")],signupFormEmailDisclaimer:[o.rcss.color.brandText,o.rcss.font.brandVariable,o.brandStyles.typography.caption.small,o.rcss.textAlign.center,o.rcss.width("100%")],link:[o.rcss.color.foregroundDefault,{fontWeight:700,textDecoration:"none"}]}),d=()=>(0,i.jsx)(l.View,{css:c.signupFormEmailDisclaimerContainer,children:(0,i.jsxs)(n.Text,{css:c.signupFormEmailDisclaimer,children:["By continuing, you agree to Replit's",(0,i.jsx)("br",{}),(0,i.jsx)("a",{css:c.link,href:s.LINKS_LEGAL.TERMS_OF_SERVICE,target:"_blank",children:"Terms of Service"})," ","and"," ",(0,i.jsx)("a",{css:c.link,href:s.LINKS_LEGAL.PRIVACY_POLICY,target:"_blank",children:"Privacy Policy"})]})});var u=e.i(252890),m=e.i(187505),p=e.i(480028),g=e.i(988676);let h=[o.rcss.align.center,o.rcss.colWithGap(16)],f=(0,a.cssRecord)({footerLinkWrapper:[o.brandStyles.typography.caption.small,o.rcss.textAlign.center],footerLink:[o.brandStyles.typography.caption.small,o.rcss.color.brandAccentStrongest,{":hover":{color:p.tokens.brandAccentStronger,backgroundColor:"transparent"}}],footerContainerNotModal:[...h,o.rcss.bottom(24)],footerContainerModal:[...h,o.rcss.pt(24)],heightWrapper:[o.rcss.height(132)],recaptchaDisclaimer:[o.rcss.textAlign.center,o.brandStyles.typography.caption.small,o.rcss.color.foregroundDimmest,{"& > a":{color:"inherit",textDecoration:"underline"},"& > a:hover":{textDecoration:"none"}}]}),v=({mode:e,isModal:t,onModeChange:r,className:s,appName:a})=>{let{trackClick:o}=(0,m.useTrackClick)(),l=i=>{i.preventDefault(),o({productArea:"auth",target:"login"===e?"sign_up_button":"log_in_button"}),(0,u.trackToggleAuth)({isLogin:"login"===e,authFormPlacement:t?"modal":"auth-page"}),r("login"===e?"signup":"login")};return(0,i.jsxs)(n.Text,{css:f.footerLinkWrapper,className:s,variant:"small",multiline:!1,children:["login"===e?`New to ${a||"Replit"}? `:"Already have an account? ",(0,i.jsx)("a",{role:"button",tabIndex:0,onKeyDown:e=>{"Enter"===e.key&&l(e)},onClick:e=>l(e),css:f.footerLink,children:"login"===e?"Sign up":"Log in"})]})},y=()=>(0,i.jsxs)(n.Text,{variant:"small",color:"dimmest",css:f.recaptchaDisclaimer,children:["This site is protected by reCAPTCHA Enterprise and the Google"," ",(0,i.jsx)("a",{href:"https://policies.google.com/privacy",children:"Privacy Policy"})," and"," ",(0,i.jsx)("a",{href:"https://policies.google.com/terms",children:"Terms of Service"})," apply."]});e.s(["AuthTypeToggle",0,v,"default",0,({isModal:e,mode:t,onModeChange:r})=>{let s=e?void 0:f.heightWrapper;return(0,i.jsx)(l.View,{css:s,children:(0,i.jsxs)(l.View,{css:e?f.footerContainerModal:f.footerContainerNotModal,children:[(0,i.jsx)(g.DividerH,{}),"signup"===t?(0,i.jsx)(l.View,{pb:24,children:(0,i.jsx)(d,{})}):null,(0,i.jsx)(v,{mode:t,isModal:e,onModeChange:r}),(0,i.jsx)(l.View,{row:!0,gap:16,align:"center",children:(0,i.jsx)(n.Text,{css:f.footerLinkWrapper,variant:"small",multiline:!1,children:(0,i.jsx)("a",{href:"https://replit.com/help",target:"_blank",rel:"noopener noreferrer",css:f.footerLink,children:"Get help"})})}),(0,i.jsx)(y,{})]})})}],441648);let w=(0,a.cssRecord)({self:[o.rcss.font.brandDefault,{fontWeight:512,fontSize:24,lineHeight:32/24}]});e.s(["default",0,({mode:e,privateDeployment:t,privateDevDomain:r})=>{let s="Create a Replit account";return"login"===e&&(s="Log in to your account"),t&&(s="Log in to access a private website"),r&&(s="Log in to access a private app"),(0,i.jsx)(n.Header,{variant:"headerDefault",level:1,css:w.self,children:s})}],751010);var x=e.i(221042),b=e.i(750854),j=e.i(389959),k=e.i(830675),C=e.i(183035),P=e.i(269848),S=e.i(571926),I=e.i(344188),E=e.i(858248);async function T({username:e,password:t,teacher:r,hCaptchaResponse:i,hCaptchaSiteKey:s}){var a;let o;try{o=await (0,I.postJson)("/login",{username:e,password:t,...r?{teacher:r}:{},hCaptchaResponse:i,hCaptchaSiteKey:s})}catch(e){return e.extras?.responseData?.status===401&&(e.status=e.extras.responseData.status),{isLoggedIn:!1,error:e}}return(a=o).isLoggedIn&&(0,E.identify)({id:a.id.toString(),email:a.email,roles:a.roles,verified:a.isVerified,emailPreference:a.emailNotifications,createdAt:a.timeCreated,...!!a.loginMethod&&{loginMethod:a.loginMethod},signupMethod:a.signupMethod??S.NONE_IDENTIFY_PROP}),o}var A=e.i(738623),R=e.i(414248),L=e.i(278598),_=e.i(700005);function U({redirectUrl:e}){let t=_.default.get("shouldUseMobileAppAuthComplete");return"string"!=typeof t||t.length<1?e:`/authComplete?redirectUrl=${encodeURI(e)}`}e.s(["default",()=>U],364839);var M=e.i(294426),D=e.i(501005),F=e.i(441329),V=e.i(709485),O=e.i(612372),H=e.i(887877),W=e.i(782514);let B=(0,a.cssRecord)({form:[o.rcss.colWithGap(8),o.rcss.width("100%")],secondaryAction:[o.rcss.width("100%"),o.rcss.textAlign.center,o.brandStyles.typography.caption.medium,o.rcss.color.brandAccentStrongest,{":hover":{color:p.tokens.brandAccentStronger,backgroundColor:"transparent"}}]});function z({onSubmit:e,trackSource:t,footer:r,emailField:s}){let[a,o]=(0,j.useState)(!1),[n,c]=(0,j.useState)(!1),[d,u]=(0,j.useState)(""),m=(0,b.useRouter)(),{surface:p}=(0,W.useTrackingHierarchy)(),g=async e=>{if(e.preventDefault(),a)return;(0,E.track)(V.events.AUTH_FORM_SUBMITTED,{mode:"login",method:"password",surface:p}),o(!0);let{fallthrough:t}=await h({emailOrUsername:s.value,password:d});t&&await f()},h=async({emailOrUsername:r,password:i})=>{let s;try{s=await (0,M.getRecaptchaToken)({action:"signInWithPassword"})}catch(e){return{fallthrough:!0}}let a=await (0,A.signInWithPassword)({emailOrUsername:r,rawPassword:i,clientType:"CLIENT_TYPE_WEB",recaptchaToken:s});if("error"===a.type)return c(!1),o(!1),e({error:a.message}),{fallthrough:!1};let n=await (0,M.setUserFromApiResponse)({response:a.session});if("error"===n.type)return c(!1),o(!1),e({error:n.message}),{fallthrough:!1};let l=await (0,A.setCookie)(n.user,{source:t});if("success"===l.type){o(!1),c(!0);let t=l.redirectUrl?U({redirectUrl:l.redirectUrl}):void 0;(0,L.saveLastLoginMethod)("password"),e({user:{id:l.userId,postLoginRedirectUrl:t},isLogin:!0})}else c(!1),o(!1),e({error:l.message,reauth:l.reauth});return{fallthrough:!1}},f=async()=>{let t;try{t=await (0,D.default)(void 0,()=>{(0,E.track)(V.events.AUTH_FORM_CAPTCHA_TRIGGERED,{authenticationType:"login"})})}catch(t){k.captureException(t,e=>e.setTag("bonsai",(0,F.isInNativeMobileAuthFlow)(m))),e({error:"Something went wrong trying to submit. Please try again."}),o(!1);return}let r=await T({username:s.value,password:d,hCaptchaResponse:t,hCaptchaSiteKey:D.HCAPTCHA_SITE_KEY});if("error"in r){let{error:t}=r;if(o(!1),e({error:t.message||"Something went wrong"}),t.status&&t.status>=500)throw t;return}let i=r.postLoginRedirectUrl?U({redirectUrl:r.postLoginRedirectUrl}):void 0;(0,L.saveLastLoginMethod)("password"),e({user:{id:r.id,postLoginRedirectUrl:i},isLogin:!0})};return(0,i.jsxs)(H.Form,{onSubmit:g,css:B.form,children:[(0,i.jsx)(R.default,{type:"text",label:"Email or username",name:"username",value:s.value,onChange:s.setValue,autoComplete:"email"}),(0,i.jsx)(R.default,{type:"password",label:"Password",name:"password",value:d,onChange:u}),(0,i.jsxs)(l.View,{gap:r?8:24,children:[(0,i.jsx)(O.default,{type:"submit",variant:"primary",stretch:!0,loading:a,disabled:!d||!s.value||n,iconRight:a?(0,i.jsx)(P.default,{}):n?(0,i.jsx)(C.default,{}):void 0,dataCy:"log-in-btn",text:"Log In"}),r||(0,i.jsx)(O.default,{variant:"clean",css:B.secondaryAction,onClick:()=>{window.location.href="/forgot"},text:"Forgot password?"}),!1]})]})}e.s(["default",()=>z],285030);var G=e.i(322823),N=e.i(978486),$=e.i(664152),Z=((r={})[r.Loaded=0]="Loaded",r[r.Skipped=1]="Skipped",r[r.Failed=2]="Failed",r);let Y="https://elements.stytch.com/telemetry.js";function Q(){return"true"===x.default.env.IS_CYPRESS_AUTOMATED_TEST}{let e=window.location.pathname;!Q()&&["/signup","/login"].some(t=>e.startsWith(t))&&K().catch(e=>k.captureException(e))}async function K(){let e=performance.now(),r=document.createElement("script");r.src=Y,r.async=!0;let i=new Promise(e=>{setTimeout(()=>{$.logger.error("Timeout while loading Stytch script"),e()},4e3)});t=Promise.race([new Promise(t=>{r.onload=()=>{let r=performance.now();$.logger.time("time to load Stytch script",r-e),t()},r.onerror=()=>{$.logger.error(`Error loading Stytch script at ${Y}`),t()},document.head.appendChild(r)}),i])}async function q(){if(Q())return 1;try{return await t,0}catch(e){return 2}}async function J(e){try{await Promise.race([X(e),new Promise((e,t)=>setTimeout(()=>t(Error("Could not process device fingerprint in 4s")),4e3))])}catch(e){return $.logger.error(`Error fetching device fingerprint data ${e.message}`),"N/A"}}async function X(e){if(await q()!==Z.Loaded)return;let{location:{host:t}}=window,r=t.startsWith("staging"),i=await window.GetTelemetryID(r?"public-token-test-f16841f0-b961-4442-93b3-751c8cfe0d8b":"public-token-live-88edc789-05cb-440a-a321-dab99f475524","https://telemetry.replit.com/submit");i&&""!==i.trim()?($.logger.info(`Successfully received the telemetryId from Stytch ${i}`,{telemetryId:i,userId:e}),await fetch("/telemetry",{method:"GET",headers:{"Content-Type":"application/json","telemetry-id":i,"user-id":e}})):$.logger.error("Client received an empty telemetryId",{userId:e})}e.s(["callDeviceFingerprinting",()=>J],484059);var ee=e.i(746788);e.i(140487);var et=e.i(127060);function er(e){return e.error?[{message:e.error.message,state:"error"}]:e.warning?[{message:e.warning.message,state:"warning"}]:e.value?e.isValid?[{message:"",state:"success"}]:e.touched?[{message:"",state:"loading"}]:void 0:void 0}let ei=(0,a.cssRecord)({form:[o.rcss.width("100%")]});function es({onSubmit:e,tracking:t={from:"explicit"},emailField:r}){let[s,a]=(0,j.useState)(!1),[o,n]=(0,j.useState)(!1),{surface:c}=(0,W.useTrackingHierarchy)(),d=(0,G.useFormField)("",ee.default.password),{directQueryPrompt:u}=(0,N.useGetAgentQueryPrompt)(),m=async i=>{let s;if(i.preventDefault(),(0,E.track)(V.events.AUTH_FORM_SUBMITTED,{mode:"signup",method:"password",surface:c}),a(!0),!r.isValid&&await r.validate()||!d.isValid&&d.validate())return void a(!1);try{s=await (0,M.getRecaptchaToken)({action:"signUpPassword"})}catch(t){e({error:"We failed to evaluate your browser integrity. Please refresh the page and try again. If the problem persists, check your browser and network configuration."});return}let o=await (0,A.signUpWithPassword)({email:r.value,rawPassword:d.value,clientType:"CLIENT_TYPE_WEB",recaptchaToken:s,source:t.from,referrerId:t.referrerId,aiPrompt:u||void 0});if("error"===o.type){n(!1),a(!1),e({error:o.message});return}let l=await (0,M.setUserFromApiResponse)({response:o.session});if("error"===l.type){n(!1),a(!1),e({error:l.message});return}let m=await (0,A.setCookie)(l.user,{source:t.from,referrerId:t.referrerId});if("success"===m.type){a(!1),n(!0),await J(m.userId.toString());let t=m.redirectUrl?U({redirectUrl:m.redirectUrl}):void 0;(0,et.sendCoframeConversionEvent)("signup"),(0,L.saveLastLoginMethod)("password"),e({user:{id:m.userId,postLoginRedirectUrl:t},isLogin:!1})}else n(!1),a(!1),e({error:m.message,reauth:m.reauth})},p=!r.value;return(0,i.jsx)("form",{onSubmit:m,css:ei.form,children:(0,i.jsxs)(l.View,{css:ei.form,gap:8,children:[(0,i.jsx)(R.default,{type:"text",name:"email",label:"Email",onBlur:r.handleBlur,validationResults:er(r),onChange:r.setValue,value:r.value,autoComplete:"email"}),(0,i.jsx)(R.default,{type:"password",label:"Password",name:"password",onBlur:d.handleBlur,validationResults:er(d),onChange:d.setValue,value:d.value}),(0,i.jsx)(l.View,{gap:4,children:(0,i.jsx)(O.default,{type:"submit",variant:"primary",stretch:!0,loading:s,disabled:!d.value||p||o,iconLeft:s?(0,i.jsx)(P.default,{}):o?(0,i.jsx)(C.default,{}):void 0,dataCy:"signup-create-account",text:"Create Account"})}),null]})})}e.s(["default",()=>es],832970);var ea=e.i(116235);function eo(e){return(0,i.jsx)(ea.default,{...e,children:(0,i.jsx)("path",{d:"M12 0c6.627 0 12 5.373 12 12 0 5.99-4.388 10.954-10.125 11.854V15.47h2.796L17.203 12h-3.328V9.749c0-.255.034-.509.112-.743.176-.528.578-.958 1.332-1.09.155-.027.325-.041.512-.041h1.513V4.922s-1.374-.234-2.686-.234c-2.742 0-4.533 1.66-4.533 4.668V12H7.078v3.469h3.047v8.385C4.388 22.954 0 17.99 0 12 0 5.373 5.373 0 12 0Z"})})}e.s(["default",()=>eo],14950)},182530,e=>{"use strict";var t=e.i(276385),r=e.i(913965);function i(e){return(0,t.jsxs)(r.default,{...e,children:[(0,t.jsx)("path",{fill:"#4285F4",fillRule:"evenodd",d:"M21.6 12.227c0-.71-.064-1.391-.182-2.046H12v3.869h5.382a4.6 4.6 0 0 1-1.996 3.018v2.509h3.232c1.891-1.741 2.982-4.305 2.982-7.35Z",clipRule:"evenodd"}),(0,t.jsx)("path",{fill:"#34A853",fillRule:"evenodd",d:"M12 22c2.7 0 4.963-.896 6.618-2.423l-3.232-2.509c-.895.6-2.04.955-3.386.955-2.605 0-4.81-1.76-5.596-4.123h-3.34v2.59A9.996 9.996 0 0 0 12 22Z",clipRule:"evenodd"}),(0,t.jsx)("path",{fill:"#FBBC05",fillRule:"evenodd",d:"M6.405 13.9c-.2-.6-.314-1.241-.314-1.9 0-.66.114-1.3.314-1.9V7.509H3.064A9.996 9.996 0 0 0 2 11.999c0 1.614.386 3.142 1.064 4.492l3.34-2.591Z",clipRule:"evenodd"}),(0,t.jsx)("path",{fill:"#EA4335",fillRule:"evenodd",d:"M12 5.977c1.468 0 2.786.505 3.822 1.496l2.869-2.868C16.959 2.99 14.695 2 12 2 8.09 2 4.709 4.24 3.063 7.51l3.341 2.59C7.191 7.736 9.395 5.977 12 5.977Z",clipRule:"evenodd"})]})}e.s(["default",()=>i])},192479,683743,149797,e=>{"use strict";var t=e.i(276385),r=e.i(750854),i=e.i(389959),s=e.i(830675),a=e.i(442121),o=e.i(269848),n=e.i(569910),l=e.i(694387),c=e.i(738623),d=e.i(844941),u=e.i(11029),m=e.i(536262),p=e.i(441648),g=e.i(751010),h=e.i(285030),f=e.i(273325),v=e.i(294426),y=e.i(832970),w=e.i(444903),x=e.i(14950),b=e.i(819229),j=e.i(182530),k=e.i(936706),C=e.i(446530),P=e.i(173703),S=e.i(613355),I=e.i(612372),E=e.i(140487),T=e.i(624782),A=e.i(625484);let R=(0,C.cssRecord)({ssoButton:[S.rcss.backgroundColor.brandBackgroundDarker,S.rcss.minHeight(40)],ssoButtonWrapper:[S.rcss.position.relative,S.rcss.width("100%")],lastUsedPill:[S.rcss.position.absolute,{top:0,right:0,transform:"translate(0, -50%)",pointerEvents:"none"}]}),L={[l.AppleProviderId]:w.default,[l.FacebookProviderId]:x.default,[l.GitHubProviderId]:b.default,[l.GoogleProviderId]:j.default,[l.XProviderId]:k.default},_=({id:e})=>{let r=L[e];return r?(0,t.jsx)(r,{size:20}):null},U=({onClick:e,iconLeft:r,text:i,customCss:s,showLastUsed:a,loading:n,...l})=>{let c=s?[R.ssoButton,s]:R.ssoButton,d=n?(0,t.jsx)(o.default,{size:20}):r;if((0,P.useIsShadesSurfaceChild)()){let{children:r,size:s,...o}=l;return(0,t.jsxs)(A.View,{css:R.ssoButtonWrapper,children:[(0,t.jsx)(E.Button,{style:{minHeight:40},variant:"default",onClick:e,stretch:!0,iconLeft:d,text:i,loading:n,...o}),a?(0,t.jsx)(T.Pill,{text:"Last used",variant:"filled",compact:!0,colorway:"grey",css:R.lastUsedPill}):null]})}return(0,t.jsxs)(A.View,{css:R.ssoButtonWrapper,children:[(0,t.jsx)(I.default,{css:c,variant:"secondary",onClick:e,stretch:!0,iconLeft:d,text:i,loading:n,...l}),a?(0,t.jsx)(T.Pill,{text:"Last used",variant:"filled",compact:!0,css:R.lastUsedPill}):null]})};e.s(["SsoButton",0,U,"SsoIcon",0,_],683743);var M=e.i(187505),D=e.i(858248),F=e.i(709485);let V=(0,C.cssRecord)({minimizedSection:[S.rcss.gap(8)],showMoreButton:[S.rcss.py(6)]}),O=[l.GoogleProviderId,l.GitHubProviderId,l.XProviderId,l.AppleProviderId],H=[...O,l.FacebookProviderId];function W({mode:e,onRedirectingChange:r,onSubmit:s,onEmailClick:a,replitAuthProps:o,additionalOptions:n}){let{trackClick:c}=(0,M.useTrackClick)(),[d,m]=(0,i.useState)(!1),p=(0,i.useMemo)(()=>o?.minimizedProviders??[],[o]),g=p.includes("email"),h=async t=>{let i=t.replace(".com","");c({productArea:"auth",target:`continue_with_${i}_button`}),(0,D.track)(F.events.AUTH_FORM_SSO_REQUESTED,{provider:i,authenticationType:e,isTeacher:"false"}),await r(!0),"error"===(await (0,v.signInWithProvider)({tenantId:void 0,provider:{type:"oauth",providerId:t}})).type&&s({error:v.signInWithProviderErrorMessage})},f="login"===e?H:O,{primaryProviders:y,minimizedProvidersList:w}=(0,i.useMemo)(()=>{function e(e){return!!o&&"facebook.com"===e}let t=f.filter(t=>p.includes(t.replace(".com",""))&&!e(t)),r=f.filter(r=>!t.includes(r)&&!e(r));return 0===r.length&&t.length>0&&(r.push(...t),t.length=0),{primaryProviders:r,minimizedProvidersList:t}},[f,p,o]);return(0,t.jsxs)(t.Fragment,{children:[[...y,...d?w:[]].map(e=>(0,t.jsx)(U,{text:`Continue with ${(0,l.getOAuthProviderName)(e)}`,iconLeft:(0,t.jsx)(_,{id:e}),customCss:o?.ssoButtonCss,onClick:()=>{if("facebook.com"===e){window.confirm('Facebook login is no longer supported. Click "Ok" to continue to password reset using the connected email address.')&&(window.location.href="/forgot");return}h(e)}},e)),o?(0,t.jsx)(U,{onClick:a,iconLeft:(0,t.jsx)(u.default,{}),text:"Continue with email",customCss:o?.ssoButtonCss}):null,n,(w.length>0||g)&&!d&&(0,t.jsx)(A.View,{css:V.minimizedSection,children:(0,t.jsx)(E.Button,{onClick:()=>{c({productArea:"auth",target:"more_options_button"}),m(!0)},css:V.showMoreButton,variant:"underlinedOnHover",colorway:"grey",stretch:!0,text:"More options"})})]})}e.s(["SsoOptionsList",()=>W,"oauthLoginProviders",0,H,"oauthSignupProviders",0,O],149797);var B=e.i(252890),z=e.i(322823),G=e.i(746788),N=e.i(480028),$=e.i(988676),Z=e.i(960178);let Y=(0,C.cssRecord)({mainControls:[S.rcss.width("100%"),S.rcss.px(12)],ssoContainer:[S.rcss.width("100%"),S.rcss.colWithGap(8)],samlLoginForm:[S.rcss.width("100%"),S.rcss.pb(32)],orText:[S.rcss.fontSize(N.tokens.fontSizeSmall)]});function Q({mode:e,onRedirectingChange:r,onModeChange:i,onSubmit:s,tracking:a,seededEmail:o,isModal:n}){return(0,t.jsxs)(t.Fragment,{children:["login"===e?(0,t.jsx)(K,{onRedirectingChange:r,onSubmit:s,tracking:a}):(0,t.jsx)(q,{onRedirectingChange:r,onSubmit:s,seededEmail:o,tracking:a}),(0,t.jsx)(p.default,{mode:e,isModal:n,onModeChange:i})]})}let K=({onRedirectingChange:e,onSubmit:r,tracking:s,replitAuthProps:a})=>{let[o,n]=(0,i.useState)("password"),l=(0,z.useFormField)("",G.default.isValidEmail);return(0,t.jsxs)(t.Fragment,{children:["password"===o?(0,t.jsx)(h.default,{onSubmit:r,trackSource:s.from,emailField:l}):null,"saml"===o?(0,t.jsx)(A.View,{css:Y.samlLoginForm,children:(0,t.jsx)(f.default,{onSubmit:r,mode:"login",onRedirectingChange:e,seededEmail:l.value})}):null,(0,t.jsxs)(A.View,{css:Y.ssoContainer,children:[(0,t.jsx)(J,{emailLoginType:o,setEmailLoginType:n}),(0,t.jsx)(W,{mode:"login",onRedirectingChange:e,onSubmit:r,replitAuthProps:a})]})]})},q=({onRedirectingChange:e,onSubmit:r,seededEmail:s,tracking:a})=>{let[o,n]=(0,i.useState)("initial"),l=(0,z.useFormField)(s||"",G.default.email);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(A.View,{css:Y.ssoContainer,align:"center",children:[(0,t.jsx)(W,{mode:"signup",onRedirectingChange:e,onSubmit:r}),"initial"===o?(0,t.jsx)(Z.Text,{css:Y.orText,children:"Or"}):(0,t.jsx)($.DividerH,{}),(0,t.jsx)(J,{emailLoginType:o,setEmailLoginType:n})]}),"password"===o?(0,t.jsx)(y.default,{onSubmit:r,seededEmail:s,tracking:a,emailField:l}):null,"saml"===o?(0,t.jsx)(f.default,{onSubmit:r,mode:"signup",onRedirectingChange:e,seededEmail:l.value}):null]})},J=({emailLoginType:e,setEmailLoginType:r})=>{let{trackClick:i}=(0,M.useTrackClick)();return"password"===e?(0,t.jsx)(U,{onClick:()=>{i({productArea:"auth",target:"switch_to_sso_button"}),r("saml")},iconLeft:(0,t.jsx)(d.default,{size:20}),text:"Use SSO login"}):"saml"===e?(0,t.jsx)(U,{onClick:()=>{i({productArea:"auth",target:"switch_to_email_button"}),r("password")},iconLeft:(0,t.jsx)(m.default,{size:20}),text:"Use email login"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.default,{dataCy:"auth-form-reveal-email",onClick:()=>{i({productArea:"auth",target:"email_and_password_button"}),r("password")},iconLeft:(0,t.jsx)(u.default,{size:20}),text:"Email & password",variant:"tertiary",stretch:!0}),(0,t.jsx)(I.default,{onClick:()=>{i({productArea:"auth",target:"sso_button"}),r("saml")},iconLeft:(0,t.jsx)(d.default,{size:20}),text:"Single sign-on (SSO)",variant:"tertiary",stretch:!0})]})},X=e=>{let{children:r,customHeader:s,isModal:a,mode:o,onRedirectingChange:n,onSubmit:l,initialTenantId:d,tracking:u,privateDeployment:m,privateDevDomain:p,renderForm:h}=e;return(0,i.useEffect)(()=>{let e=a?"modal":"auth-page";"login"===o?(0,B.trackLoginView)({from:u.from,location:u.location??"",authFormPlacement:e}):(0,B.trackSignupView)({from:u.from,location:u.location??"",authFormPlacement:e})},[o,a,u.from,u.location]),(0,i.useEffect)(()=>{void 0!==d&&(n(!0),(0,c.getAuthTenant)({type:"tenantId",tenantId:d}).then(e=>{"error"===e.type?l({error:e.message}):(0,v.signInWithProvider)({tenantId:e.tenantId,provider:{type:"saml",providerId:e.samlProviderId}}).then(e=>{if("error"===e.type)return void l({error:v.signInWithProviderErrorMessage})})}))},[d,n,l]),(0,t.jsxs)(t.Fragment,{children:[s?null:(0,t.jsx)(g.default,{mode:o,privateDeployment:m,privateDevDomain:p}),(0,t.jsxs)(A.View,{css:Y.mainControls,gap:12,children:[r,h?h(e):(0,t.jsx)(Q,{...e})]})]})},ee=(0,C.cssRecord)({container:[{margin:"auto",[S.media.max("mobileMax")]:[S.rcss.pt(96)]},S.rcss.colWithGap(32)],button:[S.rcss.color.foregroundDimmest]}),et=({email:e,providerId:r,onCancel:i})=>{let s=(0,l.getOAuthProviderName)(r);return s||(s="this provider",r===l.PasswordProviderId&&(s="your password")),(0,t.jsxs)(A.View,{css:ee.container,pt:128,children:[(0,t.jsx)(Z.Header,{variant:"headerDefault",level:1,children:"Verification required"}),(0,t.jsxs)(A.View,{gap:16,children:[(0,t.jsxs)(Z.Text,{variant:"subheadDefault",multiline:!0,children:["In order to log in with ",s,", you must verify"," ",e||"your email","."]}),(0,t.jsx)(Z.Text,{multiline:!0,children:"We've sent an email with a verification link. If you don't see it, check your spam folder, or contact support for assistance."})]}),(0,t.jsx)(E.Button,{size:"big",variant:"outlined",css:ee.button,onClick:()=>i(),text:"Back to log in"})]})};var er=e.i(364839),ei=e.i(969761),es=e.i(68278),ea=e.i(484059),eo=e.i(221586),en=e.i(956111),el=e.i(396776),ec=e.i(127060),ed=e.i(782514);let eu=[S.rcss.width(470),S.rcss.maxWidth("100%"),S.rcss.colWithGap(32),S.rcss.align.center,{margin:"auto","& *":[S.brandFontDefault]}],em=(0,C.cssRecord)({error:[S.rcss.mb(16)],container:[...eu,S.rcss.p(24)],containerModal:[...eu],loadingText:[S.rcss.fontSize(16),S.rcss.flex.shrink(1)]}),ep="redirecting";function eg({customHeader:e,isModal:d,mode:u,onModeChange:m,onSuccess:p,seededEmail:h,initialTenantId:f,tracking:y,privateDeployment:w,privateDevDomain:x,renderForm:b,replitAuthProps:j,signupCoupon:k}){let C=(0,a.useApolloClient)(),P=(0,r.useRouter)(),S=(0,en.useQueryParam)(ep,"boolean"),[I,E]=(0,i.useState)(S?{type:"redirecting"}:{type:"form"}),[R,L]=(0,i.useState)(),_=(0,i.useCallback)(async e=>{e?(E({type:"redirecting"}),await (0,en.updatePathWithQueryParams)({router:P,params:[{mode:"add",key:ep,value:"1"}]})):(E({type:"form"}),(0,en.updatePathWithQueryParams)({router:P,params:[{mode:"delete",key:ep}]}))},[P]),U=e=>{E({type:"redirecting",message:"SAML SSO required. Redirecting to the SSO login page..."}),setTimeout(async()=>{if("error"===(await (0,v.signInWithProvider)({tenantId:e.tenantId,provider:{type:"saml",providerId:e.samlProviderId}})).type){L({message:"Something went wrong. Please try logging in again.",colorway:"negative"}),E({type:"form"});return}},3e3)},M=(0,i.useCallback)(async e=>{if("error"in e&&e.error)return e.reauth?void U(e.reauth):(L({message:e.error,colorway:e.colorway??"negative"}),void await _(!1));if(!("user"in e&&e.user))throw Error("Expected error or user object");let t=e.user.postLoginRedirectUrl;if(null!=t&&t.length>0){window.location.href=t;return}e.isLogin||(0,B.attributeAcquisition)(e.user.id.toString()),p(e)},[_,p,L]),D=(0,es.useSaveUserAuth)();return(0,i.useEffect)(()=>{(0,v.handlePotentialOAuthRedirect)().then(async e=>{if("success"===e.type){if(null===e.result){"redirecting"===I.type&&_(!1);return}"redirecting"!==I.type&&_(!0);let t=await (0,c.setCookie)(e.result.user,{source:y.from,referrerId:y.referrerId});switch(t.type){case"success":{if(e.result?.providerId===l.GitHubProviderId&&await D({userCredential:e.result,oauthProviderId:l.GitHubProviderId,scopes:[]}),t.isNewUser&&(0,ec.sendCoframeConversionEvent)("signup"),(0,eo.getLoggedOutExperiencePrompt)()){window.location.href=ei.LOGGED_OUT_EXPERIENCE_REDIRECT_URL;return}let r=t.redirectUrl?(0,er.default)({redirectUrl:t.redirectUrl}):void 0;if(r){window.location.href=r;return}t.isNewUser&&e.result.providerId===l.GoogleProviderId&&await (0,ea.callDeviceFingerprinting)(t.userId.toString()),p({user:{id:t.userId},isLogin:!t.isNewUser});break}case"needs_email_verification":_(!1),E({type:"needs-email-verification",email:e.result.user.email,providerId:e.result.providerId}),await (0,v.signOut)(C);break;case"error":if(t.reauth)return void U(t.reauth);_(!1),L({message:t.message,colorway:"negative"}),await (0,v.signOut)(C);break;default:(0,n.default)(t)}return}switch(_(!1),e.treatment){case"requires-provider-link":L({message:`Please log in to ${e.context.email} with another method and link ${(0,l.getOAuthProviderName)(e.context.credential.providerId)} from the account page.`,colorway:"negative"});break;case"credential-conflict":L({message:"This provider cannot be used, please try another method.",colorway:"negative"});break;case"email-conflict":L({message:"This email cannot be used, please try another method.",colorway:"negative"});break;case"forbidden-operation":L({message:"That action is not permitted",colorway:"negative"});break;case"user-needs-email":{let t=(0,l.getOAuthProviderName)(e.credential.providerId);L({message:`Your ${t} account is missing an email address. To use it for Replit, you'll need to ${"login"===u?"log in":"sign up"} with another method and connect ${t} from the account page.`,colorway:"negative"}),await (0,v.signOut)(C);break}case"timeout":case"unhandled":case"unknown":L({message:"Something unexpected happened, please try again.",colorway:"negative"});break;default:(0,n.default)(e)}}).catch(e=>s.captureException(e))},[]),(0,t.jsx)(A.View,{css:d?em.containerModal:em.container,children:"form"===I.type?(0,t.jsx)(ed.TrackingHierarchyProvider,{hierarchy:{page:"auth_page",view:u},children:(0,t.jsxs)(X,{customHeader:e||!!k,isModal:d,mode:u,onModeChange:e=>{L(void 0),m(e)},onRedirectingChange:_,onSubmit:M,seededEmail:h,initialTenantId:f,tracking:y,privateDeployment:w,privateDevDomain:x,renderForm:b,replitAuthProps:j,children:[R?(0,t.jsx)(el.StatusBanner,{css:em.error,colorway:R.colorway,text:R.message}):null,k?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(A.View,{gap:16,align:"center",pb:8,children:[(0,t.jsxs)(A.View,{row:!0,gap:8,align:"center",justify:"center",children:[(0,t.jsx)("div",{children:"Using code"}),(0,t.jsx)(T.Pill,{colorway:"green",text:k.toUpperCase()})]}),(0,t.jsx)(g.default,{mode:"signup"})]})}):null]})}):"needs-email-verification"===I.type?(0,t.jsx)(et,{email:I.email,providerId:I.providerId,onCancel:()=>E({type:"form"})}):(0,t.jsxs)(A.View,{gap:8,align:"center",children:[(0,t.jsx)(o.default,{size:32}),I.message?(0,t.jsx)(Z.Text,{multiline:!0,css:em.loadingText,children:I.message}):null]})})}e.s(["default",()=>eg,"redirectingParam",0,ep],192479)}]);

//# debugId=dfc0b4e1-4328-b037-19cc-3ef79df7afd3
//# sourceMappingURL=1ef8188688f8a230.js.map