;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="66d881c0-7a10-7ad9-f907-875f81660c67")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,644920,968263,e=>{"use strict";function t(){let e,t,r={promise:new Promise((r,i)=>{e=r,t=i}),resolve:t=>{r.isFulfilled=!0,e(t)},reject:e=>{r.isFulfilled=!0,t(e)},isFulfilled:!1};return r}function r(e,i={wait:0}){let n=null,o=null,s=null,a=null;if(i.wait<0)throw Error("wait must be 0 or more");if(i.maxWait){if(i.maxWait<0)throw Error("maxWait must be 0 or more");if(i.maxWait<i.wait)throw Error("maxWait must be higher than wait")}function l(){o&&clearTimeout(o),o=null,a=null,n=null,s=null}function f(){if(!n||!o)throw Error("Expected to call debounced function once before flushing");let t=n,r=a;return l(),e(...r).then(e=>(t.resolve(e),e)).catch(e=>{throw t.reject(e),e})}return Object.assign((...e)=>{if(n){if(!o)throw Error("Did not expect to have deferred and no timeout");clearTimeout(o)}else n=t(),s=Date.now();return a=e,o=setTimeout(()=>{f()},function(){if(!i.maxWait)return i.wait;if(!s)throw Error("Expected scheduledAt to be a set when getting wait");let e=Date.now()-s;return Math.min(i.maxWait-e,i.wait)}()),n.promise},{isScheduled:()=>!!(n&&o),cancel:function(){if(!o||!n)throw Error("Expected to call debounced function once before cancelling");let e=n;l(),e.reject(Error("Debounced function cancelled"))},flush:f})}e.s(["default",()=>t],968263),e.s(["default",()=>r],644920)},995683,e=>{"use strict";var t=e.i(434989);class r{static from(e,t){return new r(e,t)}static isBuffer(e){return e instanceof r}asEncoding={};asBuffer=null;constructor(e,i){if(i&&"string"==typeof e)this.asEncoding[i]=e;else if(null==e)this.asBuffer=t.Buffer.alloc(0);else if(e instanceof t.Buffer)this.asBuffer=e;else if("string"==typeof e)this.asEncoding.utf8=e;else if(e instanceof ArrayBuffer)this.asBuffer=t.Buffer.from(e);else{if(e instanceof r)return e;e instanceof Uint8Array?this.asBuffer=t.Buffer.from(e):"object"==typeof e&&"object"==typeof e.asEncoding&&null!==e.asEncoding&&(e.asBuffer instanceof t.Buffer||null===e.asBuffer)&&(this.asBuffer=e.asBuffer||null,"string"==typeof e.asEncoding.base64&&(this.asEncoding={base64:e.asEncoding.base64}),"string"==typeof e.asEncoding.utf8&&(this.asEncoding={utf8:e.asEncoding.utf8}))}}toString(e="utf8"){if(void 0!==this.asEncoding[e])return this.asEncoding[e];let t=this.toBuffer().toString(e);return this.asEncoding[e]=t,t}toJSON(){return{asEncoding:{base64:this.toString("base64")},asBuffer:null}}get length(){return void 0!==this.asEncoding.utf8?this.asEncoding.utf8.length:this.toBuffer().length}toBuffer(){if(this.asBuffer)return this.asBuffer;for(let e in this.asEncoding){let r=this.asEncoding[e];if("string"==typeof r){let i=t.Buffer.from(r,e);return this.asBuffer=i,i}}return this.asBuffer=t.Buffer.alloc(0),this.asBuffer}}e.s(["default",()=>r])},328751,676480,e=>{"use strict";let t;var r=e.i(179302),i=e.i(753950),n=e.i(66796),o=(e.i(446840),e.i(78420));let s=0;class a{constructor(e,t,r,i){this.name=e,this.set=t,this.base=r,this.modified=i,this.id=s++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){if(e instanceof a&&(t=e),null==t?void 0:t.base)throw Error("Can not derive from a modified tag");let r=new a("string"==typeof e?e:"?",[],null,[]);if(r.set.push(r),t)for(let e of t.set)r.set.push(e);return r}static defineModifier(e){let t=new f(e);return e=>e.modified.indexOf(t)>-1?e:f.get(e.base||e,e.modified.concat(t).sort((e,t)=>e.id-t.id))}}let l=0;class f{constructor(e){this.name=e,this.instances=[],this.id=l++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(r=>{var i,n;return r.base==e&&(i=t,n=r.modified,i.length==n.length&&i.every((e,t)=>e==n[t]))});if(r)return r;let i=[],n=new a(e.name,i,e,t);for(let e of t)e.instances.push(n);let o=function(e){let t=[[]];for(let r=0;r<e.length;r++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(e[r]));return t.sort((e,t)=>t.length-e.length)}(t);for(let t of e.set)if(!t.modified.length)for(let e of o)i.push(f.get(t,e));return n}}new o.NodeProp;class c{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}c.empty=new c([],2,null);let h=a.define,d=h(),u=h(),m=h(u),g=h(u),p=h(),b=h(p),A=h(p),v=h(),w=h(v),B=h(),k=h(),C=h(),x=h(C),M=h(),E={comment:d,lineComment:h(d),blockComment:h(d),docComment:h(d),name:u,variableName:h(u),typeName:m,tagName:h(m),propertyName:g,attributeName:h(g),className:h(u),labelName:h(u),namespace:h(u),macroName:h(u),literal:p,string:b,docString:h(b),character:h(b),attributeValue:h(b),number:A,integer:h(A),float:h(A),bool:h(p),regexp:h(p),escape:h(p),color:h(p),url:h(p),keyword:B,self:h(B),null:h(B),atom:h(B),unit:h(B),modifier:h(B),operatorKeyword:h(B),controlKeyword:h(B),definitionKeyword:h(B),moduleKeyword:h(B),operator:k,derefOperator:h(k),arithmeticOperator:h(k),logicOperator:h(k),bitwiseOperator:h(k),compareOperator:h(k),updateOperator:h(k),definitionOperator:h(k),typeOperator:h(k),controlOperator:h(k),punctuation:C,separator:h(C),bracket:x,angleBracket:h(x),squareBracket:h(x),paren:h(x),brace:h(x),content:v,heading:w,heading1:h(w),heading2:h(w),heading3:h(w),heading4:h(w),heading5:h(w),heading6:h(w),contentSeparator:h(v),list:h(v),quote:h(v),emphasis:h(v),strong:h(v),link:h(v),monospace:h(v),strikethrough:h(v),inserted:h(),deleted:h(),changed:h(),invalid:h(),meta:M,documentMeta:h(M),annotation:h(M),processingInstruction:h(M),definition:a.defineModifier("definition"),constant:a.defineModifier("constant"),function:a.defineModifier("function"),standard:a.defineModifier("standard"),local:a.defineModifier("local"),special:a.defineModifier("special")};for(let e in E){let t=E[e];t instanceof a&&(t.name=e)}!function(e,t){let r=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)r[e.id]=t.class;else r[t.tag.id]=t.class;let{scope:i,all:n=null}={}}([{tag:E.link,class:"tok-link"},{tag:E.heading,class:"tok-heading"},{tag:E.emphasis,class:"tok-emphasis"},{tag:E.strong,class:"tok-strong"},{tag:E.keyword,class:"tok-keyword"},{tag:E.atom,class:"tok-atom"},{tag:E.bool,class:"tok-bool"},{tag:E.url,class:"tok-url"},{tag:E.labelName,class:"tok-labelName"},{tag:E.inserted,class:"tok-inserted"},{tag:E.deleted,class:"tok-deleted"},{tag:E.literal,class:"tok-literal"},{tag:E.string,class:"tok-string"},{tag:E.number,class:"tok-number"},{tag:[E.regexp,E.escape,E.special(E.string)],class:"tok-string2"},{tag:E.variableName,class:"tok-variableName"},{tag:E.local(E.variableName),class:"tok-variableName tok-local"},{tag:E.definition(E.variableName),class:"tok-variableName tok-definition"},{tag:E.special(E.variableName),class:"tok-variableName2"},{tag:E.definition(E.propertyName),class:"tok-propertyName tok-definition"},{tag:E.typeName,class:"tok-typeName"},{tag:E.namespace,class:"tok-namespace"},{tag:E.className,class:"tok-className"},{tag:E.macroName,class:"tok-macroName"},{tag:E.propertyName,class:"tok-propertyName"},{tag:E.operator,class:"tok-operator"},{tag:E.comment,class:"tok-comment"},{tag:E.meta,class:"tok-meta"},{tag:E.invalid,class:"tok-invalid"},{tag:E.punctuation,class:"tok-punctuation"}]);class D{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}offset(e,t){return new D(this.fromA+e,this.toA+e,this.fromB+t,this.toB+t)}}function O(e,t,r,i,n,o){if(e==i)return[];let s=R(e,t,r,i,n,o),a=V(e,t+s,r,i,n+s,o);t+=s,r-=a,n+=s;let l=r-t,f=(o-=a)-n;if(!l||!f)return[new D(t,r,n,o)];if(l>f){let s=e.slice(t,r).indexOf(i.slice(n,o));if(s>-1)return[new D(t,t+s,n,n),new D(t+s+f,r,o,o)]}else if(f>l){let s=i.slice(n,o).indexOf(e.slice(t,r));if(s>-1)return[new D(t,t,n,n+s),new D(r,r,n+s+l,o)]}if(1==l||1==f)return[new D(t,r,n,o)];let c=function e(t,r,i,n,o,s){let a=i-r,l=s-o;if(a<l){let a=e(n,o,s,t,r,i);return a&&[a[1],a[0],a[2]]}return a<4||2*l<a?null:G(t,r,i,n,o,s,Math.floor(a/4),-1)}(e,t,r,i,n,o);if(c){let[s,a,l]=c;return O(e,t,s,i,n,a).concat(O(e,s+l,r,i,a+l,o))}return function(e,t,r,i,n,o){let s=r-t,a=o-n;if(S<1e9&&Math.min(s,a)>16*S)return Math.min(s,a)>64*S?[new D(t,r,n,o)]:F(e,t,r,i,n,o);let l=Math.ceil((s+a)/2);N.reset(l),L.reset(l);let f=(r,o)=>e.charCodeAt(t+r)==i.charCodeAt(n+o),c=(t,n)=>e.charCodeAt(r-t-1)==i.charCodeAt(o-n-1),h=(s-a)%2!=0?L:null,d=h?null:N;for(let u=0;u<l;u++){if(u>S)return F(e,t,r,i,n,o);let m=N.advance(u,s,a,l,h,!1,f)||L.advance(u,s,a,l,d,!0,c);if(m)return function(e,t,r,i,n,o,s,a){let l=!1;return(I(e,i)||++i!=r||(l=!0),I(n,a)||++a!=s||(l=!0),l)?[new D(t,r,o,s)]:O(e,t,i,n,o,a).concat(O(e,i,r,n,a,s))}(e,t,r,t+m[0],i,n,o,n+m[1])}return[new D(t,r,n,o)]}(e,t,r,i,n,o)}let S=1e9;class y{constructor(){this.vec=[]}reset(e){this.len=e<<1;for(let e=0;e<this.len;e++)this.vec[e]=-1;this.vec[e+1]=0,this.start=this.end=0}advance(e,t,r,i,n,o,s){for(let a=-e+this.start;a<=e-this.end;a+=2){let l=i+a,f=a==-e||a!=e&&this.vec[l-1]<this.vec[l+1]?this.vec[l+1]:this.vec[l-1]+1,c=f-a;for(;f<t&&c<r&&s(f,c);)f++,c++;if(this.vec[l]=f,f>t)this.end+=2;else if(c>r)this.start+=2;else if(n){let e=i+(t-r)-a;if(e>=0&&e<this.len&&-1!=n.vec[e]){if(o){let r=n.vec[e];if(r>=t-f)return[r,i+r-e]}else if(f>=t-n.vec[e])return[f,c]}}}return null}}let N=new y,L=new y;function T(e,t){let r=1,i=Math.min(e,t);for(;r<i;)r<<=1;return r}function R(e,t,r,i,n,o){if(t==r||t==o||e.charCodeAt(t)!=i.charCodeAt(n))return 0;let s=T(r-t,o-n);for(let a=t,l=n;;){let n=a+s,f=l+s;if(n>r||f>o||e.slice(a,n)!=i.slice(l,f)){if(1==s)return a-t-!I(e,a);s>>=1}else{if(n==r||f==o)return n-t;a=n,l=f}}}function V(e,t,r,i,n,o){if(t==r||n==o||e.charCodeAt(r-1)!=i.charCodeAt(o-1))return 0;let s=T(r-t,o-n);for(let a=r,l=o;;){let o=a-s,f=l-s;if(o<t||f<n||e.slice(o,a)!=i.slice(f,l)){if(1==s)return r-a-!I(e,a);s>>=1}else{if(o==t||f==n)return r-o;a=o,l=f}}}function G(e,t,r,i,n,o,s,a){let l=i.slice(n,o),f=null;for(;;){if(f||s<a)return f;for(let a=t+s;;){!I(e,a)&&a++;let c=a+s;if(I(e,c)||(c+=c==a+1?1:-1),c>=r)break;let h=e.slice(a,c),d=-1;for(;-1!=(d=l.indexOf(h,d+1));){let s=R(e,c,r,i,n+d+h.length,o),l=V(e,t,a,i,n,n+d),u=h.length+s+l;(!f||f[2]<u)&&(f=[a-l,n+d-l,u])}a=c}if(a<0)return f;s>>=1}}function F(e,t,r,i,n,o){let s,a=r-t,l=o-n;if(a<l){let l=G(i,n,o,e,t,r,Math.floor(a/6),50);s=l&&[l[1],l[0],l[2]]}else s=G(e,t,r,i,n,o,Math.floor(l/6),50);if(!s)return[new D(t,r,n,o)];let[f,c,h]=s;return O(e,t,f,i,n,c).concat(O(e,f+h,r,i,c+h,o))}function W(e,t){for(let r=1;r<e.length;r++){let i=e[r-1],n=e[r];i.toA>n.fromA-t&&i.toB>n.fromB-t&&(e[r-1]=new D(i.fromA,n.toA,i.fromB,n.toB),e.splice(r--,1))}}try{t=RegExp("[\\p{Alphabetic}\\p{Number}]","u")}catch(e){}function j(e){return e>48&&e<58||e>64&&e<91||e>96&&e<123}function P(e,r){if(r==e.length)return 0;let i=e.charCodeAt(r);return i<192?+!!j(i):t?H(i)&&r!=e.length-1?2*!!t.test(e.slice(r,r+2)):+!!t.test(String.fromCharCode(i)):0}function U(e,r){if(!r)return 0;let i=e.charCodeAt(r-1);return i<192?+!!j(i):t?z(i)&&1!=r?2*!!t.test(e.slice(r-2,r)):+!!t.test(String.fromCharCode(i)):0}function q(e,t,r){if(t==e.length||!U(e,t))return t;for(let i=t,n=t+r;;){let r=P(e,i);if(!r)return i;if((i+=r)>n)return t}}function K(e,t,r){if(!t||!P(e,t))return t;for(let i=t,n=t-r;;){let r=U(e,i);if(!r)return i;if((i-=r)<n)return t}}let H=e=>e>=55296&&e<=56319,z=e=>e>=56320&&e<=57343;function I(e,t){return!t||t==e.length||!H(e.charCodeAt(t-1))||!z(e.charCodeAt(t))}function $(e,t,r){var i;return S=(null!=(i=null==r?void 0:r.scanLimit)?i:1e9)>>1,function(e,t,r){for(;;){W(r,1);let i=!1;for(let n=0;n<r.length;n++){let o=r[n],s,a;(s=R(e,o.fromA,o.toA,t,o.fromB,o.toB))&&(o=r[n]=new D(o.fromA+s,o.toA,o.fromB+s,o.toB)),(a=V(e,o.fromA,o.toA,t,o.fromB,o.toB))&&(o=r[n]=new D(o.fromA,o.toA-a,o.fromB,o.toB-a));let l=o.toA-o.fromA,f=o.toB-o.fromB;if(l&&f)continue;let c=o.fromA-(n?r[n-1].toA:0),h=(n<r.length-1?r[n+1].fromA:e.length)-o.toA;if(!c||!h)continue;let d=l?e.slice(o.fromA,o.toA):t.slice(o.fromB,o.toB);c<=d.length&&e.slice(o.fromA-c,o.fromA)==d.slice(d.length-c)?(r[n]=new D(o.fromA-c,o.toA-c,o.fromB-c,o.toB-c),i=!0):h<=d.length&&e.slice(o.toA,o.toA+h)==d.slice(0,h)&&(r[n]=new D(o.fromA+h,o.toA+h,o.fromB+h,o.toB+h),i=!0)}if(!i)break}return r}(e,t,O(e,0,e.length,t,0,t.length))}function Y(e,t,r){return function(e,t,r){for(let i=0,n=0;n<e.length;n++){let o=e[n],s=o.toA-o.fromA,a=o.toB-o.fromB;if(s&&a||s>3||a>3){let l=n==e.length-1?t.length:e[n+1].fromA,f=o.fromA-i,c=l-o.toA,h=K(t,o.fromA,Math.min(f,5)),d=q(t,o.toA,Math.min(c,5)),u=o.fromA-h,m=d-o.toA;if(!s||!a){let c,g,p=Math.max(s,a),[b,A,v]=s?[t,o.fromA,o.toA]:[r,o.fromB,o.toB];u&&m?(p>u&&t.slice(h,o.fromA)==b.slice(v-u,v)?(h=(o=e[n]=new D(h,h+s,o.fromB-u,o.toB-u)).fromA,d=q(t,o.toA,Math.min(l-o.toA,5))):p>m&&t.slice(o.toA,d)==b.slice(A,A+m)&&(d=(o=e[n]=new D(d-s,d,o.fromB+m,o.toB+m)).toA,h=K(t,o.fromA,Math.min(o.fromA-i,5))),u=o.fromA-h,m=d-o.toA):!u&&!m&&(g=o.fromA-(c=function(e,t,r){for(let i=t,n=t-r;;){let r=i?e.charCodeAt(i-1):10;if(10==r)return i;if(--i<n||32!=r&&9!=r)return t}}(t,o.fromA,f)))&&t.slice(c,o.fromA)==b.slice(v-g,v)&&(o=e[n]=new D(c,c+s,o.fromB-g,o.toB-g))}(u||m)&&(o=e[n]=new D(o.fromA-u,o.toA+m,o.fromB-u,o.toB+m)),i=o.toA}}return W(e,3),e}($(e,t,r),e,t)}let J=i.Facet.define({combine:e=>e[0]}),_=i.StateEffect.define(),Q=i.StateField.define({create:e=>null,update(e,t){for(let r of t.effects)r.is(_)&&(e=r.value);return e}});class X{constructor(e,t,r,i,n){this.changes=e,this.fromA=t,this.toA=r,this.fromB=i,this.toB=n}offset(e,t){return e||t?new X(this.changes,this.fromA+e,this.toA+e,this.fromB+t,this.toB+t):this}get endA(){return Math.max(this.fromA,this.toA-1)}get endB(){return Math.max(this.fromB,this.toB-1)}static build(e,t,r){return et(Y(e.toString(),t.toString(),r),e,t,0,0)}static updateA(e,t,r,i,n){return en(ei(e,i,!0,r.length),e,t,r,n)}static updateB(e,t,r,i,n){return en(ei(e,i,!1,t.length),e,t,r,n)}}function Z(e,t,r,i){let n=r.lineAt(e),o=i.lineAt(t);return n.to==e&&o.to==t&&e<r.length&&t<i.length?[e+1,t+1]:[n.from,o.from]}function ee(e,t,r,i){let n=r.lineAt(e),o=i.lineAt(t);return n.from==e&&o.from==t?[e,t]:[n.to+1,o.to+1]}function et(e,t,r,i,n){let o=[];for(let s=0;s<e.length;s++){let a=e[s],[l,f]=Z(a.fromA+i,a.fromB+n,t,r),[c,h]=ee(a.toA+i,a.toB+n,t,r),d=[a.offset(-l+i,-f+n)];for(;s<e.length-1;){let o=e[s+1],[a,u]=Z(o.fromA+i,o.fromB+n,t,r);if(a>c+1&&u>h+1)break;d.push(o.offset(-l+i,-f+n)),[c,h]=ee(o.toA+i,o.toB+n,t,r),s++}o.push(new X(d,l,Math.max(l,c),f,Math.max(f,h)))}return o}function er(e,t,r,i){let n=0,o=e.length;for(;;){if(n==o){let i=0,o=0;n&&({toA:i,toB:o}=e[n-1]);let s=t-(r?i:o);return[i+s,o+s]}let s=n+o>>1,a=e[s],[l,f]=r?[a.fromA,a.toA]:[a.fromB,a.toB];if(l>t)o=s;else{if(!(f<=t))return i?[a.fromA,a.fromB]:[a.toA,a.toB];n=s+1}}}function ei(e,t,r,i){let n=[];return t.iterChangedRanges((o,s,a,l)=>{let f=0,c=r?t.length:i,h=0,d=r?i:t.length;o>1e3&&([f,h]=er(e,o-1e3,r,!0)),s<t.length-1e3&&([c,d]=er(e,s+1e3,r,!1));let u=l-a-(s-o),m,[g,p]=r?[u,0]:[0,u];n.length&&(m=n[n.length-1]).toA>=f?n[n.length-1]={fromA:m.fromA,fromB:m.fromB,toA:c,toB:d,diffA:m.diffA+g,diffB:m.diffB+p}:n.push({fromA:f,toA:c,fromB:h,toB:d,diffA:g,diffB:p})}),n}function en(e,t,r,i,n){if(!e.length)return t;let o=[];for(let s=0,a=0,l=0,f=0;;s++){let c=s==e.length?null:e[s],h=c?c.fromA+a:r.length,d=c?c.fromB+l:i.length;for(;f<t.length;){let e=t[f];if(e.toA+a>h||e.toB+l>d)break;o.push(e.offset(a,l)),f++}if(!c)break;let u=c.toA+a+c.diffA,m=c.toB+l+c.diffB;for(let e of et(Y(r.sliceString(h,u),i.sliceString(d,m),n),r,i,h,d))o.push(e);for(a+=c.diffA,l+=c.diffB;f<t.length;){let e=t[f];if(e.fromA+a>u&&e.fromB+l>m)break;f++}}return o}let eo={scanLimit:500},es=r.ViewPlugin.fromClass(class{constructor(e){({deco:this.deco,gutter:this.gutter}=eu(e))}update(e){var t,r,i,n;(e.docChanged||e.viewportChanged||(t=e.startState,r=e.state,t.field(Q,!1)!=r.field(Q,!1))||(i=e.startState,n=e.state,i.facet(J)!=n.facet(J)))&&({deco:this.deco,gutter:this.gutter}=eu(e.view))}},{decorations:e=>e.deco}),ea=i.Prec.low((0,r.gutter)({class:"cm-changeGutter",markers:e=>{var t;return(null==(t=e.plugin(es))?void 0:t.gutter)||i.RangeSet.empty}})),el=r.Decoration.line({class:"cm-changedLine"}),ef=r.Decoration.mark({class:"cm-changedText"}),ec=r.Decoration.mark({tagName:"ins",class:"cm-insertedLine"}),eh=r.Decoration.mark({tagName:"del",class:"cm-deletedLine"}),ed=new class extends r.GutterMarker{constructor(){super(...arguments),this.elementClass="cm-changedLineGutter"}};function eu(e){let t=e.state.field(Q),{side:r,highlightChanges:n,markGutter:o}=e.state.facet(J),s="a"==r,a=new i.RangeSetBuilder,l=o?new i.RangeSetBuilder:null,{from:f,to:c}=e.viewport;for(let r of t){if((s?r.fromA:r.fromB)>=c)break;(s?r.toA:r.toB)>f&&function(e,t,r,i,n,o){let s=r?e.fromA:e.fromB,a=r?e.toA:e.toB,l=0;if(s!=a){n.add(s,s,el),n.add(s,a,r?eh:ec),o&&o.add(s,s,ed);for(let f=t.iterRange(s,a-1),c=s;!f.next().done;){if(f.lineBreak){c++,n.add(c,c,el),o&&o.add(c,c,ed);continue}let t=c+f.value.length;if(i)for(;l<e.changes.length;){let i=e.changes[l],o=s+(r?i.fromA:i.fromB),a=s+(r?i.toA:i.toB),f=Math.max(c,o),h=Math.min(t,a);if(f<h&&n.add(f,h,ef),a<t)l++;else break}c=t}}}(r,e.state.doc,s,n,a,l)}return{deco:a.finish(),gutter:l&&l.finish()}}class em extends r.WidgetType{constructor(e){super(),this.height=e}eq(e){return this.height==e.height}toDOM(){let e=document.createElement("div");return e.className="cm-mergeSpacer",e.style.height=this.height+"px",e}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}let eg=i.StateEffect.define({map:(e,t)=>e.map(t)}),ep=i.StateField.define({create:()=>r.Decoration.none,update:(e,t)=>{for(let e of t.effects)if(e.is(eg))return e.value;return e.map(t.changes)},provide:e=>r.EditorView.decorations.from(e)});function eb(e,t){if(e.size!=t.size)return!1;let r=e.iter(),i=t.iter();for(;r.value;){if(r.from!=i.from||Math.abs(r.value.spec.widget.height-i.value.spec.widget.height)>1)return!1;r.next(),i.next()}return!0}let eA=i.StateEffect.define({map:(e,t)=>t.mapPos(e)});class ev extends r.WidgetType{constructor(e){super(),this.lines=e}eq(e){return this.lines==e.lines}toDOM(e){let t=document.createElement("div");return t.className="cm-collapsedLines",t.textContent="⦚ "+e.state.phrase("$ unchanged lines",this.lines)+" ⦚",t.addEventListener("click",t=>{let r=e.posAtDOM(t.target);e.dispatch({effects:eA.of(r)});let{side:i,sibling:n}=e.state.facet(J);n&&n().dispatch({effects:eA.of(function(e,t,r){let i=0,n=0;for(let o=0;;o++){let s=o<t.length?t[o]:null;if(!s||(r?s.fromA:s.fromB)>=e)return n+(e-i);[i,n]=r?[s.toA,s.toB]:[s.toB,s.toA]}}(r,e.state.field(Q),"a"==i))})}),t}ignoreEvent(e){return e instanceof MouseEvent}get estimatedHeight(){return 27}}let ew=i.StateField.define({create:e=>r.Decoration.none,update(e,t){for(let r of(e=e.map(t.changes),t.effects))r.is(eA)&&(e=e.update({filter:e=>e!=r.value}));return e},provide:e=>r.EditorView.decorations.from(e)});function eB({margin:e=3,minSize:t=4}){return ew.init(n=>(function(e,t,n){let o=new i.RangeSetBuilder,s="a"==e.facet(J).side,a=e.field(Q),l=1;for(let i=0;;i++){let f=i<a.length?a[i]:null,c=i?l+t:1,h=f?e.doc.lineAt(s?f.fromA:f.fromB).number-1-t:e.doc.lines,d=h-c+1;if(d>=n&&o.add(e.doc.line(c).from,e.doc.line(h).to,r.Decoration.replace({widget:new ev(d),block:!0})),!f)break;l=e.doc.lineAt(Math.min(e.doc.length,s?f.toA:f.toB)).number}return o.finish()})(n,e,t))}let ek=r.EditorView.styleModule.of(new n.StyleModule({".cm-mergeView":{overflowY:"auto"},".cm-mergeViewEditors":{display:"flex",alignItems:"stretch"},".cm-mergeViewEditor":{flexGrow:1,flexBasis:0,overflow:"hidden"},".cm-merge-revert":{width:"1.6em",flexGrow:0,flexShrink:0,position:"relative"},".cm-merge-revert button":{position:"absolute",display:"block",width:"100%",boxSizing:"border-box",textAlign:"center",background:"none",border:"none",font:"inherit",cursor:"pointer"}})),eC=r.EditorView.baseTheme({".cm-mergeView & .cm-scroller, .cm-mergeView &":{height:"auto !important",overflowY:"visible !important"},"&.cm-merge-a .cm-changedLine, .cm-deletedChunk":{backgroundColor:"rgba(160, 128, 100, .08)"},"&.cm-merge-b .cm-changedLine":{backgroundColor:"rgba(100, 160, 128, .08)"},"&light.cm-merge-a .cm-changedText, &light .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ee443366, #ee443366) bottom/100% 2px no-repeat"},"&dark.cm-merge-a .cm-changedText, &dark .cm-deletedChunk .cm-deletedText":{background:"linear-gradient(#ffaa9966, #ffaa9966) bottom/100% 2px no-repeat"},"&light.cm-merge-b .cm-changedText":{background:"linear-gradient(#22bb2266, #22bb2266) bottom/100% 2px no-repeat"},"&dark.cm-merge-b .cm-changedText":{background:"linear-gradient(#88ff8866, #88ff8866) bottom/100% 2px no-repeat"},".cm-insertedLine, .cm-deletedLine":{textDecoration:"none"},".cm-deletedChunk":{paddingLeft:"6px","& .cm-chunkButtons":{position:"absolute",insetInlineEnd:"5px"},"& button":{border:"none",cursor:"pointer",color:"white",margin:"0 2px",borderRadius:"3px","&[name=accept]":{background:"#2a2"},"&[name=reject]":{background:"#d43"}}},".cm-collapsedLines":{padding:"5px 5px 5px 10px",cursor:"pointer"},"&light .cm-collapsedLines":{color:"#444",background:"linear-gradient(to bottom, transparent 0, #f3f3f3 30%, #f3f3f3 70%, transparent 100%)"},"&dark .cm-collapsedLines":{color:"#ddd",background:"linear-gradient(to bottom, transparent 0, #222 30%, #222 70%, transparent 100%)"},".cm-changeGutter":{width:"3px",paddingLeft:"1px"},"&light.cm-merge-a .cm-changedLineGutter, &light .cm-deletedLineGutter":{background:"#e43"},"&dark.cm-merge-a .cm-changedLineGutter, &dark .cm-deletedLineGutter":{background:"#fa9"},"&light.cm-merge-b .cm-changedLineGutter":{background:"#2b2"},"&dark.cm-merge-b .cm-changedLineGutter":{background:"#8f8"}}),ex=new i.Compartment,eM=new i.Compartment;class eE{constructor(e){this.revertDOM=null,this.revertToA=!1,this.revertToLeft=!1,this.measuring=-1,this.diffConf=e.diffConfig||eo;let t=[i.Prec.low(es),eC,ek,ep,r.EditorView.updateListener.of(e=>{this.measuring<0&&(e.heightChanged||e.viewportChanged)&&!e.transactions.some(e=>e.effects.some(e=>e.is(eg)))&&this.measure()})],n=[J.of({side:"a",sibling:()=>this.b,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&n.push(ea);let o=i.EditorState.create({doc:e.a.doc,selection:e.a.selection,extensions:[e.a.extensions||[],r.EditorView.editorAttributes.of({class:"cm-merge-a"}),eM.of(n),t]}),s=[J.of({side:"b",sibling:()=>this.a,highlightChanges:!1!==e.highlightChanges,markGutter:!1!==e.gutter})];!1!==e.gutter&&s.push(ea);let a=i.EditorState.create({doc:e.b.doc,selection:e.b.selection,extensions:[e.b.extensions||[],r.EditorView.editorAttributes.of({class:"cm-merge-b"}),eM.of(s),t]});this.chunks=X.build(o.doc,a.doc,this.diffConf);let l=[Q.init(()=>this.chunks),ex.of(e.collapseUnchanged?eB(e.collapseUnchanged):[])];o=o.update({effects:i.StateEffect.appendConfig.of(l)}).state,a=a.update({effects:i.StateEffect.appendConfig.of(l)}).state,this.dom=document.createElement("div"),this.dom.className="cm-mergeView",this.editorDOM=this.dom.appendChild(document.createElement("div")),this.editorDOM.className="cm-mergeViewEditors";let f=e.orientation||"a-b",c=document.createElement("div");c.className="cm-mergeViewEditor";let h=document.createElement("div");h.className="cm-mergeViewEditor",this.editorDOM.appendChild("a-b"==f?c:h),this.editorDOM.appendChild("a-b"==f?h:c),this.a=new r.EditorView({state:o,parent:c,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.a)}),this.b=new r.EditorView({state:a,parent:h,root:e.root,dispatchTransactions:e=>this.dispatch(e,this.b)}),this.setupRevertControls(!!e.revertControls,"b-to-a"==e.revertControls,e.renderRevertControl),e.parent&&e.parent.appendChild(this.dom),this.scheduleMeasure()}dispatch(e,t){if(e.some(e=>e.docChanged)){let r=e[e.length-1],n=e.reduce((e,t)=>e.compose(t.changes),i.ChangeSet.empty(e[0].startState.doc.length));this.chunks=t==this.a?X.updateA(this.chunks,r.newDoc,this.b.state.doc,n,this.diffConf):X.updateB(this.chunks,this.a.state.doc,r.newDoc,n,this.diffConf),t.update([...e,r.state.update({effects:_.of(this.chunks)})]);let o=t==this.a?this.b:this.a;o.update([o.state.update({effects:_.of(this.chunks)})]),this.scheduleMeasure()}else t.update(e)}reconfigure(e){if("diffConfig"in e&&(this.diffConf=e.diffConfig),"orientation"in e){let t="b-a"!=e.orientation;if(t!=(this.editorDOM.firstChild==this.a.dom.parentNode)){let e=this.a.dom.parentNode,r=this.b.dom.parentNode;e.remove(),r.remove(),this.editorDOM.insertBefore(t?e:r,this.editorDOM.firstChild),this.editorDOM.appendChild(t?r:e),this.revertToLeft=!this.revertToLeft,this.revertDOM&&(this.revertDOM.textContent="")}}if("revertControls"in e||"renderRevertControl"in e){let t=!!this.revertDOM,r=this.revertToA,i=this.renderRevert;"revertControls"in e&&(t=!!e.revertControls,r="b-to-a"==e.revertControls),"renderRevertControl"in e&&(i=e.renderRevertControl),this.setupRevertControls(t,r,i)}let t="highlightChanges"in e,r="gutter"in e,i="collapseUnchanged"in e;if(t||r||i){let n=[],o=[];if(t||r){let i=this.a.state.facet(J),s=r?!1!==e.gutter:i.markGutter,a=t?!1!==e.highlightChanges:i.highlightChanges;n.push(eM.reconfigure([J.of({side:"a",sibling:()=>this.b,highlightChanges:a,markGutter:s}),s?ea:[]])),o.push(eM.reconfigure([J.of({side:"b",sibling:()=>this.a,highlightChanges:a,markGutter:s}),s?ea:[]]))}if(i){let t=ex.reconfigure(e.collapseUnchanged?eB(e.collapseUnchanged):[]);n.push(t),o.push(t)}this.a.dispatch({effects:n}),this.b.dispatch({effects:o})}this.scheduleMeasure()}setupRevertControls(e,t,r){this.revertToA=t,this.revertToLeft=this.revertToA==(this.editorDOM.firstChild==this.a.dom.parentNode),this.renderRevert=r,!e&&this.revertDOM?(this.revertDOM.remove(),this.revertDOM=null):e&&!this.revertDOM?(this.revertDOM=this.editorDOM.insertBefore(document.createElement("div"),this.editorDOM.firstChild.nextSibling),this.revertDOM.addEventListener("mousedown",e=>this.revertClicked(e)),this.revertDOM.className="cm-merge-revert"):this.revertDOM&&(this.revertDOM.textContent="")}scheduleMeasure(){if(this.measuring<0){let e=this.dom.ownerDocument.defaultView||window;this.measuring=e.requestAnimationFrame(()=>{this.measuring=-1,this.measure()})}}measure(){!function(e,t,n){let o=new i.RangeSetBuilder,s=new i.RangeSetBuilder,a=e.state.field(ep).iter(),l=t.state.field(ep).iter(),f=0,c=0,h=0,d=0,u=e.viewport,m=t.viewport;for(let i=0;;i++){let g=i<n.length?n[i]:null,p=g?g.fromA:e.state.doc.length,b=g?g.fromB:t.state.doc.length;if(f<p){let i=e.lineBlockAt(f).top+h-(t.lineBlockAt(c).top+d);i<-.01?(h-=i,o.add(f,f,r.Decoration.widget({widget:new em(-i),block:!0,side:-1}))):i>.01&&(d+=i,s.add(c,c,r.Decoration.widget({widget:new em(i),block:!0,side:-1})))}if(p>f+1e3&&f<u.from&&p>u.from&&c<m.from&&b>m.from){let e=Math.min(u.from-f,m.from-c);f+=e,c+=e,i--}else if(g)f=g.toA,c=g.toB;else break;for(;a.value&&a.from<f;)h-=a.value.spec.widget.height,a.next();for(;l.value&&l.from<c;)d-=l.value.spec.widget.height,l.next()}for(;a.value;)h-=a.value.spec.widget.height,a.next();for(;l.value;)d-=l.value.spec.widget.height,l.next();let g=e.contentHeight+h-(t.contentHeight+d);g<.01?o.add(e.state.doc.length,e.state.doc.length,r.Decoration.widget({widget:new em(-g),block:!0,side:1})):g>.01&&s.add(t.state.doc.length,t.state.doc.length,r.Decoration.widget({widget:new em(g),block:!0,side:1}));let p=o.finish(),b=s.finish();eb(p,e.state.field(ep))||e.dispatch({effects:eg.of(p)}),eb(b,t.state.field(ep))||t.dispatch({effects:eg.of(b)})}(this.a,this.b,this.chunks),this.revertDOM&&this.updateRevertButtons()}updateRevertButtons(){let e=this.revertDOM,t=e.firstChild,r=this.a.viewport,i=this.b.viewport;for(let n=0;n<this.chunks.length;n++){let o=this.chunks[n];if(o.fromA>r.to||o.fromB>i.to)break;if(o.fromA<r.from||o.fromB<i.from)continue;let s=this.a.lineBlockAt(o.fromA).top+"px";for(;t&&+t.dataset.chunk<n;)t=eD(t);t&&t.dataset.chunk==String(n)?(t.style.top!=s&&(t.style.top=s),t=t.nextSibling):e.insertBefore(this.renderRevertButton(s,n),t)}for(;t;)t=eD(t)}renderRevertButton(e,t){let r;if(this.renderRevert)r=this.renderRevert();else{r=document.createElement("button");let e=this.a.state.phrase("Revert this chunk");r.setAttribute("aria-label",e),r.setAttribute("title",e),r.textContent=this.revertToLeft?"⇜":"⇝"}return r.style.top=e,r.setAttribute("data-chunk",String(t)),r}revertClicked(e){let t=e.target,r;for(;t&&t.parentNode!=this.revertDOM;)t=t.parentNode;if(t&&(r=this.chunks[t.dataset.chunk])){let[t,i,n,o,s,a]=this.revertToA?[this.b,this.a,r.fromB,r.toB,r.fromA,r.toA]:[this.a,this.b,r.fromA,r.toA,r.fromB,r.toB],l=t.state.sliceDoc(n,Math.max(n,o-1));n!=o&&a<=i.state.doc.length&&(l+=t.state.lineBreak),i.dispatch({changes:{from:s,to:Math.min(i.state.doc.length,a),insert:l},userEvent:"revert"}),e.preventDefault()}}destroy(){this.a.destroy(),this.b.destroy(),this.measuring>-1&&(this.dom.ownerDocument.defaultView||window).cancelAnimationFrame(this.measuring),this.dom.remove()}}function eD(e){let t=e.nextSibling;return e.remove(),t}let eO=i.StateEffect.define();function eS(e,t){let r=[];for(let i of $(e.toString(),t.toString())){let{fromA:e,fromB:n,toA:o,toB:s}=i;e===o&&r.push({from:e,insert:t.slice(n,s)}),n===s&&r.push({from:e,to:o,insert:""}),e!==o&&n!==s&&r.push({from:e,to:o,insert:t.slice(n,s)})}return i.ChangeSet.of(r,e.length)}r.WidgetType,e.s(["Change",()=>D,"Chunk",()=>X,"MergeView",()=>eE,"diff",()=>$],676480),e.s(["changeSetFromDiff",()=>eS],328751)}]);

//# debugId=66d881c0-7a10-7ad9-f907-875f81660c67
//# sourceMappingURL=a413f7229835bacb.js.map