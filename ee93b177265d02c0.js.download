;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="0c7155db-02b1-04e6-3ad8-a577cf2d75c9")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,570466,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.default)(e);var n=t.strictSeparator?i.test(e):s.test(e);return n&&t.strict?a(e):n};var r,o=(r=e.r(669996))&&r.__esModule?r:{default:r},s=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,i=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,a=function(e){var t=e.match(/^(\d{4})-?(\d{3})([ T]{1}\.*|$)/);if(t){var n=Number(t[1]),r=Number(t[2]);return n%4==0&&n%100!=0||n%400==0?r<=366:r<=365}var o=e.match(/(\d{4})-?(\d{0,2})-?(\d*)/).map(Number),s=o[1],i=o[2],a=o[3],c=i?"0".concat(i).slice(-2):i,l=a?"0".concat(a).slice(-2):a,u=new Date("".concat(s,"-").concat(c||"01","-").concat(l||"01"));return!i||!a||u.getUTCFullYear()===s&&u.getUTCMonth()+1===i&&u.getUTCDate()===a};t.exports=n.default,t.exports.default=n.default},27470,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){return(0,o.default)(e),null==t&&(t="all"),t in s&&s[t].test(e)};var r,o=(r=e.r(669996))&&r.__esModule?r:{default:r},s={1:/^[0-9A-F]{8}-[0-9A-F]{4}-1[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,2:/^[0-9A-F]{8}-[0-9A-F]{4}-2[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,6:/^[0-9A-F]{8}-[0-9A-F]{4}-6[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,7:/^[0-9A-F]{8}-[0-9A-F]{4}-7[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,8:/^[0-9A-F]{8}-[0-9A-F]{4}-8[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,nil:/^00000000-0000-0000-0000-000000000000$/i,max:/^ffffffff-ffff-ffff-ffff-ffffffffffff$/i,loose:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i,all:/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i};t.exports=n.default,t.exports.default=n.default},837399,e=>{"use strict";var t=e.i(996027),n=e.i(960933),r=e.i(862927),o=e.i(570466),s=e.i(27470);t.FormatRegistry.Set("uuid",e=>(0,s.default)(e)),t.FormatRegistry.Set("date-time",e=>(0,o.default)(e));class i extends Error{issues;constructor(e){super(),this.name="Schema validation error",this.message=e.map(e=>`${e.path}: ${e.message}`).join("\n"),this.issues=e}}function a(e,t){return new i([...r.Value.Errors(e,t)])}e.s(["Nullish",0,e=>n.Type.Optional(n.Type.Union([n.Type.Null(),e])),"TypeboxError",()=>i,"validationErrors",()=>a])},710643,(e,t,n)=>{!function(){"use strict";var e={815:function(e){e.exports=function(e,n,r,o){n=n||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var i=/\+/g;e=e.split(n);var a=1e3;o&&"number"==typeof o.maxKeys&&(a=o.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var l=0;l<c;++l){var u,h,p,d,f=e[l].replace(i,"%20"),y=f.indexOf(r);(y>=0?(u=f.substr(0,y),h=f.substr(y+1)):(u=f,h=""),p=decodeURIComponent(u),d=decodeURIComponent(h),Object.prototype.hasOwnProperty.call(s,p))?t(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},577:function(e){var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,s,i,a){return(s=s||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e)?r(o(e),function(o){var a=encodeURIComponent(t(o))+i;return n(e[o])?r(e[o],function(e){return a+encodeURIComponent(t(e))}).join(s):a+encodeURIComponent(t(e[o]))}).join(s):a?encodeURIComponent(t(a))+i+encodeURIComponent(t(e)):""};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var s=n[t]={exports:{}},i=!0;try{e[t](s,s.exports,r),i=!1}finally{i&&delete n[t]}return s.exports}r.ab="/ROOT/node_modules/.pnpm/next@16.1.6_@babel+core@7.21.4_@opentelemetry+api@1.9.0_babel-plugin-macros@3.1.0_react_4a6390a124a4cc69b521374d5faad242/node_modules/next/dist/compiled/querystring-es3/";var o={};o.decode=o.parse=r(815),o.encode=o.stringify=r(577),t.exports=o}()},668106,116680,e=>{"use strict";var t=e.i(221042),n=e.i(750854),r=e.i(966983),o=e.i(790155),s=e.i(960933),i=e.i(862927),a=e.i(324753),c=e.i(272391);let l=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;s.Type.Object({id:s.Type.String(),gurl:s.Type.String(),conmanURL:s.Type.String(),proxy:s.Type.String()});let u=s.Type.Object({token:s.Type.String(),gurl:s.Type.String(),wsURL:s.Type.String(),conmanURL:s.Type.String(),dotdevHostname:s.Type.String()});async function h({url:e,...t}){let n;try{n=await (0,a.default)(e,{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest"},method:"post",body:JSON.stringify(t)})}catch(e){throw e.statusCode||(e.statusCode=504),e}let r=n.headers.get("content-type"),s=r&&r.includes("application/json");if(!n.ok){let r;throw r=s?(await n.json()).message:await n.text(),new c.default(r||n.statusText).setExtras({url:e,...t}).setStatusCode(n.status)}if(!s){let o=await n.text();throw new c.default("Expected JSON response for connection metadata").setExtras({contentType:r,statusText:n.statusText,response:o,url:e,...t}).setStatusCode(n.status)}let h=await n.json();if(!i.Value.Check(u,h)||(h.dotdevHostname||o.logger.error("Lore returned empty dotdevHostname",{res:h}),0))throw new c.default("Invalid format for connection metadata response").setExtras({connectionMetadata:h,url:e,...t});if(!(h.token.startsWith("v2.public.")||l.test(h.token)))throw new c.default("Expected token to be PASETO- or base64-encoded").setExtras({connectionMetadata:h,url:e,...t});return h}var p=e.i(294426),d=e.i(173738),f=e.i(664152),y=e.i(501005);let g=!!t.default.env.CAPTCHA_EMBEDS;async function m({replId:e,isLoggedIn:t,overrideClusterMetadata:o,requestedPid2Version:s,format:i,asViewer:a,retry:c,before:l}){if(!d.apolloClient)throw Error("Expected apollo client");let u=!!(n.default.query.lite||n.default.query.embed),b={url:`/data/repls/${e}/get_connection_metadata`,overrideClusterMetadata:o,requestedPid2Version:s,format:i??r.api.token.ReplToken.WireFormat.PROTOBUF,clientVersion:"a779238e",hCaptchaSiteKey:y.HCAPTCHA_SITE_KEY,isEmbed:u,retry:c||0,asViewer:a,before:l};if(!(t||u&&!g))try{let e,t;try{t=await (0,p.getRecaptchaToken)({action:"genReplToken"})}catch{e=await (0,y.default)()}return h({...b,captcha:e,recaptchaToken:t})}catch(n){return f.logger.error("Goval connection failure",{errorMessage:n&&n.message||"unidentified failure",replid:e,reason:"captcha",context:"services"}),m({replId:e,overrideClusterMetadata:o,retry:(c||0)+1,requestedPid2Version:s,format:i,isLoggedIn:t,asViewer:a,before:l})}return h(b)}e.s(["default",()=>m],668106);var b=e.i(282453);async function v(){return b.default.get("gurl")?(console.log("Getting gurl from localstorage"),b.default.get("gurl")):null}function C(e){let t=function(e){let t;try{t=new URL(e)}catch(e){return console.log("failed to parse gurl"),console.error(e),null}let n={secure:!1,port:""+t.port,host:t.hostname};return"wss:"===t.protocol?n.secure=!0:"ws:"!==t.protocol&&console.log(e,"Expected gurl protocol to be ws or wss, assuming insecure connection"),n.port||(n.port=n.secure?"443":"80"),n}(e);if(!t)return null;let{secure:n,host:r,port:o}=t;return"repl.it"===r||"gp-v2.replit.com"===r||"eval.replit.com"===r?null:{id:"development",gurl:`ws${n?"s":""}://${r}:${o}`,conmanURL:`http${n?"s":""}://${r}:${o}`,proxy:`http${n?"s":""}://${r.replace("eval","proxy")}:${o}`}}async function w(){let e=await v();return e?C(e):null}e.s(["default",()=>w,"gurlToOverrideClusterMetadata",()=>C],116680)},635984,e=>{"use strict";var t=e.i(830675),n=e.i(664152),r=e.i(282453);async function o(){let e="0.0.3144";if(window.location.search.includes("debug=1")){let t=r.default.get("pid2Version");"string"==typeof t&&(console.log("using pid2 version from localStorage",t),e=t)}if(!e)throw Error("expected PID2_VERSION to be set in prod");return(0,n.updatePid2Version)(e),t.setTag("pid2Version",e),e}e.s(["getPid2Version",()=>o])},534012,(e,t,n)=>{var r={452:function(t){"use strict";t.exports=e.r(710643)}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}},i=!0;try{r[e](n,n.exports,s),i=!1}finally{i&&delete o[e]}return n.exports}s.ab="/ROOT/node_modules/.pnpm/next@16.1.6_@babel+core@7.21.4_@opentelemetry+api@1.9.0_babel-plugin-macros@3.1.0_react_4a6390a124a4cc69b521374d5faad242/node_modules/next/dist/compiled/native-url/";var i={};!function(){var e,t=(e=s(452))&&"object"==typeof e&&"default"in e?e.default:e,n=/https?|ftp|gopher|file/;function r(e){"string"==typeof e&&(e=m(e));var r,o,s,i,a,c,l,u,h,p=(o=(r=e).auth,s=r.hostname,i=r.protocol||"",a=r.pathname||"",c=r.hash||"",l=r.query||"",u=!1,o=o?encodeURIComponent(o).replace(/%3A/i,":")+"@":"",r.host?u=o+r.host:s&&(u=o+(~s.indexOf(":")?"["+s+"]":s),r.port&&(u+=":"+r.port)),l&&"object"==typeof l&&(l=t.encode(l)),h=r.search||l&&"?"+l||"",i&&":"!==i.substr(-1)&&(i+=":"),r.slashes||(!i||n.test(i))&&!1!==u?(u="//"+(u||""),a&&"/"!==a[0]&&(a="/"+a)):u||(u=""),c&&"#"!==c[0]&&(c="#"+c),h&&"?"!==h[0]&&(h="?"+h),{protocol:i,host:u,pathname:a=a.replace(/[?#]/g,encodeURIComponent),search:h=h.replace("#","%23"),hash:c});return""+p.protocol+p.host+p.pathname+p.search+p.hash}var o="http://",a=o+"w.w",c=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,l=/https?|ftp|gopher|file/;function u(e,t){var n="string"==typeof e?m(e):e;e="object"==typeof e?r(e):e;var s=m(t),i="";n.protocol&&!n.slashes&&(i=n.protocol,e=e.replace(n.protocol,""),i+="/"===t[0]||"/"===e[0]?"/":""),i&&s.protocol&&(i="",s.slashes||(i=s.protocol,t=t.replace(s.protocol,"")));var u=e.match(c);u&&!s.protocol&&(e=e.substr((i=u[1]+(u[2]||"")).length),/^\/\/[^/]/.test(t)&&(i=i.slice(0,-1)));var h=new URL(e,a+"/"),p=new URL(t,h).toString().replace(a,""),d=s.protocol||n.protocol;return d+=n.slashes||s.slashes?"//":"",!i&&d?p=p.replace(o,d):i&&(p=p.replace(o,"")),l.test(p)||~t.indexOf(".")||"/"===e.slice(-1)||"/"===t.slice(-1)||"/"!==p.slice(-1)||(p=p.slice(0,-1)),i&&(p=i+("/"===p[0]?p.substr(1):p)),p}function h(){}h.prototype.parse=m,h.prototype.format=r,h.prototype.resolve=u,h.prototype.resolveObject=u;var p=/^https?|ftp|gopher|file/,d=/^(.*?)([#?].*)/,f=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,y=/^([a-z0-9.+-]*:)?\/\/\/*/i,g=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function m(e,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!1),e&&"object"==typeof e&&e instanceof h)return e;var s=(e=e.trim()).match(d);e=s?s[1].replace(/\\/g,"/")+s[2]:e.replace(/\\/g,"/"),g.test(e)&&"/"!==e.slice(-1)&&(e+="/");var i=!/(^javascript)/.test(e)&&e.match(f),c=y.test(e),l="";i&&(p.test(i[1])||(l=i[1].toLowerCase(),e=""+i[2]+i[3]),i[2]||(c=!1,p.test(i[1])?(l=i[1],e=""+i[3]):e="//"+i[3]),3!==i[2].length&&1!==i[2].length||(l=i[1],e="/"+i[3]));var u,m=(s?s[1]:e).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),b=m&&m[1],v=new h,C="",w="";try{u=new URL(e)}catch(t){C=t,l||o||!/^\/\//.test(e)||/^\/\/.+[@.]/.test(e)||(w="/",e=e.substr(1));try{u=new URL(e,a)}catch(e){return v.protocol=l,v.href=l,v}}v.slashes=c&&!w,v.host="w.w"===u.host?"":u.host,v.hostname="w.w"===u.hostname?"":u.hostname.replace(/(\[|\])/g,""),v.protocol=C?l||null:u.protocol,v.search=u.search.replace(/\\/g,"%5C"),v.hash=u.hash.replace(/\\/g,"%5C");var E=e.split("#");!v.search&&~E[0].indexOf("?")&&(v.search="?"),v.hash||""!==E[1]||(v.hash="#"),v.query=n?t.decode(u.search.substr(1)):v.search.substr(1),v.pathname=w+(i?u.pathname.replace(/['^|`]/g,function(e){return"%"+e.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(e,t){try{return decodeURIComponent(t).split("").map(function(e){var t=e.charCodeAt();return t>256||/^[a-z0-9]$/i.test(e)?e:"%"+t.toString(16).toUpperCase()}).join("")}catch(e){return t}}):u.pathname),"about:"===v.protocol&&"blank"===v.pathname&&(v.protocol="",v.pathname=""),C&&"/"!==e[0]&&(v.pathname=v.pathname.substr(1)),l&&!p.test(l)&&"/"!==e.slice(-1)&&"/"===v.pathname&&(v.pathname=""),v.path=v.pathname+v.search,v.auth=[u.username,u.password].map(decodeURIComponent).filter(Boolean).join(":"),v.port=u.port,b&&!v.host.endsWith(b)&&(v.host+=b,v.port=b.slice(1)),v.href=w?""+v.pathname+v.search+v.hash:r(v);var S=/^(file)/.test(v.href)?["host","hostname"]:[];return Object.keys(v).forEach(function(e){~S.indexOf(e)||(v[e]=v[e]||null)}),v}i.parse=m,i.format=r,i.resolve=u,i.resolveObject=function(e,t){return m(u(e,t))},i.Url=h}(),t.exports=i},7433,105823,e=>{"use strict";var t=e.i(548452),n=e.i(468930),r=e.i(893299),o=(0,e.i(908564).createContextKey)("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function s(e){return e.setValue(o,!0)}function i(e){return!0===e.getValue(o)}e.s(["isTracingSuppressed",()=>i,"suppressTracing",()=>s],105823);var a="[_0-9a-z-*/]",c=RegExp("^(?:[a-z]"+a+"{0,255}|"+("[a-z0-9]"+a+"{0,240}@[a-z]")+a+"{0,13})$"),l=/^[ -~]{0,255}[!-~]$/,u=/,|=/,h=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce(function(t,n){return t.push(n+"="+e.get(n)),t},[]).join(",")},e.prototype._parse=function(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce(function(e,t){var n=t.trim(),r=n.indexOf("=");if(-1!==r){var o=n.slice(0,r),s=n.slice(r+1,t.length);c.test(o)&&l.test(s)&&!u.test(s)&&e.set(o,s)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),p="traceparent",d="tracestate",f=RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$"),y=function(){function e(){}return e.prototype.inject=function(e,o,s){var a=n.trace.getSpanContext(e);if(!(!a||i(e))&&(0,t.isSpanContextValid)(a)){var c="00-"+a.traceId+"-"+a.spanId+"-0"+Number(a.traceFlags||r.TraceFlags.NONE).toString(16);s.set(o,p,c),a.traceState&&s.set(o,d,a.traceState.serialize())}},e.prototype.extract=function(e,t,r){var o,s=r.get(t,p);if(!s)return e;var i=Array.isArray(s)?s[0]:s;if("string"!=typeof i)return e;var a=(o=f.exec(i))&&("00"!==o[1]||!o[5])?{traceId:o[2],spanId:o[3],traceFlags:parseInt(o[4],16)}:null;if(!a)return e;a.isRemote=!0;var c=r.get(t,d);if(c){var l=Array.isArray(c)?c.join(","):c;a.traceState=new h("string"==typeof l?l:void 0)}return n.trace.setSpanContext(e,a)},e.prototype.fields=function(){return[p,d]},e}();e.s(["W3CTraceContextPropagator",()=>y],7433)},787182,e=>{"use strict";var t,n=((t={}).NotFound="NotFound",t.NotAllowed="NotAllowed",t.ConcurrentReplLimit="ConcurrentReplLimit",t.LanguageTokenDenied="LanguageTokenDenied",t.RequiresRefresh="RequiresRefresh",t.CrosisChannel="CrosisChannel",t);let r={"repl not found":"NotFound","not allowed to run at this time":"NotAllowed","language tokens are only for logged out people.":"LanguageTokenDenied","user is required to refresh":"RequiresRefresh","channel with name ot":"CrosisChannel","cannot send any more commands after a close request on channel for ot":"CrosisChannel"};function o(e){for(let[t,n]of Object.entries(r))if(e.message.toLowerCase().includes(t))return n;return null}class s extends Error{constructor(e){super("user is required to refresh: "+e)}}e.s(["NonBsodErrorType",()=>n,"PleaseRefreshError",()=>s,"default",()=>o])},193283,(e,t,n)=>{var r;let o;r=function(){"use strict";function t(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(){return(a="u">typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var s=Object.getOwnPropertyDescriptor(r,t);return s.get?s.get.call(arguments.length<3?e:n):s.value}}).apply(this,arguments)}var c=function(){function e(){t(this,e),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return r(e,[{key:"addEventListener",value:function(e,t,n){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:n})}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners){for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r].callback===t)return void n.splice(r,1)}}},{key:"dispatchEvent",value:function(e){if(e.type in this.listeners){for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++){var o=t[n];try{o.callback.call(this,e)}catch(e){Promise.resolve().then(function(){throw e})}o.options&&o.options.once&&this.removeEventListener(e.type,o.callback)}return!e.defaultPrevented}}}]),e}(),AbortSignal=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");AbortSignal.prototype=Object.create(e&&e.prototype,{constructor:{value:AbortSignal,writable:!0,configurable:!0}}),Object.defineProperty(AbortSignal,"prototype",{writable:!1}),e&&s(AbortSignal,e);var n,l=(n=function(){if("u"<typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=o(AbortSignal);e=n?Reflect.construct(t,arguments,o(this).constructor):t.apply(this,arguments);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return i(this)});function AbortSignal(){var e;return t(this,AbortSignal),(e=l.call(this)).listeners||c.call(i(e)),Object.defineProperty(i(e),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(i(e),"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(i(e),"reason",{value:void 0,writable:!0,configurable:!0}),e}return r(AbortSignal,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),a(o(AbortSignal.prototype),"dispatchEvent",this).call(this,e)}}]),AbortSignal}(c),l=function(){function e(){t(this,e),Object.defineProperty(this,"signal",{value:new AbortSignal,writable:!0,configurable:!0})}return r(e,[{key:"abort",value:function(e){try{t=new Event("abort")}catch(e){"u">typeof document?document.createEvent?(t=document.createEvent("Event")).initEvent("abort",!1,!1):(t=document.createEventObject()).type="abort":t={type:"abort",bubbles:!1,cancelable:!1}}var t,n=e;if(void 0===n)if("u"<typeof document)(n=Error("This operation was aborted")).name="AbortError";else try{n=new DOMException("signal is aborted without reason")}catch(e){(n=Error("This operation was aborted")).name="AbortError"}this.signal.reason=n,this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"u">typeof Symbol&&Symbol.toStringTag&&(l.prototype[Symbol.toStringTag]="AbortController",AbortSignal.prototype[Symbol.toStringTag]="AbortSignal");var u="u">typeof self?self:e.g;(u.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL?(console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill"),0):("function"!=typeof u.Request||u.Request.prototype.hasOwnProperty("signal"))&&u.AbortController)||(u.AbortController=l,u.AbortSignal=AbortSignal)},"function"==typeof define&&define.amd?void 0!==(o=r(e.r,n,t))&&e.v(o):r()},20657,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});class r extends Error{constructor(e,t=null,n=null){super(e),this.name="CrosisError",this.extras=t,this.tags=n}static fromError(e){let t=new r(e.message);return t.stack=e.stack,t}}n.default=r},699162,(e,t,n)=>{"use strict";var r=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Channel=void 0;let o=e.r(966983),s=r(e.r(20657));n.Channel=class{constructor({id:e,name:t,service:n,send:r,onUnrecoverableError:i}){this.onCommand=e=>{if("closed"===this.status){let e=new s.default("Trying to listen to commands on a closed channel for "+this.service,this.getExtras(),{service:this.service});throw this.onUnrecoverableError(e),e}return this.onCommandListeners.push(e),()=>{this.onCommandListeners=this.onCommandListeners.filter(t=>t!==e)}},this.send=e=>{if("closed"===this.status){let t=new s.default("Calling send on closed channel for "+this.service,this.getExtras(e),{service:this.service});throw this.onUnrecoverableError(t),t}if("closing"===this.status){let t=new s.default("Cannot send any more commands after a close request on channel for "+this.service,this.getExtras(e),{service:this.service});throw this.onUnrecoverableError(t),t}e.channel=this.id,this.sendToContainer(o.api.Command.create(e))},this.request=async e=>{let t=Number(Math.random().toString().split(".")[1]).toString(36);return e.ref=t,new Promise((n,r)=>{this.requestMap[t]=n;try{this.send(e)}catch(e){delete this.requestMap[t],r(e)}})},this.handleCommand=e=>{this.onCommandListeners.forEach(t=>t(e)),e.ref&&this.requestMap[e.ref]&&(this.requestMap[e.ref](e),delete this.requestMap[e.ref])},this.handleClose=e=>{Object.keys(this.requestMap).forEach(t=>{let n=o.api.Command.fromObject({});n.channelClosed=e,this.requestMap[t](n),delete this.requestMap[t]}),this.status="closed",this.onCommandListeners=[]},this.getExtras=(e=null)=>({...e?{command:e,commandRef:e.ref,commandKeys:Object.keys(e)}:{},channelName:this.name,channelId:this.id}),this.id=e,this.name=t,this.service=n,this.sendToContainer=r,this.onUnrecoverableError=i,this.status="open",this.requestMap={},this.onCommandListeners=[]}}},319590,(e,t,n)=>{"use strict";var r=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.getRedirectURL=n.getConnectionStr=n.getWebSocketClass=n.defaultGetNextRetryDelay=void 0;let a=s(e.r(534012)),c=i(e.r(20657));function l(e){return("object"==typeof e||"function"==typeof e)&&!!e&&"OPEN"in e&&1===e.OPEN}n.defaultGetNextRetryDelay=function(e){return Math.min(1.7**e*1e3,15e3)+Math.floor(500*Math.random())},n.getWebSocketClass=function(e){if(e){if(!l(e))throw new c.default("Passed in WebSocket does not look like a standard WebSocket");return e}if("u">typeof WebSocket){if(!l(WebSocket))throw new c.default("Global WebSocket does not look like a standard WebSocket");return WebSocket}throw new c.default("Please pass in a WebSocket class or add it to global")},n.getConnectionStr=function(e,t){if(t){let n=a.parse(e.wsURL);return n.hostname=t,n.host=t,n.pathname+=`/${encodeURIComponent(e.gurl)}`,a.format(n)}return e.wsURL},n.getRedirectURL=function(e,t){let n=a.parse(e),r=a.parse(t);return n.hostname=r.hostname,n.host=r.host,a.format(n)}},706361,(e,t,n)=>{try{t.exports="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},42546,(e,t,n)=>{t.exports="u">typeof self?self:"u">typeof window?window:Function("return this")()},210458,(e,t,n)=>{var r=e.r(706361),o=e.r(42546);t.exports=function(e){var t=e.xdomain,n=e.xscheme,s=e.enablesXDR;try{if("u">typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("u">typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!t)try{return new o[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}},277177,(e,t,n)=>{t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},436387,(e,t,n)=>{var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},330748,(e,t,n)=>{var r=e.i(434989),o=e.r(436387),s=Object.prototype.toString,i="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===s.call(Blob),a="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===s.call(File);t.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(o(t)){for(var n=0,s=t.length;n<s;n++)if(e(t[n]))return!0;return!1}if("function"==typeof r.Buffer&&r.Buffer.isBuffer&&r.Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||i&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return e(t.toJSON(),!0);for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)&&e(t[c]))return!0;return!1}},243879,(e,t,n)=>{t.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),s=new Uint8Array(n-t),i=t,a=0;i<n;i++,a++)s[a]=o[i];return s.buffer}},692923,(e,t,n)=>{t.exports=function(e,t,n){var o=!1;return n=n||r,s.count=e,0===e?t():s;function s(e,r){if(s.count<=0)throw Error("after called too many times");--s.count,e?(o=!0,t(e),t=n):0!==s.count||o||t(null,r)}};function r(){}},119401,(e,t,n)=>{var r,o,s,i=String.fromCharCode;function a(e){for(var t,n,r=[],o=0,s=e.length;o<s;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<s?(64512&(n=e.charCodeAt(o++)))==56320?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function c(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function l(e,t){return i(e>>t&63|128)}function u(){if(s>=o)throw Error("Invalid byte index");var e=255&r[s];if(s++,(192&e)==128)return 63&e;throw Error("Invalid continuation byte")}t.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),o=r.length,s=-1,u="";++s<o;)u+=function(e,t){if((0xffffff80&e)==0)return i(e);var n="";return(0xfffff800&e)==0?n=i(e>>6&31|192):(0xffff0000&e)==0?(c(e,t)||(e=65533),n=i(e>>12&15|224)+l(e,6)):(0xffe00000&e)==0&&(n=i(e>>18&7|240)+l(e,12)+l(e,6)),n+=i(63&e|128)}(r[s],n);return u},decode:function(e,t){var n,l=!1!==(t=t||{}).strict;o=(r=a(e)).length,s=0;for(var h=[];!1!==(n=function(e){var t,n,i,a;if(s>o)throw Error("Invalid byte index");if(s==o)return!1;if(t=255&r[s],s++,(128&t)==0)return t;if((224&t)==192){if((a=(31&t)<<6|(n=u()))>=128)return a;throw Error("Invalid continuation byte")}if((240&t)==224){if((a=(15&t)<<12|(n=u())<<6|(i=u()))>=2048)return c(a,e)?a:65533;throw Error("Invalid continuation byte")}if((248&t)==240&&(n=u(),(a=(7&t)<<18|n<<12|(i=u())<<6|u())>=65536&&a<=1114111))return a;throw Error("Invalid UTF-8 detected")}(l));)h.push(n);for(var p,d=h.length,f=-1,y="";++f<d;)(p=h[f])>65535&&(p-=65536,y+=i(p>>>10&1023|55296),p=56320|1023&p),y+=i(p);return y}}},706869,(e,t,n)=>{!function(e){"use strict";n.encode=function(t){var n,r=new Uint8Array(t),o=r.length,s="";for(n=0;n<o;n+=3)s+=e[r[n]>>2],s+=e[(3&r[n])<<4|r[n+1]>>4],s+=e[(15&r[n+1])<<2|r[n+2]>>6],s+=e[63&r[n+2]];return o%3==2?s=s.substring(0,s.length-1)+"=":o%3==1&&(s=s.substring(0,s.length-2)+"=="),s},n.decode=function(t){var n,r,o,s,i,a=.75*t.length,c=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(n=0;n<c;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),s=e.indexOf(t[n+2]),i=e.indexOf(t[n+3]),h[l++]=r<<2|o>>4,h[l++]=(15&o)<<4|s>>2,h[l++]=(3&s)<<6|63&i;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},58936,(e,t,n)=>{var r=void 0!==r?r:"u">typeof WebKitBlobBuilder?WebKitBlobBuilder:"u">typeof MSBlobBuilder?MSBlobBuilder:"u">typeof MozBlobBuilder&&MozBlobBuilder,o=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(e){return!1}}(),s=o&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(e){return!1}}(),i=r&&r.prototype.append&&r.prototype.getBlob;function a(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function c(e,t){t=t||{};var n=new r;return a(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function l(e,t){return new Blob(a(e),t||{})}"u">typeof Blob&&(c.prototype=Blob.prototype,l.prototype=Blob.prototype),t.exports=o?s?Blob:l:i?c:void 0},662464,(e,t,n)=>{var r,o=e.r(277177),s=e.r(330748),i=e.r(243879),a=e.r(692923),c=e.r(119401);"u">typeof ArrayBuffer&&(r=e.r(706869));var l="u">typeof navigator&&/Android/i.test(navigator.userAgent),u="u">typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=l||u;n.protocol=3;var p=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=o(p),f={type:"error",data:"parser error"},y=e.r(58936);function g(e,t,n){for(var r=Array(e.length),o=a(e.length,n),s=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},i=0;i<e.length;i++)s(i,e[i],o)}n.encodePacket=function(e,t,r,o){"function"==typeof t&&(o=t,t=!1),"function"==typeof r&&(o=r,r=null);var s,i=void 0===e.data?void 0:e.data.buffer||e.data;if("u">typeof ArrayBuffer&&i instanceof ArrayBuffer){var a=e,l=t,u=o;if(!l)return n.encodeBase64Packet(a,u);var d=a.data,f=new Uint8Array(d),g=new Uint8Array(1+d.byteLength);g[0]=p[a.type];for(var m=0;m<f.length;m++)g[m+1]=f[m];return u(g.buffer)}if(void 0!==y&&i instanceof y){var b=e,v=t,C=o;if(!v)return n.encodeBase64Packet(b,C);if(h){if(!v)return n.encodeBase64Packet(b,C);var w=new FileReader;return w.onload=function(){n.encodePacket({type:b.type,data:w.result},v,!0,C)},w.readAsArrayBuffer(b.data)}var E=new Uint8Array(1);return E[0]=p[b.type],C(new y([E.buffer,b.data]))}if(i&&i.base64){return s=e,o("b"+n.packets[s.type]+s.data.data)}var S=p[e.type];return void 0!==e.data&&(S+=r?c.encode(String(e.data),{strict:!1}):String(e.data)),o(""+S)},n.encodeBase64Packet=function(e,t){var r,o="b"+n.packets[e.type];if(void 0!==y&&e.data instanceof y){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];t(o+e)},s.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var i=new Uint8Array(e.data),a=Array(i.length),c=0;c<i.length;c++)a[c]=i[c];r=String.fromCharCode.apply(null,a)}return t(o+=btoa(r))},n.decodePacket=function(e,t,r){if(void 0===e)return f;if("string"==typeof e){if("b"===e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(r&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return f;var o=e.charAt(0);return Number(o)==o&&d[o]?e.length>1?{type:d[o],data:e.substring(1)}:{type:d[o]}:f}var o=new Uint8Array(e)[0],s=i(e,1);return y&&"blob"===t&&(s=new y([s])),{type:d[o],data:s}},n.decodeBase64Packet=function(e,t){var n=d[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var o=r.decode(e.substr(1));return"blob"===t&&y&&(o=new y([o])),{type:n,data:o}},n.encodePayload=function(e,t,r){"function"==typeof t&&(r=t,t=null);var o=s(e);return t&&o?y&&!h?n.encodePayloadAsBlob(e,r):n.encodePayloadAsArrayBuffer(e,r):e.length?void g(e,function(e,r){n.encodePacket(e,!!o&&t,!1,function(e){r(null,e.length+":"+e)})},function(e,t){return r(t.join(""))}):r("0:")},n.decodePayload=function(e,t,r){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,r);if("function"==typeof t&&(r=t,t=null),""===e)return r(f,0,1);for(var o,s,i,a="",c=0,l=e.length;c<l;c++){var u=e.charAt(c);if(":"!==u){a+=u;continue}if(""===a||a!=(s=Number(a))||a!=(i=e.substr(c+1,s)).length)return r(f,0,1);if(i.length){if(o=n.decodePacket(i,t,!1),f.type===o.type&&f.data===o.data)return r(f,0,1);if(!1===r(o,c+s,l))return}c+=s,a=""}if(""!==a)return r(f,0,1)},n.encodePayloadAsArrayBuffer=function(e,t){if(!e.length)return t(new ArrayBuffer(0));g(e,function(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,n){var r=new Uint8Array(n.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0)),o=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var s=new Uint8Array(e.length),i=0;i<e.length;i++)s[i]=e.charCodeAt(i);n=s.buffer}t?r[o++]=0:r[o++]=1;for(var a=n.byteLength.toString(),i=0;i<a.length;i++)r[o++]=parseInt(a[i]);r[o++]=255;for(var s=new Uint8Array(n),i=0;i<s.length;i++)r[o++]=s[i]}),t(r.buffer)})},n.encodePayloadAsBlob=function(e,t){g(e,function(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,n[0]=0}for(var s=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(s.length+1),o=0;o<s.length;o++)i[o]=parseInt(s[o]);i[s.length]=255,y&&t(null,new y([n.buffer,i.buffer,e]))})},function(e,n){return t(new y(n))})},n.decodePayloadAsBinary=function(e,t,r){"function"==typeof t&&(r=t,t=null);for(var o=e,s=[];o.byteLength>0;){for(var a=new Uint8Array(o),c=0===a[0],l="",u=1;255!==a[u];u++){if(l.length>310)return r(f,0,1);l+=a[u]}o=i(o,2+l.length);var h=i(o,0,l=parseInt(l));if(c)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(e){var p=new Uint8Array(h);h="";for(var u=0;u<p.length;u++)h+=String.fromCharCode(p[u])}s.push(h),o=i(o,l)}var d=s.length;s.forEach(function(e,o){r(n.decodePacket(e,t,!0),o,d)})}},649720,(e,t,n)=>{function r(e){if(e){var t=e;for(var n in r.prototype)t[n]=r.prototype[n];return t}}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){n=n.slice(0);for(var r=0,o=n.length;r<o;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},959946,(e,t,n)=>{var r=e.r(662464),o=e.r(649720);function s(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}t.exports=s,o(s.prototype),s.prototype.onError=function(e,t){var n=Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},s.prototype.open=function(){return("closed"===this.readyState||""===this.readyState)&&(this.readyState="opening",this.doOpen()),this},s.prototype.close=function(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this},s.prototype.send=function(e){if("open"===this.readyState)this.write(e);else throw Error("Transport not open")},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},s.prototype.onPacket=function(e){this.emit("packet",e)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},745651,(e,t,n)=>{n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},101642,(e,t,n)=>{t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},462533,(e,t,n)=>{"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},i=0,a=0;function c(e){var t="";do t=o[e%64]+t,e=Math.floor(e/64);while(e>0)return t}function l(){var e=c(+new Date);return e!==r?(i=0,r=e):e+"."+c(i++)}for(;a<64;a++)s[o[a]]=a;l.encode=c,l.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+s[e.charAt(a)];return t},t.exports=l},62635,(e,t,n)=>{function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}t.exports=function(e,t){t=t||{};var n,o,s=typeof e;if("string"===s&&e.length>0){var i=e;if(!((i=String(i)).length>100)){var a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(a){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*c;case"days":case"day":case"d":return 864e5*c;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*c;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*c;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*c;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:break}}}return}if("number"===s&&!1===isNaN(e)){return t.long?r(n=e,864e5,"day")||r(n,36e5,"hour")||r(n,6e4,"minute")||r(n,1e3,"second")||n+" ms":(o=e)>=864e5?Math.round(o/864e5)+"d":o>=36e5?Math.round(o/36e5)+"h":o>=6e4?Math.round(o/6e4)+"m":o>=1e3?Math.round(o/1e3)+"s":o+"ms"}throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},451634,(e,t,n)=>{function r(e){var t;function r(){if(r.enabled){var e=+new Date;r.diff=e-(t||e),r.prev=t,r.curr=e,t=e;for(var o=Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=n.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var i=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;i++;var s=n.formatters[t];if("function"==typeof s){var a=o[i];e=s.call(r,a),o.splice(i,1),i--}return e}),n.formatArgs.call(r,o),(r.log||n.log||console.log.bind(console)).apply(r,o)}}return r.namespace=e,r.enabled=n.enabled(e),r.useColors=n.useColors(),r.color=function(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t)|0;return n.colors[Math.abs(r)%n.colors.length]}(e),r.destroy=o,"function"==typeof n.init&&n.init(r),n.instances.push(r),r}function o(){var e=n.instances.indexOf(this);return -1!==e&&(n.instances.splice(e,1),!0)}(n=t.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e),n.names=[],n.skips=[];var t,r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(t=0;t<o;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(RegExp("^"+e.substr(1)+"$")):n.names.push(RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){var s=n.instances[t];s.enabled=n.enabled(s.namespace)}},n.enabled=function(e){var t,r;if("*"===e[e.length-1])return!0;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e.r(62635),n.instances=[],n.names=[],n.skips=[],n.formatters={}},635817,(e,t,n)=>{var r=e.i(221042);function o(){var e;try{e=n.storage.debug}catch(e){}return!e&&void 0!==r.default&&"env"in r.default&&(e=r.default.env.DEBUG),e}(n=t.exports=e.r(451634)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(s=o))}),e.splice(s,0,r)}},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=o,n.useColors=function(){return"u">typeof window&&!!window.process&&"renderer"===window.process.type||!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage="u">typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},n.enable(o())},450438,(e,t,n)=>{var r=e.r(959946),o=e.r(745651),s=e.r(662464),i=e.r(101642),a=e.r(462533),c=e.r(635817)("engine.io-client:polling");t.exports=u;var l=null!=new(e.r(210458))({xdomain:!1}).responseType;function u(e){var t=e&&e.forceBase64;(!l||t)&&(this.supportsBinary=!1),r.call(this,e)}i(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||n()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||n()}))}else n()},u.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=this;c("polling got data %s",e),s.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},u.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},767047,(e,t,n)=>{var r=e.r(210458),o=e.r(450438),s=e.r(649720),i=e.r(101642),a=e.r(635817)("engine.io-client:polling-xhr"),c=e.r(42546);function l(){}function u(e){if(o.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"u">typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="u">typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function h(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function p(){for(var e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}t.exports=u,t.exports.Request=h,i(u,o),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new h(e)},u.prototype.doWrite=function(e,t){var n=this.request({method:"POST",data:e,isBinary:"string"!=typeof e&&void 0!==e}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=n},u.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},s(h.prototype),h.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&t.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError("number"==typeof t.status?t.status:0)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){setTimeout(function(){n.onError(e)},0);return}"u">typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)},h.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},h.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},h.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},h.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l,e)try{this.xhr.abort()}catch(e){}"u">typeof document&&delete h.requests[this.index],this.xhr=null}},h.prototype.onLoad=function(){var e,t;try{try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},h.prototype.hasXDR=function(){return"u">typeof XDomainRequest&&!this.xs&&this.enablesXDR},h.prototype.abort=function(){this.cleanup()},h.requestsCount=0,h.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",p):"function"==typeof addEventListener&&addEventListener("onpagehide"in c?"pagehide":"unload",p,!1))},923917,(e,t,n)=>{var r,o=e.r(450438),s=e.r(101642),i=e.r(42546);t.exports=u;var a=/\n/g,c=/\\n/g;function l(){}function u(e){o.call(this,e),this.query=this.query||{},r||(r=i.___eio=i.___eio||[]),this.index=r.length;var t=this;r.push(function(e){t.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){t.script&&(t.script.onerror=l)},!1)}s(u,o),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},u.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"u">typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},u.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),s=document.createElement("textarea"),i=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=i,o.method="POST",o.setAttribute("accept-charset","utf-8"),s.name="d",o.appendChild(s),document.body.appendChild(o),this.form=o,this.area=s}function l(){u(),t()}function u(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),u(),e=e.replace(c,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&l()}:this.iframe.onload=l}},212022,(e,t,n)=>{var r,o,s=e.i(434989),i=e.r(959946),a=e.r(662464),c=e.r(745651),l=e.r(101642),u=e.r(462533),h=e.r(635817)("engine.io-client:websocket");if("u">typeof WebSocket?r=WebSocket:"u">typeof self&&(r=self.WebSocket||self.MozWebSocket),"u"<typeof window)try{o={}}catch(e){}var p=r||o;function d(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=o),i.call(this,e)}t.exports=d,l(d,i),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={};this.isReactNative||(n.agent=this.agent,n.perMessageDeflate=this.perMessageDeflate,n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized),this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new p(e,t):new p(e):new p(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},d.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,o=n;r<o;r++)!function(e){a.encodePacket(e,t.supportsBinary,function(r){if(!t.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),t.perMessageDeflate&&("string"==typeof r?s.Buffer.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,o)}catch(e){h("websocket closed before onclose event")}--n||(t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0))})}(e[r])},d.prototype.onClose=function(){i.prototype.onClose.call(this)},d.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},d.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=c.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},d.prototype.check=function(){return!!p&&!("__initialize"in p&&this.name===d.prototype.name)}},574275,(e,t,n)=>{var r=e.r(210458),o=e.r(767047),s=e.r(923917),i=e.r(212022);n.polling=function(e){var t=!1,n=!1,i=!1!==e.jsonp;if("u">typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!i)throw Error("JSONP disabled");return new s(e)},n.websocket=i},435123,(e,t,n)=>{var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return -1}},541109,(e,t,n)=>{var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t,n,s,i,a,c,l=e,u=e.indexOf("["),h=e.indexOf("]");-1!=u&&-1!=h&&(e=e.substring(0,u)+e.substring(u,h).replace(/:/g,";")+e.substring(h,e.length));for(var p=r.exec(e||""),d={},f=14;f--;)d[o[f]]=p[f]||"";return -1!=u&&-1!=h&&(d.source=l,d.host=d.host.substring(1,d.host.length-1).replace(/;/g,":"),d.authority=d.authority.replace("[","").replace("]","").replace(/;/g,":"),d.ipv6uri=!0),t=0,s=(n=d.path).replace(/\/{2,9}/g,"/").split("/"),("/"==n.substr(0,1)||0===n.length)&&s.splice(0,1),"/"==n.substr(n.length-1,1)&&s.splice(s.length-1,1),d.pathNames=s,i=0,a=d.query,c={},a.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,n){t&&(c[t]=n)}),d.queryKey=c,d}},136770,(e,t,n)=>{var r=e.r(574275),o=e.r(649720),s=e.r(635817)("engine.io-client:socket"),i=e.r(435123),a=e.r(662464),c=e.r(541109),l=e.r(745651);function u(e,t){if(!(this instanceof u))return new u(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"u">typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("u">typeof location?location.hostname:"localhost"),this.port=t.port||("u">typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||void 0,this.key=t.key||void 0,this.passphrase=t.passphrase||void 0,this.cert=t.cert||void 0,this.ca=t.ca||void 0,this.ciphers=t.ciphers||void 0,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("u"<typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=u,u.priorWebsocketSuccess=!1,o(u.prototype),u.protocol=a.protocol,u.Socket=u,u.Transport=e.r(959946),u.transports=e.r(574275),u.parser=e.r(662464),u.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},u.prototype.open=function(){var e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else if(0===this.transports.length){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(e){this.transports.shift(),this.open();return}e.open(),this.setTransport(e)},u.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},u.prototype.probe=function(e){s('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(s('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(s('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;u.priorWebsocketSuccess="websocket"===t.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(s("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{s('probe transport "%s" failed',e);var i=Error("probe error");i.transport=t.name,r.emit("upgradeError",i)}}))}function i(){n||(n=!0,p(),t.close(),t=null)}function a(n){var o=Error("probe error: "+n);o.transport=t.name,i(),s('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function c(){a("transport closed")}function l(){a("socket closed")}function h(e){t&&e.name!==t.name&&(s('"%s" works - aborting "%s"',e.name,t.name),i())}function p(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",c),r.removeListener("close",l),r.removeListener("upgrading",h)}u.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",c),this.once("close",l),this.once("upgrading",h),t.open()},u.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},u.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},u.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},u.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},u.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),s("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},u.prototype.onError=function(e){s("socket error %j",e),u.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},u.prototype.onClose=function(e,t){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(s('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},u.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},899973,(e,t,n)=>{t.exports=e.r(136770),t.exports.parser=e.r(662464)},937538,(e,t,n)=>{"use strict";var r=e.e&&e.e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);(!o||("get"in o?!t.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=e.e&&e.e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=e.e&&e.e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},i=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.EIOCompat=n.createCloseEvent=n.splitHref=void 0;let a=i(e.r(899973)),c=s(e.r(534012));function l(e){let{protocol:t,slashes:n,auth:r,host:o,pathname:s}=c.parse(e);return{uri:c.format({protocol:t,slashes:n,auth:r,host:o,query:{ordered:"1"}}),path:null!=s?s:"/"}}n.splitHref=l;let u=new Map([["opening",0],["open",1],["closing",2],["closed",3]]);function h(e){return"u">typeof window?new MessageEvent("message",{data:e}):{type:"message",data:e}}function p(e){return"u">typeof window?new CloseEvent("close",e):{type:"close",...e}}function d(e,t){return"u">typeof window?new Event(e,t):{type:e,...t}}n.createCloseEvent=p;class f{constructor(e,t){if(this.CLOSED=3,this.CLOSING=2,this.OPEN=1,this.CONNECTING=0,t)throw Error("Passing protocols is not implemented");const{uri:n,path:r}=l(e);this.onopen=null,this.onclose=null,this.onmessage=null,this.onerror=null,this.eioSocket=(0,a.default)(n,{path:r,transports:["polling"]}),this.url=e,this.extensions="",this.protocol="",this.bufferedAmount=0,this.readyState=0,this.incomingSequence=0,this.outOfOrderQueue={},this.outgoingSequence=0,this.setReadyState(),this.eioSocket.on("open",()=>{if(this.setReadyState(),null!=this.onopen){let e=d("open");this.onopen.call(this,e)}}),this.eioSocket.on("close",e=>{if(this.setReadyState(),null!=this.onclose){let t=p({reason:e,code:1001,wasClean:!1});this.onclose.call(this,t)}}),this.eioSocket.on("message",e=>{if(this.setReadyState(),null==this.onmessage)return;if("string"==typeof e)throw Error("expected data to be ArrayBuffer not string");let t=new DataView(e).getUint32(0),n=e.slice(4);if(this.incomingSequence!==t){this.outOfOrderQueue[t]=n;return}this.incomingSequence=t+1;let r=h(n),o=this.onmessage.bind(this);o(r);let s=Object.keys(this.outOfOrderQueue);s.length>0&&(s.sort().forEach(e=>{o(h(this.outOfOrderQueue[+e])),this.incomingSequence=+e+1}),this.outOfOrderQueue={})}),this.eioSocket.on("error",()=>{if(this.setReadyState(),null!=this.onerror){let e=d("error");this.onerror.call(this,e)}})}setReadyState(){this.readyState=u.get(this.eioSocket.readyState)}send(e){let t=new ArrayBuffer(4+e.byteLength);new Uint8Array(t).set(new Uint8Array(e),4),new DataView(t).setUint32(0,this.outgoingSequence),this.outgoingSequence+=1,this.eioSocket.send(t),this.setReadyState()}close(){this.onmessage=null,this.eioSocket.close(),this.setReadyState()}addEventListener(){throw Error("Not Implemented, please use onmessage, onopen, onerror, or onclose")}removeEventListener(){throw Error("Not Implemented")}dispatchEvent(){throw Error("Not Implemented")}set binaryType(e){this.eioSocket.binaryType=e}get binaryType(){return this.eioSocket.binaryType||"blob"}}n.EIOCompat=f,f.CLOSED=3,f.CLOSING=2,f.OPEN=1,f.CONNECTING=0},441737,(e,t,n)=>{"use strict";var r,o,s,i,a,c,l,u;Object.defineProperty(n,"__esModule",{value:!0}),n.CloseCode=n.ChannelRequestPriority=n.ClientCloseReason=n.FetchConnectionMetadataError=n.ConnectionState=void 0,(a=r||(n.ConnectionState=r={}))[a.CONNECTING=0]="CONNECTING",a[a.CONNECTED=1]="CONNECTED",a[a.DISCONNECTED=2]="DISCONNECTED",(c=o||(n.FetchConnectionMetadataError=o={})).Aborted="Aborted",c.Retriable="Retriable",(l=s||(n.ClientCloseReason=s={})).Intentional="Intentional",l.Temporary="Temporary",l.Disconnected="Disconnected",l.ErrorOrDestroy="ErrorOrDestroy",(u=i||(n.ChannelRequestPriority=i={}))[u.High=0]="High",u[u.Medium=1]="Medium",u[u.Low=2]="Low",n.CloseCode={INVALID_UPSTREAM_RESPONSE:1014,POLICY_VIOLATION:1008,FIREWALL_DENIED:4e3,TRY_ANOTHER_MACHINE:4001,USER_ERROR:4002,CONCURRENT_REPL_LIMIT:4004}},753662,(e,t,n)=>{"use strict";var r=e.e&&e.e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.Client=n.sortByPriority=void 0;let o=e.r(966983),s=e.r(699162),i=e.r(319590),a=e.r(937538),c=e.r(441737),l=r(e.r(20657));function u(e,t){return e.priority-t.priority}n.sortByPriority=u,n.Client=class{constructor(){this.open=(e,t)=>{if(this.chan0Cb){let e=new l.default("You must call `close` before opening the client again");throw this.onUnrecoverableError(e),e}if(this.destroyed){let e=new l.default("Client has been destroyed and cannot be re-used");throw this.onUnrecoverableError(e),e}this.connectionId++,this.connectOptions={timeout:1e4,reuseConnectionMetadata:!1,getNextRetryDelayMs:i.defaultGetNextRetryDelay,...e},this.debug({type:"breadcrumb",message:"status:open"}),this.chan0Cb=t,this.connect({tryCount:0,websocketFailureCount:0,connectionId:this.connectionId})},this.openChannel=(e,t)=>{var n;let r=e.name?this.channelRequests.filter(t=>t.options.name===e.name):[];if(r.some(e=>!e.closeRequested)){let t=new l.default(`Channel with name ${e.name} already opened`);throw this.onUnrecoverableError(t),t}if(this.destroyed){let e=new l.default("Client has been destroyed and is unusable");throw this.onUnrecoverableError(e),e}let o={options:e,openChannelCb:t,isOpen:!1,channelId:null,cleanupCb:null,closeRequested:!1,priority:null!=(n=e.priority)?n:c.ChannelRequestPriority.Medium};return this.channelRequests.push(o),this.channelRequests.sort(u),this.getConnectionState()!==c.ConnectionState.CONNECTED||r.length?this.debug({type:"breadcrumb",message:"client:openChannel:delayed",data:{connectionState:this.getConnectionState(),service:o.options.service,name:o.options.name}}):this.requestOpenChannel(o),()=>{if(o.closeRequested)return void this.debug({type:"breadcrumb",message:"client:closeChannel:already requested",data:{channelId:o.channelId,service:o.options.service,name:o.options.name}});if(o.closeRequested=!0,!o.isOpen){this.debug({type:"breadcrumb",message:"client:closeChannel:channel not open",data:{connectionState:this.getConnectionState(),channelId:o.channelId,service:o.options.service,name:o.options.name}}),this.getConnectionState()!==c.ConnectionState.CONNECTED&&(this.channelRequests=this.channelRequests.filter(e=>e!==o));return}this.requestCloseChannel(o)}},this.requestOpenChannel=e=>{let{options:t,openChannelCb:n}=e;if(!this.connectOptions)return void this.onUnrecoverableError(new l.default("Expected connectionOptions"));let{skip:r}=t;if(r&&r(this.connectOptions.context))return void this.debug({type:"breadcrumb",message:"requestOpenChannel:explicit skip",data:{service:t.service,name:t.name}});let{action:i}=t;if(i||(i=null==t.name?o.api.OpenChannel.Action.CREATE:o.api.OpenChannel.Action.ATTACH_OR_CREATE),e.channelId)return void this.onUnrecoverableError(new l.default("Unexpected channelId"));let a="string"==typeof t.service?t.service:t.service(this.connectOptions.context),c=Number(Math.random().toString().split(".")[1]).toString(36);this.debug({type:"breadcrumb",message:"requestOpenChannel",data:{name:t.name,service:a,action:i,ref:c}});let u=this.getChannel(0);u.send({ref:c,openChan:{name:t.name,service:a,action:i}});let h=u.onCommand(t=>{if(c!==t.ref)return;if(h(),null==t.openChanRes)return void this.onUnrecoverableError(new l.default("Expected openChanRes on command"));let{id:r,state:i,error:u}=t.openChanRes;if(this.debug({type:"breadcrumb",message:"requestOpenChannel:openChanRes",data:{id:r,state:i,error:u,ref:c}}),!this.connectOptions)return void this.onUnrecoverableError(new l.default("Expected connectionOptions"));if(i===o.api.OpenChannelRes.State.ERROR)return void this.onUnrecoverableError(new l.default(`Channel open resulted with an error: ${u||"with no message"}`));if("number"!=typeof r||"number"!=typeof i)return void this.onUnrecoverableError(new l.default("Expected state and channel id"));if(null!=this.channels[r])return void this.onUnrecoverableError(new l.default(`Channel with id ${r} already exists`));let p=new s.Channel({id:r,name:e.options.name,service:a,onUnrecoverableError:this.onUnrecoverableError,send:this.send});this.channels[r]=p,e.channelId=r,e.isOpen=!0;let{closeRequested:d}=e;d?this.requestCloseChannel(e):e.cleanupCb=n({channel:p,context:this.connectOptions.context})})},this.requestCloseChannel=async e=>{if(!e.isOpen)return void this.onUnrecoverableError(new l.default("Tried to request a channel close before opening"));let{channelId:t}=e,n=this.getChannel(e.channelId);n.status="closing";let r=this.getChannel(0);if(!r)return void this.onUnrecoverableError(new l.default("Tried to request a channel close but there was no chan0"));this.debug({type:"breadcrumb",message:"requestCloseChannel",data:{id:t,name:e.options.name,service:e.options.service}});let s=await r.request({closeChan:{action:o.api.CloseChannel.Action.TRY_CLOSE,id:e.channelId}});if(s.channelClosed)this.debug({type:"breadcrumb",message:"requestCloseChannel:chan0Closed",data:{id:t,name:e.options.name,service:e.options.service}});else{if(null==s.closeChanRes)return void this.onUnrecoverableError(new l.default("Expected closeChanRes"));let{id:n}=s.closeChanRes;if(null==n)return void this.onUnrecoverableError(new l.default(`Expected id, got ${n}`));if(n!==t)return void this.onUnrecoverableError(new l.default(`Expected id from closeChanRes to be ${t} got ${n}`));this.debug({type:"breadcrumb",message:"requestCloseChannel:closeChanRes",data:{id:t,name:e.options.name,service:e.options.service,closeStatus:s.closeChanRes.status}})}if(this.channelRequests=this.channelRequests.filter(t=>t!==e),delete this.channels[t],n.handleClose({initiator:"channel",willReconnect:!1}),e.cleanupCb&&e.cleanupCb({initiator:"channel",willReconnect:!1}),!e.options.name||this.connectionState!==c.ConnectionState.CONNECTED)return;let i=this.channelRequests.find(t=>t.options.name===e.options.name);i&&this.requestOpenChannel(i)},this.close=({expectReconnect:e}={expectReconnect:!1})=>{if(!this.destroyed){if(this.debug({type:"breadcrumb",message:e?"close:temporary":"close:intentional"}),!this.chan0Cb||!this.connectOptions){let e=new l.default("Must call client.open before closing");throw this.onUnrecoverableError(e),e}this.connectionMetadata=null,this.handleClose(e?c.ClientCloseReason.Temporary:c.ClientCloseReason.Intentional)}},this.destroy=()=>{this.destroyed||(this.destroyed=!0,this.debug({type:"breadcrumb",message:"status:destroy"}),this.handleClose(c.ClientCloseReason.ErrorOrDestroy),this.debug=()=>{},this.connectionStateChangeFuncs=[],this.userUnrecoverableErrorHandler=null,this.channelRequests=[],this.destroyed=!0)},this.getChannel=e=>{let t=this.channels[e];if(!t){let t=new l.default(`No channel with number ${e}`);throw this.onUnrecoverableError(t),t}return t},this.debug=e=>{this.debugFuncs.forEach(t=>t(e))},this.onDebugLog=e=>(this.debugFuncs.push(e),()=>{let t=this.debugFuncs.indexOf(e);t>-1&&this.debugFuncs.splice(t,1)}),this.setConnectionState=e=>{this.connectionState=e,setTimeout(()=>{this.connectionStateChangeFuncs.forEach(t=>t(e))},0)},this.onConnectionStateChange=e=>(this.connectionStateChangeFuncs.push(e),()=>{let t=this.connectionStateChangeFuncs.indexOf(e);t>-1&&this.connectionStateChangeFuncs.splice(t,1)}),this.getConnectionState=()=>this.connectionState,this.onBootStatus=e=>(this.bootStatusFuncs.push(e),()=>{let t=this.bootStatusFuncs.indexOf(e);t>-1&&this.bootStatusFuncs.splice(t,1)}),this.onFirewallDenied=()=>{this.onUnrecoverableError(new l.default("Can't connect to unfirewalled repl from firewall mode"))},this.setUnrecoverableErrorHandler=e=>{this.userUnrecoverableErrorHandler=e},this.getConnectionMetadata=()=>this.connectionMetadata,this.connect=async({tryCount:e,websocketFailureCount:t,connectionId:n})=>{if(this.debug({type:"breadcrumb",message:"status:connecting",data:{connectionState:this.connectionState,connectTries:e,websocketFailureCount:t,readyState:this.ws?this.ws.readyState:void 0,chan0CbExists:!!this.chan0Cb}}),this.getConnectionState()!==c.ConnectionState.DISCONNECTED){let e=new l.default("Client must be disconnected to connect");throw this.onUnrecoverableError(e),e}if(this.ws){let e=new l.default("Unexpected existing websocket instance");throw this.onUnrecoverableError(e),e}if(!this.connectOptions){let e=new l.default("Expected connectionOptions");throw this.onUnrecoverableError(e),e}if(!this.chan0Cb)return void this.onUnrecoverableError(new l.default("Expected chan0Cb"));if(this.chan0CleanupCb)return void this.onUnrecoverableError(new l.default("Unexpected chan0CleanupCb, are you sure you closed"));if(this.channelRequests.some(e=>e.isOpen))return void this.onUnrecoverableError(new l.default("All channels should be closed when we connect"));if(Object.keys(this.channels).length)return void this.onUnrecoverableError(new l.default("Found an an unexpected existing channels"));if(this.connectTimeoutId)return void this.onUnrecoverableError(new l.default("Unexpected connectTimeoutId"));this.setConnectionState(c.ConnectionState.CONNECTING);let r=new s.Channel({id:0,name:"chan0",service:"chan0",onUnrecoverableError:this.onUnrecoverableError,send:this.send});if(this.channels[0]=r,r.onCommand(e=>{let t=e.bootStatus;null!=t&&this.bootStatusFuncs.forEach(e=>e(t))}),r.onCommand(e=>{let t=e.redirect;if(null!=t)return this.handleRedirect(t.url)}),!this.connectOptions.reuseConnectionMetadata||null===this.connectionMetadata){let o;if(this.fetchTokenAbortControllers.get(n))return void this.onUnrecoverableError(new l.default("Expected fetchTokenAbortController to be null"));let s=new AbortController;this.fetchTokenAbortControllers.set(n,s);try{o=await this.connectOptions.fetchConnectionMetadata(s.signal)}catch(t){let e;e=t instanceof l.default?t:new l.default(t instanceof Error?t.message:t&&"object"==typeof t&&"message"in t&&"string"==typeof t.message?t.message:"string"==typeof t?t:"Unknown error when fetching connection metadata"),e=new l.default(e.message,{...e.extras,from:"fetchConnectionMetadata"},e.tags),this.onUnrecoverableError(e);return}this.fetchTokenAbortControllers.delete(n);let i=o;if(s.signal.aborted)return;if(i.error===c.FetchConnectionMetadataError.Aborted)return void this.onUnrecoverableError(new l.default("Client received abort from fetchConnectionMetadata, but the request was not aborted."));if(i.error===c.FetchConnectionMetadataError.Retriable)return void this.retryConnect({tryCount:e+1,websocketFailureCount:t,chan0:r,error:new l.default("Retriable error"),connectionId:n});if(this.getConnectionState()!==c.ConnectionState.CONNECTING)return void this.onUnrecoverableError(new l.default("Client entered wrong state during connect(); connected="+(this.getConnectionState()===c.ConnectionState.CONNECTED?"true":"false")));if(i.error)return void this.onUnrecoverableError(l.default.fromError(i.error));this.connectionMetadata=i}3===t&&this.connectOptions.pollingHost&&this.debug({type:"breadcrumb",message:"websocket:polling fallback"});let u=t>=3&&this.connectOptions.pollingHost,h=u?a.EIOCompat:(0,i.getWebSocketClass)(this.connectOptions.WebSocketClass),p=new h((0,i.getConnectionStr)(this.connectionMetadata,u?this.connectOptions.pollingHost:void 0));p.binaryType="arraybuffer",p.onmessage=this.onSocketMessage,this.ws=p;let d=!1,f=!1,y=null;p.onerror=()=>{y?y(new l.default("WebSocket errored")):this.onUnrecoverableError(new l.default("Got websocket error but no `onFailed` cb"))},p.onclose=e=>{if(!y)return void this.onUnrecoverableError(new l.default("Got websocket closure but no `onFailed` cb"));let t=!0,n="WebSocket closed before we got READY";h===a.EIOCompat?f||(this.connectionMetadata=null):"code"in e&&(e.code===c.CloseCode.POLICY_VIOLATION?this.connectionMetadata=null:e.code===c.CloseCode.USER_ERROR?(n="Repl not allowed to run at this time. Please try again later.",t=!1):e.code===c.CloseCode.FIREWALL_DENIED?(n="Can't connect to unfirewalled repl from firewall mode",t=!1):e.code===c.CloseCode.CONCURRENT_REPL_LIMIT&&(n="You have reached the concurrent Repl limit. Please shut down other Repls.",t=!1)),y(new l.default(n),t)},p.onopen=()=>{h!==a.EIOCompat&&(d=!0)};let g=()=>{},m=()=>{},{timeout:b}=this.connectOptions;null!==b&&(m=()=>{this.debug({type:"breadcrumb",message:"timeout:cancel"}),this.connectTimeoutId&&(clearTimeout(this.connectTimeoutId),this.connectTimeoutId=null)},(g=()=>{this.debug({type:"breadcrumb",message:"timeout:reset"}),this.connectTimeoutId&&clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{(this.debug({type:"breadcrumb",message:"timeout:hit"}),y)?y(new l.default("timeout")):this.onUnrecoverableError(new l.default("Connecting timed out but there was no `onFailed` cb"))},b)})());let v=r.onCommand(e=>{if(f=!0,g(),null!=e.firewallDenied)return void this.onFirewallDenied();if(null==e.containerState)return;if(null==e.containerState.state)return void this.onUnrecoverableError(new l.default("Got containerState but state was not defined"));let{state:t}=e.containerState;this.debug({type:"breadcrumb",message:"container:state",data:t});let n=o.api.ContainerState.State;switch(t){case n.READY:v(),m(),this.handleConnect(r);break;case n.SLEEP:if(!y)return void this.onUnrecoverableError(new l.default("Got SLEEP but there was no `onFailed` cb"));y(new l.default("Got SLEEP as container state"))}}),C=this.getChannel(0),w=this.connectOptions;y=(o,s=!0)=>{(y=null,this.cleanupSocket(),m(),v(),this.connectOptions!==w||this.getChannel(0)!==C)?this.onUnrecoverableError(new l.default("onFailed got called but client is in a different connecting context")):s?this.retryConnect({tryCount:e+1,websocketFailureCount:d?0:t+1,chan0:r,error:o,connectionId:n}):this.onUnrecoverableError(o)}},this.retryConnect=({tryCount:e,websocketFailureCount:t,chan0:n,error:r,connectionId:o})=>this.retryTimeoutId?void this.onUnrecoverableError(new l.default("Unexpected existing retryTimeoutId")):this.chan0Cb?this.connectOptions?e>=10&&this.redirectInitiatorURL?(this.debug({type:"breadcrumb",message:"client:redirectInitiatorFallback",data:{connectionState:this.connectionState,connectTries:e,websocketFailureCount:t,error:r,wsReadyState:this.ws?this.ws.readyState:void 0}}),this.redirectInitiatorFallback()):void(this.retryTimeoutId=setTimeout(()=>{this.chan0Cb?(this.retryTimeoutId=null,this.debug({type:"breadcrumb",message:"status:retrying",data:{connectionState:this.connectionState,connectTries:e,websocketFailureCount:t,error:r,wsReadyState:this.ws?this.ws.readyState:void 0}}),n.handleClose({initiator:"client",willReconnect:!0}),delete this.channels[0],this.setConnectionState(c.ConnectionState.DISCONNECTED),this.connect({tryCount:e,websocketFailureCount:t,connectionId:o})):this.onUnrecoverableError(new l.default("Scheduled retry is called after we closed?"))},this.connectOptions.getNextRetryDelayMs(e))):void this.onUnrecoverableError(new l.default("Expected connectOptions when scheduling a retry")):void this.onUnrecoverableError(new l.default("Expected chan0Cb when scheduling a retry")),this.send=e=>{let t=this.getChannel(e.channel);this.debug({type:"log",log:{direction:"out",channel:{id:e.channel,name:t.name,service:t.service},cmd:e}});let n=o.api.Command.encode(e).finish(),r=n.buffer.slice(n.byteOffset,n.byteOffset+n.length);null==this.ws?this.onUnrecoverableError(new l.default("Calling send on a closed client")):this.ws.send(r)},this.onSocketMessage=({data:e})=>{let t=new Uint8Array(e),n=o.api.Command.decode(t),r=this.getChannel(n.channel);this.debug({type:"log",log:{direction:"in",channel:{id:n.channel,name:r.name,service:r.service},cmd:n}}),r.handleCommand(n)},this.handleConnect=e=>{if(!this.ws)return void this.onUnrecoverableError(new l.default("Expected Websocket instance"));if(!this.connectOptions)return void this.onUnrecoverableError(new l.default("Expected connectionOptions"));if(!e)return void this.onUnrecoverableError(new l.default("Expected chan0 to be truthy"));if(!this.chan0Cb)return void this.onUnrecoverableError(new l.default("Expected chan0Cb to be truthy"));let t=e=>{this.getConnectionState()===c.ConnectionState.DISCONNECTED?this.onUnrecoverableError(new l.default("Got a close event on socket but client is in disconnected state")):(this.debug({type:"breadcrumb",message:"websocket:close",data:{event:e}}),this.handleClose(c.ClientCloseReason.Disconnected))};this.ws.onclose=t,this.ws.onerror=t;let n=this.close;this.close=e=>setTimeout(()=>{n(e)},0),this.setConnectionState(c.ConnectionState.CONNECTED),this.debug({type:"breadcrumb",message:"status:connected"}),this.channelRequests.forEach(e=>{this.requestOpenChannel(e)}),this.chan0CleanupCb=this.chan0Cb({channel:e,context:this.connectOptions.context}),this.close=n},this.handleClose=e=>{if(e!==c.ClientCloseReason.ErrorOrDestroy){if(this.getConnectionState()===c.ConnectionState.DISCONNECTED)return void this.onUnrecoverableError(new l.default("handleClose is called but client already disconnected"));let e=this.fetchTokenAbortControllers.get(this.connectionId);if(this.ws&&e)return void this.onUnrecoverableError(new l.default("fetchTokenAbortController and websocket exist simultaneously"))}this.debug({type:"breadcrumb",message:"client:handleClose",data:{closeReason:e,connectionState:this.getConnectionState()}}),this.cleanupSocket(),this.retryTimeoutId&&(clearTimeout(this.retryTimeoutId),this.retryTimeoutId=null),this.connectTimeoutId&&(clearTimeout(this.connectTimeoutId),this.connectTimeoutId=null);let t=this.fetchTokenAbortControllers.get(this.connectionId);t&&(t.abort(),this.fetchTokenAbortControllers.delete(this.connectionId));let n=e===c.ClientCloseReason.Disconnected||e===c.ClientCloseReason.Temporary;if(this.channelRequests.forEach(e=>{let t=n&&!e.closeRequested;this.debug({type:"breadcrumb",message:"client:handleClose:closing channel",data:{channelId:e.channelId,service:e.options.service,name:e.options.name,closeRequested:e.closeRequested,channelRequestIsOpen:e.isOpen,willChannelReconnect:t,hasWs:!!this.ws}}),e.isOpen&&(this.getChannel(e.channelId).handleClose({initiator:"client",willReconnect:t}),delete this.channels[e.channelId]);let{cleanupCb:r,closeRequested:o}=e;e.channelId=null,e.isOpen=!1,e.cleanupCb=null,e.closeRequested=!1,r&&r({initiator:"client",willReconnect:t}),(o||e.closeRequested)&&(this.channelRequests=this.channelRequests.filter(t=>t!==e))}),this.channels[0]&&(this.channels[0].handleClose({initiator:"client",willReconnect:n}),delete this.channels[0]),0!==Object.keys(this.channels).length){for(let e of Object.values(this.channels))this.debug({type:"breadcrumb",message:"client:handleClose:out of sync",data:{channelId:e.id,status:e.status,service:e.service,name:e.name}});this.channels={},this.onUnrecoverableError(new l.default("channels out of sync, should have been cleaned up by channelRequests"));return}if(this.chan0CleanupCb)this.chan0CleanupCb({initiator:"client",willReconnect:n}),this.chan0CleanupCb=null;else if(!this.chan0Cb&&e!==c.ClientCloseReason.ErrorOrDestroy)return void this.onUnrecoverableError(new l.default("`open` should have been called before `handleClose` (no cleanup or callback function, "+(n?"would reconnect":"would not reconnect")+")",{closeReason:e,connectionState:this.getConnectionState()}));if(this.setConnectionState(c.ConnectionState.DISCONNECTED),!n){this.chan0Cb=null,this.connectOptions=null,this.debug({type:"breadcrumb",message:"status:closed"});return}this.debug({type:"breadcrumb",message:"status:reconnecting"}),this.connectionId++,this.connect({tryCount:0,websocketFailureCount:0,connectionId:this.connectionId})},this.cleanupSocket=()=>{let{ws:e}=this;this.debug({type:"breadcrumb",message:"websocket:cleanup",data:{hasWs:!!e,readyState:e?e.readyState:null,connectionState:this.connectionState}}),e&&(this.ws=null,e.onmessage=null,e.onclose=null,e.onopen=null,e.onerror=()=>{},(0===e.readyState||1===e.readyState)&&(this.debug({type:"breadcrumb",message:"websocket:close"}),e.close()))},this.onUnrecoverableError=e=>{if(this.debug({type:"breadcrumb",message:"onUnrecoverableError",data:{message:e.message}}),this.redirectInitiatorURL=null,this.getConnectionState()!==c.ConnectionState.DISCONNECTED)try{this.handleClose(c.ClientCloseReason.ErrorOrDestroy)}catch(e){console.error("handleClose errored during unrecoverable error"),console.error(e)}if(this.userUnrecoverableErrorHandler)return void this.userUnrecoverableErrorHandler(e);throw console.error("Please supply your own unrecoverable error handling function"),e},this.redirectInitiatorFallback=()=>{if(!this.connectionMetadata)return this.onUnrecoverableError(new l.default("client's connectionMetadata is null when redirecting to initiator"));if(!this.connectOptions)return this.onUnrecoverableError(new l.default("client's connectOptions is null when redirecting to initiator"));if(!this.chan0Cb)return this.onUnrecoverableError(new l.default("client's chan0Cb is null when redirecting to initiator"));let e=this.connectOptions.context,t=this.chan0Cb,n={...this.connectionMetadata};this.redirectInitiatorURL=null;let r={error:null,...n};this.close(),this.open({fetchConnectionMetadata:()=>Promise.resolve(r),WebSocketClass:WebSocket,context:e},t)},this.handleRedirect=e=>{if(this.debug({type:"breadcrumb",message:"client:handleRedirect",data:{connectionMetadata:this.connectionMetadata}}),!this.connectionMetadata)return this.onUnrecoverableError(new l.default("client's connectionMetadata is null when redirecting"));if(!this.connectOptions)return this.onUnrecoverableError(new l.default("client's connectOptions is null when redirecting"));if(!this.chan0Cb)return this.onUnrecoverableError(new l.default("client's chan0Cb is null when redirecting"));let t=this.connectOptions.context,n=this.chan0Cb,r={...this.connectionMetadata,gurl:e,wsURL:(0,i.getRedirectURL)(this.connectionMetadata.wsURL,e)};this.redirectInitiatorURL=this.connectionMetadata.gurl;let o={error:null,...r};this.close(),this.open({fetchConnectionMetadata:()=>Promise.resolve(o),WebSocketClass:WebSocket,context:t},n)},this.ws=null,this.channels={},this.connectOptions=null,this.chan0Cb=null,this.chan0CleanupCb=null,this.connectionState=c.ConnectionState.DISCONNECTED,this.connectionStateChangeFuncs=[],this.debugFuncs=[],this.bootStatusFuncs=[],this.userUnrecoverableErrorHandler=null,this.channelRequests=[],this.retryTimeoutId=null,this.connectTimeoutId=null,this.fetchTokenAbortControllers=new Map,this.destroyed=!1,this.connectionMetadata=null,this.redirectInitiatorURL=null,this.connectionId=0,this.debug({type:"breadcrumb",message:"constructor"})}}},251278,(e,t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ChannelRequestPriority=n.ConnectionState=n.FetchConnectionMetadataError=n.Channel=n.Client=void 0,e.r(193283);var r=e.r(753662);Object.defineProperty(n,"Client",{enumerable:!0,get:function(){return r.Client}});var o=e.r(699162);Object.defineProperty(n,"Channel",{enumerable:!0,get:function(){return o.Channel}});var s=e.r(441737);Object.defineProperty(n,"FetchConnectionMetadataError",{enumerable:!0,get:function(){return s.FetchConnectionMetadataError}}),Object.defineProperty(n,"ConnectionState",{enumerable:!0,get:function(){return s.ConnectionState}}),Object.defineProperty(n,"ChannelRequestPriority",{enumerable:!0,get:function(){return s.ChannelRequestPriority}})},866408,e=>{"use strict";var t=e.i(933138);function n(){return new t.EventEmitter}function r(e,t){return n=>(e.on(t,n),()=>{e.off(t,n)})}e.s(["createAddListener",()=>r,"default",()=>n])},464458,e=>{"use strict";var t=e.i(663457),n=e.i(7433);let r="repl.it-web",o=t.trace.getTracer(r);async function s(e,n,r){let s=o.startSpan(n,void 0,e),i=t.trace.setSpan(e,s);try{return await r(i)}finally{s.end()}}async function i(e,n,r){if(void 0===e)return await r();let s=o.startSpan(n,void 0,e),i=t.trace.setSpan(e,s);try{return await r(i,s)}finally{s.end()}}function a(e,n){let r=o.startSpan(n,void 0,e),s=t.trace.setSpan(e,r);return{span:r,childCtx:s}}function c(e){let t={};return new n.W3CTraceContextPropagator().inject(e,t,{set(e,t,n){e[t]=n}}),t}e.s(["createSpanFromContext",()=>a,"getTraceInfo",()=>c,"startSpanFromContext",()=>s,"startSpanFromOptionalContext",()=>i,"tracerName",0,r])},963146,e=>{"use strict";e.i(251278);var t,n=((t={}).CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",t.PORT_OPEN="PORT_OPEN",t.PORT_CLOSE="PORT_CLOSE",t.TOAST="TOAST",t);e.s(["Events",()=>n])},388956,(e,t,n)=>{"use strict";t.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},859736,e=>{"use strict";async function t({client:e,args:t,env:n,noUserEnv:r}){return new Promise(o=>{let s=e.openChannel({service:"exec"},({channel:e})=>{let i="";e.onCommand(e=>{e.output&&(i+=e.output)}),e.request({exec:{args:t,env:n,noUserEnv:r??!1}}).then(t=>{t.channelClosed?o({error:"Channel closed",output:i||null}):("open"===e.status&&s(),t.error)?o({error:t.error,output:i||null}):o({output:i,error:null})})})})}e.s(["default",()=>t])},792e3,282332,19379,e=>{"use strict";e.i(221042);var t=e.i(750854),n=e.i(827444),r=e.i(830675),o=e.i(388956),s=e.i(251278),i=e.i(966983),a=e.i(866408),c=e.i(464458),l=e.i(272391),u=e.i(859736),h=e.i(787182),p=e.i(963146);let d=1e-4>=Math.random();function f({fetchConnectionMetadata:e,getOverrideClusterMetadata:t,getDotdevUrl:n,logger:f,onUnrecoverableError:y,performance:g,preFetchConnectionMetadata:m,registerReconnectionMonitor:b,unregisterReconnectionMonitor:v,crosisTimeout:C,crosisWebSocketClass:w,traceCtx:E,getPid2Version:S}){let O=(0,a.default)();O.setMaxListeners(1e3);let x=null,R=new s.Client;R.setUnrecoverableErrorHandler(y),R.onDebugLog(e=>{let t;if("breadcrumb"!==e.type)return;t="container:state"===e.message?{containerState:e.data}:"data"in e?e.data:void 0,r.addBreadcrumb({category:"crosisV6",message:e.message,data:t});let n={replid:x?.repl.id,language:x?.repl.language};switch(e.message){case"timeout:hit":f.error("crosis connect timeout",n);break;case"onUnrecoverableError":{let t={errorMessage:e.data.message,...n};f.error("crosis unrecoverable error",t);break}case"status:retrying":{let{error:t,...r}=e.data,o={errorMessage:t.message,...n,...r};f.error("crosis retrying",o);break}case"status:connecting":case"status:reconnecting":{let t=e.message.split(":")[1];f.info(`crosis ${t}`,{...n,..."data"in e?e.data:void 0});break}case"websocket:polling fallback":f.info("crosis polling fallback",{...n})}});let T=window.location.search.includes("debug=1");return T&&R.onDebugLog(e=>{"log"===e.type&&console.log("in"===e.log.direction?"pid1 --> web":"pid1 <-- web",e.log.channel.service,JSON.stringify({cmd:e.log.cmd,channel:e.log.channel},null,2))}),{logger:f,performance:g,onPortOpened:e=>(O.on(p.Events.PORT_OPEN,e),()=>{O.removeListener(p.Events.PORT_OPEN,e)}),onPortClosed:e=>(O.on(p.Events.PORT_CLOSE,e),()=>{O.removeListener(p.Events.PORT_CLOSE,e)}),onToast:e=>(O.on(p.Events.TOAST,e),()=>{O.removeListener(p.Events.TOAST,e)}),onConnectionStateChanged:e=>R.onConnectionStateChange(e),connect({context:n,fetchConnectionMetadataExtras:r,getMinimumRetryDelayMs:a,...c}){R.getConnectionState()!==s.ConnectionState.DISCONNECTED&&R.close(),x=n,b(()=>{R.getConnectionState()===s.ConnectionState.DISCONNECTED&&this.connect({context:n,fetchConnectionMetadataExtras:r,getMinimumRetryDelayMs:a,...c})},()=>{R.getConnectionState()!==s.ConnectionState.DISCONNECTED&&this.close({expectReconnect:!0})});let u=async({chan0:e,gurl:t,isFirst:o})=>{if("open"!==e.status)return;let s=f.timeStart({gurl:t}),i=setTimeout(()=>{f.error("ping with no response",{gurl:t}),this.connect({context:n,fetchConnectionMetadataExtras:r,getMinimumRetryDelayMs:a,...c})},3e4),{channelClosed:l}=await e.request({ping:{}});clearTimeout(i),l||(o?s("latency to pid1",{type:"startup"}):d&&s("latency to pid1",{type:"periodic"}),setTimeout(()=>u({chan0:e,gurl:t,isFirst:!1}),1e3))},v={getNextRetryDelayMs:(...e)=>Math.max(function(e){return Math.min(2**e*1e3,6e4)+Math.floor(500*Math.random())}(...e),a()),context:n,reuseConnectionMetadata:!0,fetchConnectionMetadata:async o=>{let a;"function"==typeof m&&await m();let l="function"==typeof t?await t():null;if(o.aborted)return{error:s.FetchConnectionMetadataError.Aborted};let u=f.timeStart({hasCustomFetch:!!c.fetchConnectionMetadata});try{a=c.fetchConnectionMetadata?await c.fetchConnectionMetadata():await e({asViewer:n.asViewer,replId:n.repl.id,isLoggedIn:!!n.currentUser,requestedPid2Version:await S(),format:i.api.token.ReplToken.WireFormat.PROTOBUF,overrideClusterMetadata:l,...r})}catch(e){if(o.aborted)return{error:s.FetchConnectionMetadataError.Aborted};switch(e&&e.statusCode){case 400:case 401:case 403:throw new h.PleaseRefreshError(e.statusCode);case 408:case 409:case 429:case 500:case 502:case 503:case 504:case 526:return f.warn("Retriable error while fetching connection metadata",{statusCode:e.statusCode,originalMessage:e.message}),{error:s.FetchConnectionMetadataError.Retriable}}throw e}return o.aborted?{error:s.FetchConnectionMetadataError.Aborted}:(T&&console.log("connecting",a),u("fetched connection metadata"),{...a,error:null})}};C&&C>0&&(v.timeout=C),w?v.WebSocketClass=w:"u"<typeof WebSocket&&(v.WebSocketClass=o.default);let E=g.now(),k=0;R.open(v,({channel:e})=>{T&&console.log("connected",{replId:n.repl.id});let t=e.onCommand(e=>{switch(e.body){case"portOpen":{if(!e.portOpen)throw Error("portOpen only handles portOpen commands");let t=!!e.portOpen.forwarded,{address:n,cmdline:r,cgroup:o,pid:s}=e.portOpen,i=e.portOpen.port||0;if(8284===i||5901===i)return;O.emit(p.Events.PORT_OPEN,{port:i,externalPort:e.portOpen.externalPort,isVnc:5900===i,isForwarded:t,address:n,cmdline:r,cgroup:o,pid:s});break}case"portClose":{if(!e.portClose)throw Error("portClose only handles portClose commands");let t=e.portClose.port||0,{address:n}=e.portClose;if(8284===t||5901===t)return;O.emit(p.Events.PORT_CLOSE,{port:t,externalPort:e.portClose.externalPort,isVnc:5900===t,address:n});break}case"protocolError":y(new l.default("goval panic").setExtra("message",e.protocolError?.text??"protocol error"));break;case"toast":{let t=e.toast?.text;if(!t)break;O.emit(p.Events.TOAST,t)}}});u({chan0:e,gurl:R.getConnectionMetadata()?.gurl,isFirst:!0}),window.v6ws=R.ws;let r=g.now()-E;return f.info("connected to pid1",{time:r,reconnectCount:k,replid:n.repl.id,language:n.repl.language}),({willReconnect:e})=>{if(t(),!e){x=null;return}E=g.now(),k++}})},openChannel(e,t){let n=(e=>{let t;if(void 0!==E&&e.service){let n="";"string"==typeof e.service?n=e.service:x&&(n=e.service(x)),n&&(t=(0,c.createSpanFromContext)(E,`container.${n}.openChannel`).span)}return t})(e);return R.openChannel(e,e=>{let r=e.channel.onCommand(e=>{"protocolError"===e.body&&y(new l.default("goval panic").setExtra("message",e.protocolError?.text??"protocol error"))}),o=t(e);return void 0!==n&&n.end(),e=>{o&&o(e),r&&r()}})},getConnectionState:()=>R.getConnectionState(),exec:async(...e)=>(0,u.default)({client:R,args:e}),execImmediately:async(...e)=>(0,u.default)({client:R,args:e,noUserEnv:!0}),execWithEnv:async(e,...t)=>(0,u.default)({client:R,args:t,env:e}),close:(e={expectReconnect:!1})=>{R.getConnectionState()!==s.ConnectionState.DISCONNECTED&&R.close(e)},destroy:()=>{R.destroy(),O.removeAllListeners(),v()},client:()=>R,focus:()=>{let e=R.getChannel(0);e&&e.send({focused:{}})},getConnectionMetadata:()=>R.getConnectionMetadata(),getContext:()=>x,getDotdevUrl:()=>{let e=R.getConnectionMetadata();if(!e||R.getConnectionState()!==s.ConnectionState.CONNECTED)throw Error("Cannot get dot dev url when container is not connected");return n(e)},unrecoverableError:(e,t)=>{R.destroy(),O.removeAllListeners(),y(t?l.default.wrap(e).setExtras(t):e)}}}e.s(["GALLERY_PREVIEW_PORT",0,5906,"VNC_PORT",0,5900,"VSCODE_PORT",0,5905,"default",()=>f],282332);var y=e.i(664152),g=e.i(389959);async function m(){if(!("u"<typeof document)&&document.hidden)return new Promise(e=>{let t=()=>{document.hidden||(document.removeEventListener("visibilitychange",t),e())};document.addEventListener("visibilitychange",t)})}function b(){let[e,t]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{function e(){t(!document.hidden)}return document.addEventListener("visibilitychange",e),e(),()=>{document.removeEventListener("visibilitychange",e)}},[]),e}e.s(["pageVisible",()=>m,"usePageVisibility",()=>b],19379);var v=e.i(635984),C=e.i(668106),w=e.i(116680);function E({onUnrecoverableError:e,ctx:r}){let o,s,{register:i,unregister:a}={register:(e,t)=>(s(),window.addEventListener("online",e),window.addEventListener("offline",t),o=()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)},s),unregister:s=()=>{o&&(o(),o=void 0)}};return f({fetchConnectionMetadata:C.default,getOverrideClusterMetadata:w.default,getDotdevUrl:S,logger:y.logger,onUnrecoverableError:e,performance:window.performance,preFetchConnectionMetadata:async()=>{{window.performance.clearMarks(n.performanceMarks.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(n.performanceMarks.fetchConnectionMetadataPageInvisibleEnd);let e=y.logger.timeStart();window.performance.mark(n.performanceMarks.fetchConnectionMetadataPageInvisibleStart),"/migrateReplToNix"!==t.default.pathname&&await m(),window.performance.mark(n.performanceMarks.fetchConnectionMetadataPageInvisibleEnd),e("page visible fetch connection metadata")}},registerReconnectionMonitor:i,unregisterReconnectionMonitor:a,traceCtx:r,getPid2Version:v.getPid2Version})}function S(e){return e.dotdevHostname.endsWith(".localhost")?`http://${e.dotdevHostname}:8081`:`https://${e.dotdevHostname}`}e.s(["default",()=>E],792e3)},170784,122965,e=>{"use strict";var t=e.i(389959),n=e.i(992785);function r({repl:e,currentUser:t,asViewer:n}){return{asViewer:n,repl:{__typename:"Repl",authorizations:e.authorizations,id:e.id,language:e.language},currentUser:t?{__typename:"CurrentUser",id:t.id,username:t.username,isSubscribed:t.isSubscribed}:void 0}}function o(e){let o=e?r({...e}):null,s=(0,t.useRef)(o);return(0,n.default)(o,s.current)||(s.current=o),s.current}e.s(["createConnectContext",()=>r,"useMemoizedConnectContext",()=>o],170784);var s=e.i(775973),i=e.i(98816);function a(){let e=(0,s.useLDClient)(),n=(0,i.default)(e);return(0,t.useCallback)(()=>{var e;let t;return e=n.current,!Number.isFinite(t=parseInt(e?.variation("flag-container-retry-minimum-ms",0),10))||t<0?0:t},[n])}e.s(["useFlaggedRetrier",()=>a],122965)},534518,e=>{"use strict";var t=e.i(629712),n=e.i(858248),r=e.i(960933),o=e.i(469546),s=e.i(282453);let i={};function a(e,t,n,r={}){e.info("ot client dataloss",{case:t,startTime:n.startTime,opsSinceFlush:n.opsSinceFlush,whileReconnecting:n.whileReconnecting,replid:n.replId,filePath:n.filePath,...r})}let c={replsList:()=>"dataLossRepls",replFiles:e=>`dataLossReplFiles${e}`,latestOp:(e,t)=>`dataLossLatestOp--${e}--${t}`,latestFlushedOp:(e,t)=>`dataLossLatestFlushed--${e}--${t}`,latestOwnOp:(e,t)=>`dataLosslatestOwnOp--${e}--${t}`,opsSinceFlush:(e,t)=>`dataLossOpsSinceFlush--${e}--${t}`},l=r.Type.Object({crc32:r.Type.Number(),version:r.Type.Number()});function u(){let e=s.default.get(c.replsList(),r.Type.Array(r.Type.String()));return e||(e=[],s.default.set(c.replsList(),e)),e}function h(e){let t=s.default.get(c.replFiles(e),r.Type.Array(r.Type.String()));return t||(t=[],s.default.set(c.replFiles(e),t)),t}function p(e){for(let t of h(e))"string"==typeof t&&function(e,t){s.default.remove(c.latestOp(e,t)),s.default.remove(c.latestFlushedOp(e,t)),s.default.remove(c.latestOwnOp(e,t));let n=h(e).filter(e=>e!==t);s.default.set(c.replFiles(e),n)}(e,t);s.default.remove(c.replFiles(e));let t=u().filter(t=>t!==e);s.default.set(c.replsList(),t)}function d({replId:e,filePath:t}){let n;(n=u()).includes(e)||(n.length>20?(p(n[0]),n[0]=e):n.push(e),s.default.set(c.replsList(),n));let r=h(e);r.includes(t)||(r.length>20?(p(r[0]),r[0]=t):r.push(t),s.default.set(c.replFiles(e),r))}function f({filePath:e,replId:t,opType:n,op:r,logger:o,isReconnecting:l}){!function({filePath:e,replId:t,opType:n,logger:r,isReconnecting:o}){let s=a.bind(null,r),c=`${t}--${e}`;i[c]||(i[c]={replId:t,filePath:e,timer:null,startTime:null,whileReconnecting:0,opsSinceFlush:0});let l=i[c];if("latestFlushedOp"===n){delete i[c];let e=l.startTime;if(e){let t=Date.now()-e;t>6e4&&s("flush_delay_received",l,{elapsed:t})}let{timer:t}=l;t&&(clearTimeout(t),l.timer=null)}else{l.opsSinceFlush+=1,o&&(l.whileReconnecting+=1);let e=l.startTime??Date.now();l.startTime=e,l.timer||(l.timer=setTimeout(()=>{s("flush_delay_timeout",l)},6e4)),150===l.opsSinceFlush?s("flush_delay_small",l):1e3===l.opsSinceFlush&&s("flush_delay_large",l)}}({filePath:e,replId:t,opType:n,logger:o,isReconnecting:l}),s.default.set(c[n](t,e),r)}let y={};async function g({filePath:e,replId:t,serverVersion:n,serverContent:r,fetchOps:i,logger:a}){if(y[e+t])return;y[e+t]=!0;let u=function(e,t){let n={latestOp:null,latestFlushedOp:null,latestOwnOp:null};for(let r of Object.keys(n)){let o=s.default.get(c[r](e,t),l);o&&o&&"object"==typeof o&&"number"==typeof o.crc32&&"number"==typeof o.version&&(n[r]=o)}return n}(t,e),h=o.str(r)>>>0;Object.keys(u).forEach(async e=>{let t,r=u[e];if(r){if(n<r.version)return void a.info("ot client dataloss",{opType:e,case:"server_forgot"});if(n===r.version){h!==r.crc32&&a.info("ot client dataloss",{opType:e,case:"crc32_mismatch"});return}try{[t]=await i(r.version,r.version)}catch(t){a.info("ot client dataloss",{opType:e,case:"error_fetching_op",originalError:String(t)});return}if(!t)return void a.info("ot client dataloss",{opType:e,case:"op_not_found"});t.crc32!==r.crc32&&a.info("ot client dataloss",{opType:e,case:"crc32_mismatch"})}})}e.s(["checkAndTrack",()=>g,"ensureTrackedFile",()=>d,"storeOp",()=>f],518656);var m=e.i(518656);function b({container:e}){return(0,t.default)({container:e,dataloss:m,track:n.track})}e.s(["default",()=>b],534518)}]);

//# debugId=0c7155db-02b1-04e6-3ad8-a577cf2d75c9
//# sourceMappingURL=e81b25ef41c2a0a0.js.map