"use strict";var __adoraExports__=(()=>{var yt=Object.defineProperty;var Ai=Object.getOwnPropertyDescriptor;var Ti=Object.getOwnPropertyNames;var ki=Object.prototype.hasOwnProperty;var _i=(e,t,r)=>t in e?yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Mi=(e,t)=>{for(var r in t)yt(e,r,{get:t[r],enumerable:!0})},xi=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ti(t))!ki.call(e,o)&&o!==r&&yt(e,o,{get:()=>t[o],enumerable:!(n=Ai(t,o))||n.enumerable});return e};var Ni=e=>xi(yt({},"__esModule",{value:!0}),e);var le=(e,t,r)=>_i(e,typeof t!="symbol"?t+"":t,r);var zl={};Mi(zl,{adoraIsRunning:()=>De,adoraStart:()=>Ul,adoraStop:()=>Fl,getDom0EventHandlers:()=>en});var Oi=/\{[^{}]+\}/g,Li=()=>typeof process=="object"&&Number.parseInt(process?.versions?.node?.substring(0,2))>=18&&process.versions.undici;function Di(){return Math.random().toString(36).slice(2,11)}function yn(e){let{baseUrl:t="",Request:r=globalThis.Request,fetch:n=globalThis.fetch,querySerializer:o,bodySerializer:i,headers:s,requestInitExt:l=void 0,...a}={...e};l=Li()?l:void 0,t=gn(t);let u=[];async function c(d,h){let{baseUrl:p,fetch:m=n,Request:f=r,headers:v,params:S={},parseAs:y="json",querySerializer:g,bodySerializer:T=i??Ui,body:I,middleware:C=[],...R}=h||{},E=t;p&&(E=gn(p)??t);let L=typeof o=="function"?o:pn(o);g&&(L=typeof g=="function"?g:pn({...typeof o=="object"?o:{},...g}));let z=I===void 0?void 0:T(I,mn(s,v,S.header)),X=mn(z===void 0||z instanceof FormData?{}:{"Content-Type":"application/json"},s,v,S.header),U=[...u,...C],J={redirect:"follow",...a,...R,body:z,headers:X},H,W,A=new f(Fi(d,{baseUrl:E,params:S,querySerializer:L}),J),_;for(let k in R)k in A||(A[k]=R[k]);if(U.length){H=Di(),W=Object.freeze({baseUrl:E,fetch:m,parseAs:y,querySerializer:L,bodySerializer:T});for(let k of U)if(k&&typeof k=="object"&&typeof k.onRequest=="function"){let D=await k.onRequest({request:A,schemaPath:d,params:S,options:W,id:H});if(D)if(D instanceof f)A=D;else if(D instanceof Response){_=D;break}else throw new Error("onRequest: must return new Request() or Response() when modifying the request")}}if(!_){try{_=await m(A,l)}catch(k){let D=k;if(U.length)for(let G=U.length-1;G>=0;G--){let Z=U[G];if(Z&&typeof Z=="object"&&typeof Z.onError=="function"){let re=await Z.onError({request:A,error:D,schemaPath:d,params:S,options:W,id:H});if(re){if(re instanceof Response){D=void 0,_=re;break}if(re instanceof Error){D=re;continue}throw new Error("onError: must return new Response() or instance of Error")}}}if(D)throw D}if(U.length)for(let k=U.length-1;k>=0;k--){let D=U[k];if(D&&typeof D=="object"&&typeof D.onResponse=="function"){let G=await D.onResponse({request:A,response:_,schemaPath:d,params:S,options:W,id:H});if(G){if(!(G instanceof Response))throw new Error("onResponse: must return new Response() when modifying the response");_=G}}}}if(_.status===204||A.method==="HEAD"||_.headers.get("Content-Length")==="0")return _.ok?{data:void 0,response:_}:{error:void 0,response:_};if(_.ok)return y==="stream"?{data:_.body,response:_}:{data:await _[y](),response:_};let Y=await _.text();try{Y=JSON.parse(Y)}catch{}return{error:Y,response:_}}return{request(d,h,p){return c(h,{...p,method:d.toUpperCase()})},GET(d,h){return c(d,{...h,method:"GET"})},PUT(d,h){return c(d,{...h,method:"PUT"})},POST(d,h){return c(d,{...h,method:"POST"})},DELETE(d,h){return c(d,{...h,method:"DELETE"})},OPTIONS(d,h){return c(d,{...h,method:"OPTIONS"})},HEAD(d,h){return c(d,{...h,method:"HEAD"})},PATCH(d,h){return c(d,{...h,method:"PATCH"})},TRACE(d,h){return c(d,{...h,method:"TRACE"})},use(...d){for(let h of d)if(h){if(typeof h!="object"||!("onRequest"in h||"onResponse"in h||"onError"in h))throw new Error("Middleware must be an object with one of `onRequest()`, `onResponse() or `onError()`");u.push(h)}},eject(...d){for(let h of d){let p=u.indexOf(h);p!==-1&&u.splice(p,1)}}}}function vt(e,t,r){if(t==null)return"";if(typeof t=="object")throw new Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return`${e}=${r?.allowReserved===!0?t:encodeURIComponent(t)}`}function vn(e,t,r){if(!t||typeof t!="object")return"";let n=[],o={simple:",",label:".",matrix:";"}[r.style]||"&";if(r.style!=="deepObject"&&r.explode===!1){for(let l in t)n.push(l,r.allowReserved===!0?t[l]:encodeURIComponent(t[l]));let s=n.join(",");switch(r.style){case"form":return`${e}=${s}`;case"label":return`.${s}`;case"matrix":return`;${e}=${s}`;default:return s}}for(let s in t){let l=r.style==="deepObject"?`${e}[${s}]`:s;n.push(vt(l,t[s],r))}let i=n.join(o);return r.style==="label"||r.style==="matrix"?`${o}${i}`:i}function Sn(e,t,r){if(!Array.isArray(t))return"";if(r.explode===!1){let i={form:",",spaceDelimited:"%20",pipeDelimited:"|"}[r.style]||",",s=(r.allowReserved===!0?t:t.map(l=>encodeURIComponent(l))).join(i);switch(r.style){case"simple":return s;case"label":return`.${s}`;case"matrix":return`;${e}=${s}`;default:return`${e}=${s}`}}let n={simple:",",label:".",matrix:";"}[r.style]||"&",o=[];for(let i of t)r.style==="simple"||r.style==="label"?o.push(r.allowReserved===!0?i:encodeURIComponent(i)):o.push(vt(e,i,r));return r.style==="label"||r.style==="matrix"?`${n}${o.join(n)}`:o.join(n)}function pn(e){return function(r){let n=[];if(r&&typeof r=="object")for(let o in r){let i=r[o];if(i!=null){if(Array.isArray(i)){if(i.length===0)continue;n.push(Sn(o,i,{style:"form",explode:!0,...e?.array,allowReserved:e?.allowReserved||!1}));continue}if(typeof i=="object"){n.push(vn(o,i,{style:"deepObject",explode:!0,...e?.object,allowReserved:e?.allowReserved||!1}));continue}n.push(vt(o,i,e))}}return n.join("&")}}function Pi(e,t){let r=e;for(let n of e.match(Oi)??[]){let o=n.substring(1,n.length-1),i=!1,s="simple";if(o.endsWith("*")&&(i=!0,o=o.substring(0,o.length-1)),o.startsWith(".")?(s="label",o=o.substring(1)):o.startsWith(";")&&(s="matrix",o=o.substring(1)),!t||t[o]===void 0||t[o]===null)continue;let l=t[o];if(Array.isArray(l)){r=r.replace(n,Sn(o,l,{style:s,explode:i}));continue}if(typeof l=="object"){r=r.replace(n,vn(o,l,{style:s,explode:i}));continue}if(s==="matrix"){r=r.replace(n,`;${vt(o,l)}`);continue}r=r.replace(n,s==="label"?`.${encodeURIComponent(l)}`:encodeURIComponent(l))}return r}function Ui(e,t){return e instanceof FormData?e:t&&(t.get instanceof Function?t.get("Content-Type")??t.get("content-type"):t["Content-Type"]??t["content-type"])==="application/x-www-form-urlencoded"?new URLSearchParams(e).toString():JSON.stringify(e)}function Fi(e,t){let r=`${t.baseUrl}${e}`;t.params?.path&&(r=Pi(r,t.params.path));let n=t.querySerializer(t.params.query??{});return n.startsWith("?")&&(n=n.substring(1)),n&&(r+=`?${n}`),r}function mn(...e){let t=new Headers;for(let r of e){if(!r||typeof r!="object")continue;let n=r instanceof Headers?r.entries():Object.entries(r);for(let[o,i]of n)if(i===null)t.delete(o);else if(Array.isArray(i))for(let s of i)t.append(o,s);else i!==void 0&&t.set(o,i)}return t}function gn(e){return e.endsWith("/")?e.substring(0,e.length-1):e}var Cn=new Map;function Ee(e){let t=Cn.get(e);if(t)return t;let r=new ze(wn[e]);return Cn.set(e,r),r}var ze=class{constructor(t){le(this,"backendClient");le(this,"eventPostBackendClient");this.backendClient=ir({baseUrl:t??bn})}getOrCreateEventPostClient(t){return!t.eventPostUrl||!t.eventPostToken?{path:t.sessionId,client:this.backendClient}:(this.eventPostBackendClient||(this.eventPostBackendClient=ir({baseUrl:t.eventPostUrl})),{path:t.sessionId,client:this.eventPostBackendClient})}async sessionPreload({orgId:t}){return this.backendClient.POST("/sessions/preload",{body:{orgId:t},mode:"cors"}).catch(()=>{})}async startSession({bypassSampling:t,orgId:r,language:n,domain:o,userCohorts:i,uid:s,devicePixelRatio:l,adoraUserId:a,userAgent:u,documentReferrer:c,snippetVersion:d}){return this.backendClient.POST("/sessions/start",{body:{bypassSampling:t,orgId:r,language:n,domain:o,devicePixelRatio:l,userCohorts:i||{},userAgent:u,uid:typeof s=="number"?s.toString():s!=="null"&&s!=="undefined"?s:void 0,adoraUserId:a,documentReferrer:c,snippetVersion:d},mode:"cors"}).catch(()=>{})}async gzipWithCompressionStream(t){let r=JSON.stringify(t),o=new TextEncoder().encode(r),i=new CompressionStream("gzip"),l=new ReadableStream({start(u){u.enqueue(o),u.close()}}).pipeThrough(i);return new Response(l).arrayBuffer()}async saveSessionEvents({sessionId:t,events:r,metadata:n,eventPostUrl:o,eventPostToken:i,fastpathToken:s}){let{path:l,client:a}=this.getOrCreateEventPostClient({sessionId:t,eventPostToken:i,eventPostUrl:o}),u={events:r.slice(),metadata:n,fastpathToken:s},c={params:{path:{sessionId:l}},headers:i?{token:i}:void 0};if(typeof CompressionStream<"u"){let d=await this.gzipWithCompressionStream(u);return a.POSTGzipped("/sessions/{sessionId}/events",{...c,body:d}).catch(()=>{})}return a.POST("/sessions/{sessionId}/events",{...c,body:u}).catch(()=>{})}async refreshEventToken(t){return await this.backendClient.POST("/sessions/{sessionId}/events/token",{params:{path:{sessionId:t.sessionId}},body:{},mode:"cors"}).catch(()=>{})}async syncSession(t){return await this.backendClient.POST("/sessions/{sessionId}/sync",{params:{path:{sessionId:t.sessionId}}}).catch(()=>{})}async getOrganizationRouting({orgId:t}){return await this.backendClient.GET("/organizations/{orgId}/routing",{params:{path:{orgId:t}}}).catch(()=>{})}};var ir=e=>({...yn(e),POSTGzipped:async(r,n)=>{if(!n?.body)throw new Error("Body is required for gzipped requests");let o={...n.headers,"Content-Type":"application/json","Content-Encoding":"gzip"},i=r;n.params?.path&&Object.entries(n.params.path).forEach(([a,u])=>{i=i.replace(`{${a}}`,u)});let s=await fetch(`${e.baseUrl}${i}`,{method:"POST",headers:o,body:n.body});if(!s.ok){let a=await s.text();try{a=JSON.parse(a)}catch{}return{data:void 0,error:a,response:s}}return{data:await s.json(),error:void 0,response:s}}});var zi="http://localhost:8080",En="https://c.adora-cdn.com",Wi="https://usw2-c.adora-cdn.com",bn=En,wn={"ap-southeast-2":En,"us-west-2":Wi,localhost:zi};var Bi=Object.getOwnPropertyNames,Hi=Object.getOwnPropertySymbols,Gi=Object.prototype.hasOwnProperty;function Rn(e,t){return function(n,o,i){return e(n,o,i)&&t(n,o,i)}}function St(e){return function(r,n,o){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,o);var i=o.cache,s=i.get(r),l=i.get(n);if(s&&l)return s===n&&l===r;i.set(r,n),i.set(n,r);var a=e(r,n,o);return i.delete(r),i.delete(n),a}}function Vi(e){return e?.[Symbol.toStringTag]}function In(e){return Bi(e).concat(Hi(e))}var ji=Object.hasOwn||(function(e,t){return Gi.call(e,t)});function xe(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var qi="__v",$i="__o",Yi="_owner",An=Object.getOwnPropertyDescriptor,Tn=Object.keys;function Zi(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Ki(e,t){return xe(e.getTime(),t.getTime())}function Xi(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Ji(e,t){return e===t}function kn(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),i=e.entries(),s,l,a=0;(s=i.next())&&!s.done;){for(var u=t.entries(),c=!1,d=0;(l=u.next())&&!l.done;){if(o[d]){d++;continue}var h=s.value,p=l.value;if(r.equals(h[0],p[0],a,d,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){c=o[d]=!0;break}d++}if(!c)return!1;a++}return!0}var Qi=xe;function es(e,t,r){var n=Tn(e),o=n.length;if(Tn(t).length!==o)return!1;for(;o-- >0;)if(!Nn(e,t,r,n[o]))return!1;return!0}function Je(e,t,r){var n=In(e),o=n.length;if(In(t).length!==o)return!1;for(var i,s,l;o-- >0;)if(i=n[o],!Nn(e,t,r,i)||(s=An(e,i),l=An(t,i),(s||l)&&(!s||!l||s.configurable!==l.configurable||s.enumerable!==l.enumerable||s.writable!==l.writable)))return!1;return!0}function ts(e,t){return xe(e.valueOf(),t.valueOf())}function rs(e,t){return e.source===t.source&&e.flags===t.flags}function _n(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var o=new Array(n),i=e.values(),s,l;(s=i.next())&&!s.done;){for(var a=t.values(),u=!1,c=0;(l=a.next())&&!l.done;){if(!o[c]&&r.equals(s.value,l.value,s.value,l.value,e,t,r)){u=o[c]=!0;break}c++}if(!u)return!1}return!0}function ns(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function os(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Nn(e,t,r,n){return(n===Yi||n===$i||n===qi)&&(e.$$typeof||t.$$typeof)?!0:ji(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var is="[object Arguments]",ss="[object Boolean]",as="[object Date]",ls="[object Error]",cs="[object Map]",us="[object Number]",ds="[object Object]",fs="[object RegExp]",hs="[object Set]",ps="[object String]",ms="[object URL]",gs=Array.isArray,Mn=typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView:null,xn=Object.assign,ys=Object.prototype.toString.call.bind(Object.prototype.toString);function vs(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,o=e.areFunctionsEqual,i=e.areMapsEqual,s=e.areNumbersEqual,l=e.areObjectsEqual,a=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,c=e.areSetsEqual,d=e.areTypedArraysEqual,h=e.areUrlsEqual,p=e.unknownTagComparators;return function(f,v,S){if(f===v)return!0;if(f==null||v==null)return!1;var y=typeof f;if(y!==typeof v)return!1;if(y!=="object")return y==="number"?s(f,v,S):y==="function"?o(f,v,S):!1;var g=f.constructor;if(g!==v.constructor)return!1;if(g===Object)return l(f,v,S);if(gs(f))return t(f,v,S);if(Mn!=null&&Mn(f))return d(f,v,S);if(g===Date)return r(f,v,S);if(g===RegExp)return u(f,v,S);if(g===Map)return i(f,v,S);if(g===Set)return c(f,v,S);var T=ys(f);if(T===as)return r(f,v,S);if(T===fs)return u(f,v,S);if(T===cs)return i(f,v,S);if(T===hs)return c(f,v,S);if(T===ds)return typeof f.then!="function"&&typeof v.then!="function"&&l(f,v,S);if(T===ms)return h(f,v,S);if(T===ls)return n(f,v,S);if(T===is)return l(f,v,S);if(T===ss||T===us||T===ps)return a(f,v,S);if(p){var I=p[T];if(!I){var C=Vi(f);C&&(I=p[C])}if(I)return I(f,v,S)}return!1}}function Ss(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,o={areArraysEqual:n?Je:Zi,areDatesEqual:Ki,areErrorsEqual:Xi,areFunctionsEqual:Ji,areMapsEqual:n?Rn(kn,Je):kn,areNumbersEqual:Qi,areObjectsEqual:n?Je:es,arePrimitiveWrappersEqual:ts,areRegExpsEqual:rs,areSetsEqual:n?Rn(_n,Je):_n,areTypedArraysEqual:n?Je:ns,areUrlsEqual:os,unknownTagComparators:void 0};if(r&&(o=xn({},o,r(o))),t){var i=St(o.areArraysEqual),s=St(o.areMapsEqual),l=St(o.areObjectsEqual),a=St(o.areSetsEqual);o=xn({},o,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:l,areSetsEqual:a})}return o}function Cs(e){return function(t,r,n,o,i,s,l){return e(t,r,l)}}function bs(e){var t=e.circular,r=e.comparator,n=e.createState,o=e.equals,i=e.strict;if(n)return function(a,u){var c=n(),d=c.cache,h=d===void 0?t?new WeakMap:void 0:d,p=c.meta;return r(a,u,{cache:h,equals:o,meta:p,strict:i})};if(t)return function(a,u){return r(a,u,{cache:new WeakMap,equals:o,meta:void 0,strict:i})};var s={cache:void 0,equals:o,meta:void 0,strict:i};return function(a,u){return r(a,u,s)}}var rc=Re(),On=Re({strict:!0}),nc=Re({circular:!0}),oc=Re({circular:!0,strict:!0}),ic=Re({createInternalComparator:function(){return xe}}),sc=Re({strict:!0,createInternalComparator:function(){return xe}}),ac=Re({circular:!0,createInternalComparator:function(){return xe}}),lc=Re({circular:!0,createInternalComparator:function(){return xe},strict:!0});function Re(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,o=e.createState,i=e.strict,s=i===void 0?!1:i,l=Ss(e),a=vs(l),u=n?n(a):Cs(a);return bs({circular:r,comparator:a,createState:o,equals:u,strict:s})}function Ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var ws={read:function(e){return e[0]==='"'&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function sr(e,t){function r(o,i,s){if(!(typeof document>"u")){s=Ct({},t,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),o=encodeURIComponent(o).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var a in s)s[a]&&(l+="; "+a,s[a]!==!0&&(l+="="+s[a].split(";")[0]));return document.cookie=o+"="+e.write(i,o)+l}}function n(o){if(!(typeof document>"u"||arguments.length&&!o)){for(var i=document.cookie?document.cookie.split("; "):[],s={},l=0;l<i.length;l++){var a=i[l].split("="),u=a.slice(1).join("=");try{var c=decodeURIComponent(a[0]);if(s[c]=e.read(u,c),o===c)break}catch{}}return o?s[o]:s}}return Object.create({set:r,get:n,remove:function(o,i){r(o,"",Ct({},i,{expires:-1}))},withAttributes:function(o){return sr(this.converter,Ct({},this.attributes,o))},withConverter:function(o){return sr(Ct({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(t)},converter:{value:Object.freeze(e)}})}var Qe=sr(ws,{path:"/"});var bt="0123456789abcdef",wt=class e{constructor(t){this.bytes=t}static ofInner(t){if(t.length!==16)throw new TypeError("not 128-bit length");return new e(t)}static fromFieldsV7(t,r,n,o){if(!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(n)||!Number.isInteger(o)||t<0||r<0||n<0||o<0||t>0xffffffffffff||r>4095||n>1073741823||o>4294967295)throw new RangeError("invalid field value");let i=new Uint8Array(16);return i[0]=t/2**40,i[1]=t/2**32,i[2]=t/2**24,i[3]=t/2**16,i[4]=t/2**8,i[5]=t,i[6]=112|r>>>8,i[7]=r,i[8]=128|n>>>24,i[9]=n>>>16,i[10]=n>>>8,i[11]=n,i[12]=o>>>24,i[13]=o>>>16,i[14]=o>>>8,i[15]=o,new e(i)}static parse(t){var r,n,o,i;let s;switch(t.length){case 32:s=(r=/^[0-9a-f]{32}$/i.exec(t))===null||r===void 0?void 0:r[0];break;case 36:s=(n=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(t))===null||n===void 0?void 0:n.slice(1,6).join("");break;case 38:s=(o=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(t))===null||o===void 0?void 0:o.slice(1,6).join("");break;case 45:s=(i=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(t))===null||i===void 0?void 0:i.slice(1,6).join("");break;default:break}if(s){let l=new Uint8Array(16);for(let a=0;a<16;a+=4){let u=parseInt(s.substring(2*a,2*a+8),16);l[a+0]=u>>>24,l[a+1]=u>>>16,l[a+2]=u>>>8,l[a+3]=u}return new e(l)}else throw new SyntaxError("could not parse UUID string")}toString(){let t="";for(let r=0;r<this.bytes.length;r++)t+=bt.charAt(this.bytes[r]>>>4),t+=bt.charAt(this.bytes[r]&15),(r===3||r===5||r===7||r===9)&&(t+="-");return t}toHex(){let t="";for(let r=0;r<this.bytes.length;r++)t+=bt.charAt(this.bytes[r]>>>4),t+=bt.charAt(this.bytes[r]&15);return t}toJSON(){return this.toString()}getVariant(){let t=this.bytes[8]>>>4;if(t<0)throw new Error("unreachable");if(t<=7)return this.bytes.every(r=>r===0)?"NIL":"VAR_0";if(t<=11)return"VAR_10";if(t<=13)return"VAR_110";if(t<=15)return this.bytes.every(r=>r===255)?"MAX":"VAR_RESERVED";throw new Error("unreachable")}getVersion(){return this.getVariant()==="VAR_10"?this.bytes[6]>>>4:void 0}clone(){return new e(this.bytes.slice(0))}equals(t){return this.compareTo(t)===0}compareTo(t){for(let r=0;r<16;r++){let n=this.bytes[r]-t.bytes[r];if(n!==0)return Math.sign(n)}return 0}},ar=class{constructor(t){this.timestamp=0,this.counter=0,this.random=t??Es()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(t,r){let n=this.generateOrAbortCore(t,r);return n===void 0&&(this.timestamp=0,n=this.generateOrAbortCore(t,r)),n}generateOrAbortCore(t,r){if(!Number.isInteger(t)||t<1||t>0xffffffffffff)throw new RangeError("`unixTsMs` must be a 48-bit positive integer");if(r<0||r>0xffffffffffff)throw new RangeError("`rollbackAllowance` out of reasonable range");if(t>this.timestamp)this.timestamp=t,this.resetCounter();else if(t+r>=this.timestamp)this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter());else return;return wt.fromFieldsV7(this.timestamp,Math.trunc(this.counter/2**30),this.counter&2**30-1,this.random.nextUint32())}resetCounter(){this.counter=this.random.nextUint32()*1024+(this.random.nextUint32()&1023)}generateV4(){let t=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return t[6]=64|t[6]>>>4,t[8]=128|t[8]>>>2,wt.ofInner(t)}},Es=()=>{if(typeof crypto<"u"&&typeof crypto.getRandomValues<"u")return new lr;if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");return{nextUint32:()=>Math.trunc(Math.random()*65536)*65536+Math.trunc(Math.random()*65536)}},lr=class{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}},Ln,Dn=()=>Rs().toString(),Rs=()=>(Ln||(Ln=new ar)).generate();var Et=class{constructor(t,r){this.storage=r;this.eventStorageKey=t==="adoraSessionScript"?"adoraEventsScript":"adoraEventsExtension"}getEvents(){let t=this.storage.getItem(this.eventStorageKey);return t?JSON.parse(t):null}setEvents(t){this.storage.setItem(this.eventStorageKey,JSON.stringify(t))}removeEvents(){this.storage.removeItem(this.eventStorageKey)}};function cr(e){return`${e}-rate-limit-timestamp`}var Ie=class{constructor(t,r){this.sessionType=t;this.storage=r}get lastRateLimitedTimestamp(){let t=this.storage.getItem(cr(this.sessionType));if(Is(t))return t}clearLastRateLimitedTimestamp(){this.storage.removeItem(cr(this.sessionType))}setLastRateLimitedTimestamp(t){this.storage.setItem(cr(this.sessionType),t.toString())}getSession(){let t=this.storage.getItem(this.sessionType);return t?JSON.parse(t):null}setSession(t){this.storage.setItem(this.sessionType,JSON.stringify(t))}removeSession(){this.storage.removeItem(this.sessionType)}};function Is(e){return!Number.isNaN(Number(e))}function w(e,...t){(typeof window=="object"&&window.enableAdoraDebugLogs||typeof window=="object"&&window.localStorage.getItem("enableAdoraDebugLogs"))&&console.log(e,...t)}function Pn(e){return{id:e.id,pathConfig:e.pathConfig,allowedQueryParams:e.allowedQueryParams,cookieDomains:e.cookieDomains,cohortsBootstrapConfig:e.cohortsBootstrapConfig||{},customQueryParamsCohorts:e.customQueryParamsCohorts,blockedCSSClasses:e.blockedCSSClasses||[],maskedCSSClasses:e.maskedCSSClasses,maskByDefault:e.maskByDefault??!1,unmaskSelectors:e.unmaskSelectors||[]}}function As(e){return{id:e.id,compressionType:e.compressionType||"NONE",canvasRecordingEnabled:e.canvasRecordingEnabled,limitedCanvasRecording:e.limitedCanvasRecording}}function Un(e){return"scheduledDowntime"in e?{scheduledDowntime:!0}:{organization:Pn(e.organization)}}function Rt(e){return{session:As(e.session),organization:Pn(e.organization),eventPostUrl:e.eventPostUrl,eventPostToken:e.eventPostToken}}function Fn(e,t,r,n){return{id:e.session.id,compressionType:e.session.compressionType,organization:e.organization,settings:t,canvasRecordingEnabled:e.session.canvasRecordingEnabled,limitedCanvasRecording:e.session.limitedCanvasRecording,eventPostUrl:e.eventPostUrl,eventPostToken:e.eventPostToken,adoraUserId:r,documentReferrer:n}}function zn(e,t){return{id:t.session.id,compressionType:t.session.compressionType,organization:t.organization,settings:e.settings,canvasRecordingEnabled:t.session.canvasRecordingEnabled,limitedCanvasRecording:t.session.limitedCanvasRecording,eventPostUrl:t.eventPostUrl,eventPostToken:t.eventPostToken,adoraUserId:e.adoraUserId,documentReferrer:e.documentReferrer}}var ve=class{getItem(t){if(!ur())return null;try{return window.sessionStorage.getItem(t)}catch{return null}}setItem(t,r){if(!ur())return null;try{return window.sessionStorage.setItem(t,r)}catch{return null}}removeItem(t){if(!ur())return null;try{return window.sessionStorage.removeItem(t)}catch{return null}}};function ur(){return typeof window.sessionStorage=="object"}var It="v0.1.5";var Wn=async(e,t,r)=>{let n=new Ie(e,new ve),o=Ee(r.backendRegion||"ap-southeast-2"),i=await Ts(o,r,t);return i.type==="success"&&n.setSession(i.storedSession),i};async function Ts(e,t,r){try{w("starting session over network",{uid:t.uid,userCohorts:t.userCohorts||{}});let n=await e.startSession({bypassSampling:t.bypassSampling,orgId:t.orgId,language:t.language||navigator.language,domain:new URL(window.location.href).hostname,userCohorts:t.userCohorts||{},uid:t.uid,devicePixelRatio:window.devicePixelRatio,adoraUserId:r,documentReferrer:document.referrer,snippetVersion:It});if(!n)return{type:"error",code:void 0};if(n.error)return{type:"error",code:n.error.code};if(n.response.status!==201)return w("session not created, aborting"),{type:"error",code:"code"in n.data?n.data.code:void 0};if(n.data&&"scheduledDowntime"in n.data)return w("scheduled downtime, exiting"),{type:"error",code:void 0};if(!n.data||!("session"in n.data))return w("malformed session, exiting"),{type:"error",code:void 0};let o=Rt(n.data);return{type:"success",storedSession:Fn(o,t,r,n.data.session.documentReferrer)}}catch{return{type:"error",code:void 0}}}var Yn=-1,et=e=>{addEventListener("pageshow",(t=>{t.persisted&&(Yn=t.timeStamp,e(t))}),!0)},Ae=(e,t,r,n)=>{let o,i;return s=>{t.value>=0&&(s||n)&&(i=t.value-(o??0),(i||o===void 0)&&(o=t.value,t.delta=i,t.rating=((l,a)=>l>a[1]?"poor":l>a[0]?"needs-improvement":"good")(t.value,r),e(t)))}},vr=e=>{requestAnimationFrame((()=>requestAnimationFrame((()=>e()))))},Zn=()=>{let e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Tt=()=>Zn()?.activationStart??0,Te=(e,t=-1)=>{let r=Zn(),n="navigate";return Yn>=0?n="back-forward-cache":r&&(document.prerendering||Tt()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+1e12}`,navigationType:n}},dr=new WeakMap;function Sr(e,t){return dr.get(e)||dr.set(e,new t),dr.get(e)}var hr=class{constructor(){le(this,"t");le(this,"i",0);le(this,"o",[])}h(t){if(t.hadRecentInput)return;let r=this.o[0],n=this.o.at(-1);this.i&&r&&n&&t.startTime-n.startTime<1e3&&t.startTime-r.startTime<5e3?(this.i+=t.value,this.o.push(t)):(this.i=t.value,this.o=[t]),this.t?.(t)}},tt=(e,t,r={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let n=new PerformanceObserver((o=>{Promise.resolve().then((()=>{t(o.getEntries())}))}));return n.observe({type:e,buffered:!0,...r}),n}}catch{}},Cr=e=>{let t=!1;return()=>{t||(e(),t=!0)}},We=-1,Kn=new Set,Bn=()=>document.visibilityState!=="hidden"||document.prerendering?1/0:0,pr=e=>{if(document.visibilityState==="hidden"){if(e.type==="visibilitychange")for(let t of Kn)t();isFinite(We)||(We=e.type==="visibilitychange"?e.timeStamp:0,removeEventListener("prerenderingchange",pr,!0))}},kt=()=>{if(We<0){let e=Tt();We=(document.prerendering?void 0:globalThis.performance.getEntriesByType("visibility-state").filter((r=>r.name==="hidden"&&r.startTime>e))[0]?.startTime)??Bn(),addEventListener("visibilitychange",pr,!0),addEventListener("prerenderingchange",pr,!0),et((()=>{setTimeout((()=>{We=Bn()}))}))}return{get firstHiddenTime(){return We},onHidden(e){Kn.add(e)}}},br=e=>{document.prerendering?addEventListener("prerenderingchange",(()=>e()),!0):e()},Hn=[1800,3e3],ks=(e,t={})=>{br((()=>{let r=kt(),n,o=Te("FCP"),i=tt("paint",(s=>{for(let l of s)l.name==="first-contentful-paint"&&(i.disconnect(),l.startTime<r.firstHiddenTime&&(o.value=Math.max(l.startTime-Tt(),0),o.entries.push(l),n(!0)))}));i&&(n=Ae(e,o,Hn,t.reportAllChanges),et((s=>{o=Te("FCP"),n=Ae(e,o,Hn,t.reportAllChanges),vr((()=>{o.value=performance.now()-s.timeStamp,n(!0)}))})))}))},Gn=[.1,.25],Xn=(e,t={})=>{let r=kt();ks(Cr((()=>{let n,o=Te("CLS",0),i=Sr(t,hr),s=a=>{for(let u of a)i.h(u);i.i>o.value&&(o.value=i.i,o.entries=i.o,n())},l=tt("layout-shift",s);l&&(n=Ae(e,o,Gn,t.reportAllChanges),r.onHidden((()=>{s(l.takeRecords()),n(!0)})),et((()=>{i.i=0,o=Te("CLS",0),n=Ae(e,o,Gn,t.reportAllChanges),vr((()=>n()))})),setTimeout(n))})))},Jn=0,fr=1/0,At=0,_s=e=>{for(let t of e)t.interactionId&&(fr=Math.min(fr,t.interactionId),At=Math.max(At,t.interactionId),Jn=At?(At-fr)/7+1:0)},mr,Vn=()=>mr?Jn:performance.interactionCount??0,Ms=()=>{"interactionCount"in performance||mr||(mr=tt("event",_s,{type:"event",buffered:!0,durationThreshold:0}))},jn=0,gr=class{constructor(){le(this,"u",[]);le(this,"l",new Map);le(this,"m");le(this,"p")}v(){jn=Vn(),this.u.length=0,this.l.clear()}L(){let t=Math.min(this.u.length-1,Math.floor((Vn()-jn)/50));return this.u[t]}h(t){if(this.m?.(t),!t.interactionId&&t.entryType!=="first-input")return;let r=this.u.at(-1),n=this.l.get(t.interactionId);if(n||this.u.length<10||t.duration>r.P){if(n?t.duration>n.P?(n.entries=[t],n.P=t.duration):t.duration===n.P&&t.startTime===n.entries[0].startTime&&n.entries.push(t):(n={id:t.interactionId,entries:[t],P:t.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort(((o,i)=>i.P-o.P)),this.u.length>10){let o=this.u.splice(10);for(let i of o)this.l.delete(i.id)}this.p?.(n)}}},Qn=e=>{let t=globalThis.requestIdleCallback||setTimeout;document.visibilityState==="hidden"?e():(e=Cr(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t((()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})})))},qn=[200,500],eo=(e,t={})=>{if(!globalThis.PerformanceEventTiming||!("interactionId"in PerformanceEventTiming.prototype))return;let r=kt();br((()=>{Ms();let n,o=Te("INP"),i=Sr(t,gr),s=a=>{Qn((()=>{for(let c of a)i.h(c);let u=i.L();u&&u.P!==o.value&&(o.value=u.P,o.entries=u.entries,n())}))},l=tt("event",s,{durationThreshold:t.durationThreshold??40});n=Ae(e,o,qn,t.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0}),r.onHidden((()=>{s(l.takeRecords()),n(!0)})),et((()=>{i.v(),o=Te("INP"),n=Ae(e,o,qn,t.reportAllChanges)})))}))},yr=class{constructor(){le(this,"m")}h(t){this.m?.(t)}},$n=[2500,4e3],to=(e,t={})=>{br((()=>{let r=kt(),n,o=Te("LCP"),i=Sr(t,yr),s=a=>{t.reportAllChanges||(a=a.slice(-1));for(let u of a)i.h(u),u.startTime<r.firstHiddenTime&&(o.value=Math.max(u.startTime-Tt(),0),o.entries=[u],n())},l=tt("largest-contentful-paint",s);if(l){n=Ae(e,o,$n,t.reportAllChanges);let a=Cr((()=>{s(l.takeRecords()),l.disconnect(),n(!0)})),u=c=>{c.isTrusted&&(Qn(a),removeEventListener(c.type,u,{capture:!0}))};for(let c of["keydown","click","visibilitychange"])addEventListener(c,u,{capture:!0});et((c=>{o=Te("LCP"),n=Ae(e,o,$n,t.reportAllChanges),vr((()=>{o.value=performance.now()-c.timeStamp,n(!0)}))}))}}))};var ro="__STATSIG__",Ns="statsig@@",no=e=>{try{if(!e[ro])return;let t=e[ro];if(!Ls(t))return;let r={};return Object.values(t.instances).forEach(n=>{n._logger?._lastExposureTimeMap&&Object.keys(n._logger?._lastExposureTimeMap).forEach(o=>{let i=Os(o);if(!i)return;let s=n.getExperiment(i);Us(s)&&(r[Ns+s.name]=s.groupName)})}),r}catch{return}},Os=e=>{let t=e.split("|");if(t.length>3)return t[3]};function Ls(e){if(!e||typeof e!="object"||!("instances"in e)||typeof e.instances!="object"||!e.instances)return!1;let t=Object.values(e.instances);for(let r of t)if(!Ds(r))return!1;return!0}function Ds(e){return!e||typeof e!="object"?!1:"_logger"in e&&typeof e._logger=="object"&&Ps(e._logger)&&"_sdkKey"in e&&typeof e._sdkKey=="string"&&"getExperiment"in e&&typeof e.getExperiment=="function"}function Ps(e){return!e||typeof e!="object"?!1:"_lastExposureTimeMap"in e&&typeof e._lastExposureTimeMap=="object"}function Us(e){return!e||typeof e!="object"?!1:"name"in e&&typeof e.name=="string"&&"groupName"in e&&typeof e.groupName=="string"}function _t(e,t){if(!t.windowGetters)return;let r={};if(t.windowGetters.forEach(({key:n,paths:o})=>{let i=Fs(e,o);i&&(r[n]=i)}),Object.keys(r).length!==0)return r}function Fs(e,t){if(typeof e>"u")return;let r=e;for(let o=0;o<t.length-1;o++)if(r=r[t[o]],typeof r!="object")return;let n=r[t[t.length-1]];if(typeof n=="string")return n;if(typeof n=="boolean"||typeof n=="number")return n.toString()}function wr(e){return no(e)}var zs=Object.defineProperty,Ws=(e,t,r)=>t in e?zs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,b=(e,t,r)=>Ws(e,typeof t!="symbol"?t+"":t,r),oo,Bs=Object.defineProperty,Hs=(e,t,r)=>t in e?Bs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,io=(e,t,r)=>Hs(e,typeof t!="symbol"?t+"":t,r),K=(e=>(e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment",e))(K||{}),so={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},ao={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},Mt={};function Gr(e){if(Mt[e])return Mt[e];let t=globalThis[e],r=t.prototype,n=e in so?so[e]:void 0,o=!!(n&&n.every(l=>{var a,u;return!!((u=(a=Object.getOwnPropertyDescriptor(r,l))==null?void 0:a.get)!=null&&u.toString().includes("[native code]"))})),i=e in ao?ao[e]:void 0,s=!!(i&&i.every(l=>{var a;return typeof r[l]=="function"&&((a=r[l])==null?void 0:a.toString().includes("[native code]"))}));if(o&&s)return Mt[e]=t.prototype,t.prototype;try{let l=document.createElement("iframe");document.body.appendChild(l);let a=l.contentWindow;if(!a)return t.prototype;let u=a[e].prototype;return document.body.removeChild(l),u?Mt[e]=u:r}catch{return r}}var Er={};function _e(e,t,r){var n;let o=`${e}.${String(r)}`;if(Er[o])return Er[o].call(t);let i=Gr(e),s=(n=Object.getOwnPropertyDescriptor(i,r))==null?void 0:n.get;return s?(Er[o]=s,s.call(t)):t[r]}var Rr={};function Io(e,t,r){let n=`${e}.${String(r)}`;if(Rr[n])return Rr[n].bind(t);let i=Gr(e)[r];return typeof i!="function"?t[r]:(Rr[n]=i,i.bind(t))}function Gs(e){return _e("Node",e,"childNodes")}function Vs(e){return _e("Node",e,"parentNode")}function js(e){return _e("Node",e,"parentElement")}function qs(e){return _e("Node",e,"textContent")}function $s(e,t){return Io("Node",e,"contains")(t)}function Ys(e){return Io("Node",e,"getRootNode")()}function Zs(e){return!e||!("host"in e)?null:_e("ShadowRoot",e,"host")}function Ks(e){return e.styleSheets}function Xs(e){return!e||!("shadowRoot"in e)?null:_e("Element",e,"shadowRoot")}function Js(e,t){return _e("Element",e,"querySelector")(t)}function Qs(e,t){return _e("Element",e,"querySelectorAll")(t)}function ea(){return Gr("MutationObserver").constructor}var ee={childNodes:Gs,parentNode:Vs,parentElement:js,textContent:qs,contains:$s,getRootNode:Ys,host:Zs,styleSheets:Ks,shadowRoot:Xs,querySelector:Js,querySelectorAll:Qs,mutationObserver:ea};function Ao(e){return e.nodeType===e.ELEMENT_NODE}function nt(e){let t=e&&"host"in e&&"mode"in e&&ee.host(e)||null;return!!(t&&"shadowRoot"in t&&ee.shadowRoot(t)===e)}function ot(e){return Object.prototype.toString.call(e)==="[object ShadowRoot]"}function ta(e){return e.includes(" background-clip: text;")&&!e.includes(" -webkit-background-clip: text;")&&(e=e.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),e}function ra(e){let{cssText:t}=e;if(t.split('"').length<3)return t;let r=["@import",`url(${JSON.stringify(e.href)})`];return e.layerName===""?r.push("layer"):e.layerName&&r.push(`layer(${e.layerName})`),e.supportsText&&r.push(`supports(${e.supportsText})`),e.media.length&&r.push(e.media.mediaText),r.join(" ")+";"}function Mr(e){try{let t=e.rules||e.cssRules;if(!t)return null;let r=e.href;!r&&e.ownerNode&&e.ownerNode.ownerDocument&&(r=e.ownerNode.ownerDocument.location.href);let n=Array.from(t,o=>To(o,r)).join("");return ta(n)}catch{return null}}function To(e,t){if(oa(e)){let r;try{r=Mr(e.styleSheet)||ra(e)}catch{r=e.cssText}return e.styleSheet.href?Ft(r,e.styleSheet.href):r}else{let r=e.cssText;return ia(e)&&e.selectorText.includes(":")&&(r=na(r)),t?Ft(r,t):r}}function na(e){let t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}function oa(e){return"styleSheet"in e}function ia(e){return"selectorText"in e}var Pt=class{constructor(){io(this,"idNodeMap",new Map),io(this,"nodeMetaMap",new WeakMap)}getId(t){var r;return t?((r=this.getMeta(t))==null?void 0:r.id)??-1:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){let r=this.getId(t);this.idNodeMap.delete(r),t.childNodes&&t.childNodes.forEach(n=>this.removeNodeFromMap(n))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,r){let n=r.id;this.idNodeMap.set(n,t),this.nodeMetaMap.set(t,r)}replace(t,r){let n=this.getNode(t);if(n){let o=this.nodeMetaMap.get(n);o&&this.nodeMetaMap.set(r,o)}this.idNodeMap.set(t,r)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function sa(){return new Pt}function Ut({element:e,maskInputOptions:t,tagName:r,type:n,value:o,maskInputFn:i}){let s=o||"",l=n&&Oe(n);return(t[r.toLowerCase()]||l&&t[l])&&(i?s=i(s,e):s="*".repeat(s.length)),s}function Oe(e){return e.toLowerCase()}var lo="__rrweb_original__";function aa(e){let t=e.getContext("2d");if(!t)return!0;let r=50;for(let n=0;n<e.width;n+=r)for(let o=0;o<e.height;o+=r){let i=t.getImageData,s=lo in i?i[lo]:i;if(new Uint32Array(s.call(t,n,o,Math.min(r,e.width-n),Math.min(r,e.height-o)).data.buffer).some(a=>a!==0))return!1}return!0}function Vr(e){let t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?Oe(t):null}function ko(e,t){let r;try{r=new URL(e,t??window.location.href)}catch{return null}let n=/\.([0-9a-z]+)(?:$)/i,o=r.pathname.match(n);return o?.[1]??null}function la(e){let t="";return e.indexOf("//")>-1?t=e.split("/").slice(0,3).join("/"):t=e.split("/")[0],t=t.split("?")[0],t}var ca=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,ua=/^(?:[a-z+]+:)?\/\//i,da=/^www\..*/i,fa=/^(data:)([^,]*),(.*)/i;function Ft(e,t){return(e||"").replace(ca,(r,n,o,i,s,l)=>{let a=o||s||l,u=n||i||"";if(!a)return r;if(ua.test(a)||da.test(a))return`url(${u}${a}${u})`;if(fa.test(a))return`url(${u}${a}${u})`;if(a[0]==="/")return`url(${u}${la(t)+a}${u})`;let c=t.split("/"),d=a.split("/");c.pop();for(let h of d)h!=="."&&(h===".."?c.pop():c.push(h));return`url(${u}${c.join("/")}${u})`})}function Ir(e){return e.replace(/(\/\*[^*]*\*\/)|[\s;]/g,"")}function ha(e,t){let r=Array.from(t.childNodes),n=[];if(r.length>1&&e&&typeof e=="string"){let o=Ir(e);for(let i=1;i<r.length;i++)if(r[i].textContent&&typeof r[i].textContent=="string"){let s=Ir(r[i].textContent);for(let l=3;l<s.length;l++){let a=s.substring(0,l);if(o.split(a).length===2){let u=o.indexOf(a);for(let c=u;c<e.length;c++)if(Ir(e.substring(0,c)).length===u){n.push(e.substring(0,c)),e=e.substring(c);break}break}}}}return n.push(e),n}function pa(e,t){return ha(e,t).join("/* rr_split */")}var ma=1,ga=new RegExp("[^a-z0-9-_:]"),st=-2;function _o(){return ma++}function ya(e){if(e instanceof HTMLFormElement)return"form";let t=Oe(e.tagName);return ga.test(t)?"div":t}var Be,co,va=/^[^ \t\n\r\u000c]+/,Sa=/^[, \t\n\r\u000c]+/;function Ca(e,t){if(t.trim()==="")return t;let r=0;function n(i){let s,l=i.exec(t.substring(r));return l?(s=l[0],r+=s.length,s):""}let o=[];for(;n(Sa),!(r>=t.length);){let i=n(va);if(i.slice(-1)===",")i=Ve(e,i.substring(0,i.length-1)),o.push(i);else{let s="";i=Ve(e,i);let l=!1;for(;;){let a=t.charAt(r);if(a===""){o.push((i+s).trim());break}else if(l)a===")"&&(l=!1);else if(a===","){r+=1,o.push((i+s).trim());break}else a==="("&&(l=!0);s+=a,r+=1}}}return o.join(", ")}var uo=new WeakMap;function Ve(e,t){return!t||t.trim()===""?t:jr(e,t)}function ba(e){return!!(e.tagName==="svg"||e.ownerSVGElement)}function jr(e,t){let r=uo.get(e);if(r||(r=e.createElement("a"),uo.set(e,r)),!t)t="";else if(t.startsWith("blob:")||t.startsWith("data:"))return t;return r.setAttribute("href",t),r.href}function Mo(e,t,r,n){return n&&(r==="src"||r==="href"&&!(t==="use"&&n[0]==="#")||r==="xlink:href"&&n[0]!=="#"||r==="background"&&(t==="table"||t==="td"||t==="th")?Ve(e,n):r==="srcset"?Ca(e,n):r==="style"?Ft(n,jr(e)):t==="object"&&r==="data"?Ve(e,n):n)}function xo(e,t,r){return(e==="video"||e==="audio")&&t==="autoplay"}function wa(e,t,r,n){try{if(typeof t=="string"){if(e.classList.contains(t))return!0}else for(let o=e.classList.length;o--;){let i=e.classList[o];if(t.test(i))return!0}if(r)return e.matches(r);if(n&&e.tagName==="IMG"){let o=e.getAttribute("src");if(o&&n.test(o))return!0}}catch{}return!1}function zt(e,t,r){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return r?zt(ee.parentNode(e),t,r):!1;for(let n=e.classList.length;n--;){let o=e.classList[n];if(t.test(o))return!0}return r?zt(ee.parentNode(e),t,r):!1}function No(e,t,r,n){let o;if(Ao(e)){if(o=e,!ee.childNodes(o).length)return!1}else{if(ee.parentElement(e)===null)return!1;o=ee.parentElement(e)}try{if(typeof t=="string"){if(n){if(o.closest(`.${t}`))return!0}else if(o.classList.contains(t))return!0}else if(zt(o,t,n))return!0;if(r){if(n){if(o.closest(r))return!0}else if(o.matches(r))return!0}if(o.getAttribute("contenteditable")||o.closest('[contenteditable="true"]'))return!0}catch{}return!1}function Ea(e,t,r){let n=e.contentWindow;if(!n)return;let o=!1,i;try{i=n.document.readyState}catch{return}if(i!=="complete"){let l=setTimeout(()=>{o||(t(),o=!0)},r);e.addEventListener("load",()=>{clearTimeout(l),o=!0,t()});return}let s="about:blank";if(n.location.href!==s||e.src===s||e.src==="")return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}function Ra(e,t,r){let n=!1,o;try{o=e.sheet}catch{return}if(o)return;let i=setTimeout(()=>{n||(t(),n=!0)},r);e.addEventListener("load",()=>{clearTimeout(i),n=!0,t()})}function Ia(e,t){let{doc:r,mirror:n,blockClass:o,blockSelector:i,needsMask:s,inlineStylesheet:l,maskInputOptions:a={},maskTextFn:u,maskInputFn:c,maskAnchorHrefFn:d,blockImgSrcPattern:h,blockImgSrcFillOptions:p,dataURLOptions:m={},inlineImages:f,recordCanvas:v,keepIframeSrcFn:S,newlyAddedElement:y=!1,cssCaptured:g=!1}=t,T=Aa(r,n);switch(e.nodeType){case e.DOCUMENT_NODE:return e.compatMode!=="CSS1Compat"?{type:K.Document,childNodes:[],compatMode:e.compatMode}:{type:K.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:K.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:T};case e.ELEMENT_NODE:return ka(e,{doc:r,blockClass:o,blockSelector:i,inlineStylesheet:l,maskInputOptions:a,maskInputFn:c,maskAnchorHrefFn:d,blockImgSrcPattern:h,blockImgSrcFillOptions:p,dataURLOptions:m,inlineImages:f,recordCanvas:v,keepIframeSrcFn:S,newlyAddedElement:y,rootId:T});case e.TEXT_NODE:return Ta(e,{doc:r,needsMask:s,maskTextFn:u,rootId:T,cssCaptured:g});case e.CDATA_SECTION_NODE:return{type:K.CDATA,textContent:"",rootId:T};case e.COMMENT_NODE:return{type:K.Comment,textContent:ee.textContent(e)||"",rootId:T};default:return!1}}function Aa(e,t){if(!t.hasNode(e))return;let r=t.getId(e);return r===1?void 0:r}function Ta(e,t){let{needsMask:r,maskTextFn:n,rootId:o,cssCaptured:i}=t,s=ee.parentNode(e),l=s&&s.tagName,a="",u=l==="STYLE"?!0:void 0,c=l==="SCRIPT"?!0:void 0;return c?a="SCRIPT_PLACEHOLDER":i||(a=ee.textContent(e),u&&a&&(a=Ft(a,jr(t.doc)))),!u&&!c&&a&&r&&(a=n?n(a,ee.parentElement(e)):a.replace(/[\S]/g,"*")),{type:K.Text,textContent:a||"",rootId:o}}function ka(e,t){let{doc:r,blockClass:n,blockSelector:o,inlineStylesheet:i,maskInputOptions:s={},maskInputFn:l,maskAnchorHrefFn:a,blockImgSrcPattern:u,blockImgSrcFillOptions:c,dataURLOptions:d={},inlineImages:h,recordCanvas:p,keepIframeSrcFn:m,newlyAddedElement:f=!1,rootId:v}=t,S=wa(e,n,o,u),y=ya(e),g={},T=e.attributes.length;for(let C=0;C<T;C++){let R=e.attributes[C];xo(y,R.name,R.value)||(g[R.name]=Mo(r,y,Oe(R.name),R.value))}if(y==="a"&&a&&typeof g.href=="string"&&(g.href=a(g.href,e)),y==="link"&&i){let C=Array.from(r.styleSheets).find(E=>E.href===e.href);if(!C&&e.href.includes(".css")){let E=window.location.origin,L=e.href.replace(window.location.href,""),z=E+"/"+L;C=Array.from(r.styleSheets).find(X=>X.href===z)}let R=null;C&&(R=Mr(C)),R&&(delete g.rel,delete g.href,g._cssText=R)}if(y==="style"&&e.sheet){let C=Mr(e.sheet);C&&(e.childNodes.length>1&&(C=pa(C,e)),g._cssText=C)}if(y==="input"||y==="textarea"||y==="select"){let C=e.value,R=e.checked;g.type!=="radio"&&g.type!=="checkbox"&&g.type!=="submit"&&g.type!=="button"&&C?g.value=Ut({element:e,type:Vr(e),tagName:y,value:C,maskInputOptions:s,maskInputFn:l}):R&&(g.checked=R)}if(y==="option"&&(e.selected&&!s.select?g.selected=!0:delete g.selected),y==="dialog"&&e.open&&(g.rr_open_mode=e.matches("dialog:modal")?"modal":"non-modal"),y==="canvas"&&p){if(e.__context==="2d")aa(e)||(g.rr_dataURL=e.toDataURL(d.type,d.quality));else if(!("__context"in e)){let C=e.toDataURL(d.type,d.quality),R=r.createElement("canvas");R.width=e.width,R.height=e.height;let E=R.toDataURL(d.type,d.quality);C!==E&&(g.rr_dataURL=C)}}if(y==="img"&&h){Be||(Be=r.createElement("canvas"),co=Be.getContext("2d"));let C=e,R=C.currentSrc||C.getAttribute("src")||"<unknown-src>",E=C.crossOrigin,L=()=>{C.removeEventListener("load",L);try{Be.width=C.naturalWidth,Be.height=C.naturalHeight,co.drawImage(C,0,0),g.rr_dataURL=Be.toDataURL(d.type,d.quality)}catch(z){if(C.crossOrigin!=="anonymous"){C.crossOrigin="anonymous",C.complete&&C.naturalWidth!==0?L():C.addEventListener("load",L);return}else console.warn(`Cannot inline img src=${R}! Error: ${z}`)}C.crossOrigin==="anonymous"&&(E?g.crossOrigin=E:C.removeAttribute("crossorigin"))};C.complete&&C.naturalWidth!==0?L():C.addEventListener("load",L)}if(y==="audio"||y==="video"){let C=g;C.rr_mediaState=e.paused?"paused":"played",C.rr_mediaCurrentTime=e.currentTime,C.rr_mediaPlaybackRate=e.playbackRate,C.rr_mediaMuted=e.muted,C.rr_mediaLoop=e.loop,C.rr_mediaVolume=e.volume}if(f||(e.scrollLeft&&(g.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(g.rr_scrollTop=e.scrollTop)),S){let{width:C,height:R}=e.getBoundingClientRect();g={class:g.class,rr_width:`${C}px`,rr_height:`${R}px`}}S&&y==="img"&&(g={...g,src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP89v3nfwAJuAPnyTr4jAAAAABJRU5ErkJggg==",rr_fill:c.backgroundColor,rr_stroke:c.strokeColor,rr_stroke_width:c.strokeWidth}),y==="iframe"&&!m(g.src)&&(e.contentDocument||(g.rr_src=g.src),delete g.src);let I;try{customElements.get(y)&&(I=!0)}catch{}return{type:K.Element,tagName:y,attributes:g,childNodes:[],isSVG:ba(e)||void 0,needBlock:S,rootId:v,isCustom:I}}function V(e){return e==null?"":e.toLowerCase()}function _a(e,t){if(t.comment&&e.type===K.Comment)return!0;if(e.type===K.Element){if(t.script&&(e.tagName==="script"||e.tagName==="link"&&(e.attributes.rel==="preload"||e.attributes.rel==="modulepreload")&&e.attributes.as==="script"||e.tagName==="link"&&e.attributes.rel==="prefetch"&&typeof e.attributes.href=="string"&&ko(e.attributes.href)==="js"))return!0;if(t.headFavicon&&(e.tagName==="link"&&e.attributes.rel==="shortcut icon"||e.tagName==="meta"&&(V(e.attributes.name).match(/^msapplication-tile(image|color)$/)||V(e.attributes.name)==="application-name"||V(e.attributes.rel)==="icon"||V(e.attributes.rel)==="apple-touch-icon"||V(e.attributes.rel)==="shortcut icon")))return!0;if(e.tagName==="meta"){if(t.headMetaDescKeywords&&V(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(V(e.attributes.property).match(/^(og|twitter|fb):/)||V(e.attributes.name).match(/^(og|twitter):/)||V(e.attributes.name)==="pinterest"))return!0;if(t.headMetaRobots&&(V(e.attributes.name)==="robots"||V(e.attributes.name)==="googlebot"||V(e.attributes.name)==="bingbot"))return!0;if(t.headMetaHttpEquiv&&e.attributes["http-equiv"]!==void 0)return!0;if(t.headMetaAuthorship&&(V(e.attributes.name)==="author"||V(e.attributes.name)==="generator"||V(e.attributes.name)==="framework"||V(e.attributes.name)==="publisher"||V(e.attributes.name)==="progid"||V(e.attributes.property).match(/^article:/)||V(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&(V(e.attributes.name)==="google-site-verification"||V(e.attributes.name)==="yandex-verification"||V(e.attributes.name)==="csrf-token"||V(e.attributes.name)==="p:domain_verify"||V(e.attributes.name)==="verify-v1"||V(e.attributes.name)==="verification"||V(e.attributes.name)==="shopify-checkout-api-token"))return!0}}return!1}function je(e,t){if(e.nodeName.toLowerCase().includes("grammarly"))return null;let{doc:r,mirror:n,blockClass:o,blockSelector:i,maskTextClass:s,maskTextSelector:l,skipChild:a=!1,inlineStylesheet:u=!0,maskInputOptions:c={},maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,slimDOMOptions:v,dataURLOptions:S={},inlineImages:y=!1,recordCanvas:g=!1,onSerialize:T,onIframeLoad:I,iframeLoadTimeout:C=5e3,onStylesheetLoad:R,stylesheetLoadTimeout:E=5e3,keepIframeSrcFn:L=()=>!1,newlyAddedElement:z=!1,cssCaptured:X=!1}=t,{needsMask:U}=t,{preserveWhiteSpace:J=!0}=t;U||(U=No(e,s,l,U===void 0));let H=Ia(e,{doc:r,mirror:n,blockClass:o,blockSelector:i,needsMask:U,inlineStylesheet:u,maskInputOptions:c,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,dataURLOptions:S,inlineImages:y,recordCanvas:g,keepIframeSrcFn:L,newlyAddedElement:z,cssCaptured:X});if(!H)return console.warn(e,"not serialized"),null;let W;n.hasNode(e)?W=n.getId(e):_a(H,v)||!J&&H.type===K.Text&&!H.textContent.replace(/^\s+|\s+$/gm,"").length?W=st:W=_o();let A=Object.assign(H,{id:W});if(n.add(e,A),W===st)return null;T&&T(e);let _=!a;if(A.type===K.Element){_=_&&!A.needBlock,delete A.needBlock;let k=ee.shadowRoot(e);k&&ot(k)&&(A.isShadowHost=!0)}if((A.type===K.Document||A.type===K.Element)&&_){v.headWhitespace&&A.type===K.Element&&A.tagName==="head"&&(J=!1);let k={doc:r,mirror:n,blockClass:o,blockSelector:i,needsMask:U,maskTextClass:s,maskTextSelector:l,skipChild:a,inlineStylesheet:u,maskInputOptions:c,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,slimDOMOptions:v,dataURLOptions:S,inlineImages:y,recordCanvas:g,preserveWhiteSpace:J,onSerialize:T,onIframeLoad:I,iframeLoadTimeout:C,onStylesheetLoad:R,stylesheetLoadTimeout:E,keepIframeSrcFn:L,cssCaptured:!1};if(!(A.type===K.Element&&A.tagName==="textarea"&&A.attributes.value!==void 0)){A.type===K.Element&&A.attributes._cssText!==void 0&&typeof A.attributes._cssText=="string"&&(k.cssCaptured=!0);for(let G of Array.from(ee.childNodes(e))){let Z=je(G,k);Z&&A.childNodes.push(Z)}}let D=null;if(Ao(e)&&(D=ee.shadowRoot(e)))for(let G of Array.from(ee.childNodes(D))){let Z=je(G,k);Z&&(ot(D)&&(Z.isShadow=!0),A.childNodes.push(Z))}}let Y=ee.parentNode(e);return Y&&nt(Y)&&ot(Y)&&(A.isShadow=!0),A.type===K.Element&&A.tagName==="iframe"&&Ea(e,()=>{let k=e.contentDocument;if(k&&I){let D=je(k,{doc:k,mirror:n,blockClass:o,blockSelector:i,needsMask:U,maskTextClass:s,maskTextSelector:l,skipChild:!1,inlineStylesheet:u,maskInputOptions:c,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,slimDOMOptions:v,dataURLOptions:S,inlineImages:y,recordCanvas:g,preserveWhiteSpace:J,onSerialize:T,onIframeLoad:I,iframeLoadTimeout:C,onStylesheetLoad:R,stylesheetLoadTimeout:E,keepIframeSrcFn:L});D&&I(e,D)}},C),A.type===K.Element&&A.tagName==="link"&&typeof A.attributes.rel=="string"&&(A.attributes.rel==="stylesheet"||A.attributes.rel==="preload"&&typeof A.attributes.href=="string"&&ko(A.attributes.href)==="css")&&Ra(e,()=>{if(R){let k=je(e,{doc:r,mirror:n,blockClass:o,blockSelector:i,needsMask:U,maskTextClass:s,maskTextSelector:l,skipChild:!1,inlineStylesheet:u,maskInputOptions:c,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,slimDOMOptions:v,dataURLOptions:S,inlineImages:y,recordCanvas:g,preserveWhiteSpace:J,onSerialize:T,onIframeLoad:I,iframeLoadTimeout:C,onStylesheetLoad:R,stylesheetLoadTimeout:E,keepIframeSrcFn:L});k&&R(e,k)}},E),A}function Ma(e,t){let{mirror:r=new Pt,blockClass:n="rr-block",blockSelector:o=null,maskTextClass:i="rr-mask",maskTextSelector:s=null,inlineStylesheet:l=!0,inlineImages:a=!1,recordCanvas:u=!1,maskAllInputs:c=!1,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m=null,blockImgSrcFillOptions:f={backgroundColor:"#F6F7F9",strokeColor:"#E9EBEF",strokeWidth:"1px"},slimDOM:v=!1,dataURLOptions:S,preserveWhiteSpace:y,onSerialize:g,onIframeLoad:T,iframeLoadTimeout:I,onStylesheetLoad:C,stylesheetLoadTimeout:R,keepIframeSrcFn:E=()=>!1}=t||{};return je(e,{doc:e,mirror:r,blockClass:n,blockSelector:o,maskTextClass:i,maskTextSelector:s,skipChild:!1,inlineStylesheet:l,maskInputOptions:c===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:c===!1?{password:!0}:c,maskTextFn:d,maskInputFn:h,maskAnchorHrefFn:p,blockImgSrcPattern:m,blockImgSrcFillOptions:f,slimDOMOptions:v===!0||v==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:v==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:v===!1?{}:v,dataURLOptions:S,inlineImages:a,recordCanvas:u,preserveWhiteSpace:y,onSerialize:g,onIframeLoad:T,iframeLoadTimeout:I,onStylesheetLoad:C,stylesheetLoadTimeout:R,keepIframeSrcFn:E,newlyAddedElement:!1})}var xr=class e{constructor(...t){__publicField2(this,"parentElement",null),__publicField2(this,"parentNode",null),__publicField2(this,"ownerDocument"),__publicField2(this,"firstChild",null),__publicField2(this,"lastChild",null),__publicField2(this,"previousSibling",null),__publicField2(this,"nextSibling",null),__publicField2(this,"ELEMENT_NODE",1),__publicField2(this,"TEXT_NODE",3),__publicField2(this,"nodeType"),__publicField2(this,"nodeName"),__publicField2(this,"RRNodeType")}get childNodes(){let t=[],r=this.firstChild;for(;r;)t.push(r),r=r.nextSibling;return t}contains(t){if(t instanceof e){if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0}else return!1;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,r){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}},fo={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},ho={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},xt={};function qr(e){if(xt[e])return xt[e];let t=globalThis[e],r=t.prototype,n=e in fo?fo[e]:void 0,o=!!(n&&n.every(l=>{var a,u;return!!((u=(a=Object.getOwnPropertyDescriptor(r,l))==null?void 0:a.get)!=null&&u.toString().includes("[native code]"))})),i=e in ho?ho[e]:void 0,s=!!(i&&i.every(l=>{var a;return typeof r[l]=="function"&&((a=r[l])==null?void 0:a.toString().includes("[native code]"))}));if(o&&s)return xt[e]=t.prototype,t.prototype;try{let l=document.createElement("iframe");document.body.appendChild(l);let a=l.contentWindow;if(!a)return t.prototype;let u=a[e].prototype;return document.body.removeChild(l),u?xt[e]=u:r}catch{return r}}var Ar={};function Me(e,t,r){var n;let o=`${e}.${String(r)}`;if(Ar[o])return Ar[o].call(t);let i=qr(e),s=(n=Object.getOwnPropertyDescriptor(i,r))==null?void 0:n.get;return s?(Ar[o]=s,s.call(t)):t[r]}var Tr={};function Oo(e,t,r){let n=`${e}.${String(r)}`;if(Tr[n])return Tr[n].bind(t);let i=qr(e)[r];return typeof i!="function"?t[r]:(Tr[n]=i,i.bind(t))}function xa(e){return Me("Node",e,"childNodes")}function Na(e){return Me("Node",e,"parentNode")}function Oa(e){return Me("Node",e,"parentElement")}function La(e){return Me("Node",e,"textContent")}function Da(e,t){return Oo("Node",e,"contains")(t)}function Pa(e){return Oo("Node",e,"getRootNode")()}function Ua(e){return!e||!("host"in e)?null:Me("ShadowRoot",e,"host")}function Fa(e){return e.styleSheets}function za(e){return!e||!("shadowRoot"in e)?null:Me("Element",e,"shadowRoot")}function Wa(e,t){return Me("Element",e,"querySelector")(t)}function Ba(e,t){return Me("Element",e,"querySelectorAll")(t)}function Lo(){return qr("MutationObserver").constructor}var M={childNodes:xa,parentNode:Na,parentElement:Oa,textContent:La,contains:Da,getRootNode:Pa,host:Ua,styleSheets:Fa,shadowRoot:za,querySelector:Wa,querySelectorAll:Ba,mutationObserver:Lo};function ne(e,t,r=document){let n={capture:!0,passive:!0};return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}var He=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`,po={map:{},getId(){return console.error(He),-1},getNode(){return console.error(He),null},removeNodeFromMap(){console.error(He)},has(){return console.error(He),!1},reset(){console.error(He)}};typeof window<"u"&&window.Proxy&&window.Reflect&&(po=new Proxy(po,{get(e,t,r){return t==="map"&&console.error(He),Reflect.get(e,t,r)}}));function at(e,t,r={}){let n=null,o=0;return function(...i){let s=Date.now();!o&&r.leading===!1&&(o=s);let l=t-(s-o),a=this;l<=0||l>t?(n&&(clearTimeout(n),n=null),o=s,e.apply(a,i)):!n&&r.trailing!==!1&&(n=setTimeout(()=>{o=r.leading===!1?0:Date.now(),n=null,e.apply(a,i)},l))}}function Vt(e,t,r,n,o=window){let i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,n?r:{set(s){setTimeout(()=>{r.set.call(this,s)},0),i&&i.set&&i.set.call(this,s)}}),()=>Vt(e,t,i||{},!0)}function Ye(e,t,r){try{if(!(t in e))return()=>{};let n=e[t],o=r(n);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:n}})),e[t]=o,()=>{e[t]=n}}catch{return()=>{}}}var Wt=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Wt=()=>new Date().getTime());function Do(e){var t,r,n,o;let i=e.document;return{left:i.scrollingElement?i.scrollingElement.scrollLeft:e.pageXOffset!==void 0?e.pageXOffset:i.documentElement.scrollLeft||i?.body&&((t=M.parentElement(i.body))==null?void 0:t.scrollLeft)||((r=i?.body)==null?void 0:r.scrollLeft)||0,top:i.scrollingElement?i.scrollingElement.scrollTop:e.pageYOffset!==void 0?e.pageYOffset:i?.documentElement.scrollTop||i?.body&&((n=M.parentElement(i.body))==null?void 0:n.scrollTop)||((o=i?.body)==null?void 0:o.scrollTop)||0}}function Po(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Uo(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Fo(e){return e?e.nodeType===e.ELEMENT_NODE?e:M.parentElement(e):null}function oe(e,t,r,n){if(!e)return!1;let o=Fo(e);if(!o)return!1;try{if(typeof t=="string"){if(o.classList.contains(t)||n&&o.closest("."+t)!==null)return!0}else if(zt(o,t,n))return!0}catch{}return!!(r&&(o.matches(r)||n&&o.closest(r)!==null))}function Ha(e,t){return t.getId(e)!==-1}function kr(e,t,r){return e.tagName==="TITLE"&&r.headTitleMutations?!0:t.getId(e)===st}function zo(e,t){if(nt(e))return!1;let r=t.getId(e);if(!t.has(r))return!0;let n=M.parentNode(e);return n&&n.nodeType===e.DOCUMENT_NODE?!1:n?zo(n,t):!0}function Nr(e){return!!e.changedTouches}function Ga(e=window){"NodeList"in e&&!e.NodeList.prototype.forEach&&(e.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in e&&!e.DOMTokenList.prototype.forEach&&(e.DOMTokenList.prototype.forEach=Array.prototype.forEach)}function Wo(e,t){return!!(e.nodeName==="IFRAME"&&t.getMeta(e))}function Bo(e,t){return!!(e.nodeName==="LINK"&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&e.getAttribute("rel")==="stylesheet"&&t.getMeta(e))}function Or(e){return e?e instanceof xr&&"shadowRoot"in e?!!e.shadowRoot:!!M.shadowRoot(e):!1}var Lr=class{constructor(){b(this,"id",1),b(this,"styleIDMap",new WeakMap),b(this,"idStyleMap",new Map)}getId(t){return this.styleIDMap.get(t)??-1}has(t){return this.styleIDMap.has(t)}add(t,r){if(this.has(t))return this.getId(t);let n;return r===void 0?n=this.id++:n=r,this.styleIDMap.set(t,n),this.idStyleMap.set(n,t),n}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Ho(e){var t;let r=null;return"getRootNode"in e&&((t=M.getRootNode(e))==null?void 0:t.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&M.host(M.getRootNode(e))&&(r=M.host(M.getRootNode(e))),r}function Va(e){let t=e,r;for(;r=Ho(t);)t=r;return t}function ja(e){let t=e.ownerDocument;if(!t)return!1;let r=Va(e);return M.contains(t,r)}function Go(e){let t=e.ownerDocument;return t?M.contains(t,e)||ja(e):!1}var P=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(P||{}),x=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(x||{}),ae=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))(ae||{}),Se=(e=>(e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e))(Se||{}),$e=(e=>(e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e))($e||{}),Ge=(e=>(e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange",e[e.RateChange=4]="RateChange",e))(Ge||{});function mo(e){return"__ln"in e}var Dr=class{constructor(){b(this,"length",0),b(this,"head",null),b(this,"tail",null)}get(t){if(t>=this.length)throw new Error("Position outside of list range");let r=this.head;for(let n=0;n<t;n++)r=r?.next||null;return r}addNode(t){let r={value:t,previous:null,next:null};if(t.__ln=r,t.previousSibling&&mo(t.previousSibling)){let n=t.previousSibling.__ln.next;r.next=n,r.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=r,n&&(n.previous=r)}else if(t.nextSibling&&mo(t.nextSibling)&&t.nextSibling.__ln.previous){let n=t.nextSibling.__ln.previous;r.previous=n,r.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=r,n&&(n.next=r)}else this.head&&(this.head.previous=r),r.next=this.head,this.head=r;r.next===null&&(this.tail=r),this.length++}removeNode(t){let r=t.__ln;this.head&&(r.previous?(r.previous.next=r.next,r.next?r.next.previous=r.previous:this.tail=r.previous):(this.head=r.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}},go=(e,t)=>`${e}@${t}`,Pr=class{constructor(){b(this,"frozen",!1),b(this,"locked",!1),b(this,"texts",[]),b(this,"attributes",[]),b(this,"attributeMap",new WeakMap),b(this,"removes",[]),b(this,"mapRemoves",[]),b(this,"movedMap",{}),b(this,"addedSet",new Set),b(this,"movedSet",new Set),b(this,"droppedSet",new Set),b(this,"mutationCb"),b(this,"blockClass"),b(this,"blockSelector"),b(this,"maskTextClass"),b(this,"maskTextSelector"),b(this,"inlineStylesheet"),b(this,"maskInputOptions"),b(this,"maskTextFn"),b(this,"maskInputFn"),b(this,"maskAnchorHrefFn"),b(this,"blockImgSrcPattern"),b(this,"blockImgSrcFillOptions"),b(this,"keepIframeSrcFn"),b(this,"recordCanvas"),b(this,"inlineImages"),b(this,"slimDOMOptions"),b(this,"dataURLOptions"),b(this,"doc"),b(this,"mirror"),b(this,"iframeManager"),b(this,"stylesheetManager"),b(this,"shadowDomManager"),b(this,"canvasManager"),b(this,"processedNodeManager"),b(this,"unattachedDoc"),b(this,"processMutations",t=>{t.forEach(this.processMutation),this.emit()}),b(this,"emit",()=>{if(this.frozen||this.locked)return;let t=[],r=new Set,n=new Dr,o=a=>{let u=a,c=st;for(;c===st;)u=u&&u.nextSibling,c=u&&this.mirror.getId(u);return c},i=a=>{let u=M.parentNode(a);if(!u||!Go(a))return;let c=!1;if(a.nodeType===Node.TEXT_NODE){let m=u.tagName;if(m==="TEXTAREA")return;m==="STYLE"&&this.addedSet.has(u)&&(c=!0)}let d=nt(u)?this.mirror.getId(Ho(a)):this.mirror.getId(u),h=o(a);if(d===-1||h===-1)return n.addNode(a);let p=je(a,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,maskAnchorHrefFn:this.maskAnchorHrefFn,blockImgSrcPattern:this.blockImgSrcPattern,blockImgSrcFillOptions:this.blockImgSrcFillOptions,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:m=>{Wo(m,this.mirror)&&this.iframeManager.addIframe(m),Bo(m,this.mirror)&&this.stylesheetManager.trackLinkElement(m),Or(a)&&this.shadowDomManager.addShadowRoot(M.shadowRoot(a),this.doc)},onIframeLoad:(m,f)=>{this.iframeManager.attachIframe(m,f),this.shadowDomManager.observeAttachShadow(m)},onStylesheetLoad:(m,f)=>{this.stylesheetManager.attachLinkElement(m,f)},cssCaptured:c});p&&(t.push({parentId:d,nextId:h,node:p}),r.add(p.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(let a of this.movedSet)yo(this.removes,a,this.mirror)&&!this.movedSet.has(M.parentNode(a))||i(a);for(let a of this.addedSet)!vo(this.droppedSet,a)&&!yo(this.removes,a,this.mirror)||vo(this.movedSet,a)?i(a):this.droppedSet.add(a);let s=null;for(;n.length;){let a=null;if(s){let u=this.mirror.getId(M.parentNode(s.value)),c=o(s.value);u!==-1&&c!==-1&&(a=s)}if(!a){let u=n.tail;for(;u;){let c=u;if(u=u.previous,c){let d=this.mirror.getId(M.parentNode(c.value));if(o(c.value)===-1)continue;if(d!==-1){a=c;break}else{let p=c.value,m=M.parentNode(p);if(m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE){let f=M.host(m);if(this.mirror.getId(f)!==-1){a=c;break}}}}}}if(!a){for(;n.head;)n.removeNode(n.head.value);break}s=a.previous,n.removeNode(a.value),i(a.value)}let l={texts:this.texts.map(a=>{let u=a.node,c=M.parentNode(u);return c&&c.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(c),{id:this.mirror.getId(u),value:a.value}}).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),attributes:this.attributes.map(a=>{let{attributes:u}=a;if(typeof u.style=="string"){let c=JSON.stringify(a.styleDiff),d=JSON.stringify(a._unchangedStyles);c.length<u.style.length&&(c+d).split("var(").length===u.style.split("var(").length&&(u.style=a.styleDiff)}return{id:this.mirror.getId(a.node),attributes:u}}).filter(a=>!r.has(a.id)).filter(a=>this.mirror.has(a.id)),removes:this.removes,adds:t};!l.texts.length&&!l.attributes.length&&!l.removes.length&&!l.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))}),b(this,"genTextAreaValueMutation",t=>{let r=this.attributeMap.get(t);r||(r={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(r),this.attributeMap.set(t,r));let n=r.attributes.value=Array.from(M.childNodes(t),o=>M.textContent(o)||"").join("");r.attributes.value=Ut({element:t,maskInputOptions:this.maskInputOptions,tagName:t.tagName,type:null,value:n,maskInputFn:this.maskInputFn})}),b(this,"processMutation",t=>{if(!kr(t.target,this.mirror,this.slimDOMOptions))switch(t.type){case"characterData":{let r=M.textContent(t.target);!oe(t.target,this.blockClass,this.blockSelector,!1)&&r!==t.oldValue&&this.texts.push({value:No(t.target,this.maskTextClass,this.maskTextSelector,!0)&&r?this.maskTextFn?this.maskTextFn(r,Fo(t.target)):r.replace(/[\S]/g,"*"):r,node:t.target});break}case"attributes":{let r=t.target,n=t.attributeName,o=t.target.getAttribute(n);if(n==="value"){let l=Vr(r);o=Ut({element:r,maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:l,value:o,maskInputFn:this.maskInputFn})}let i=oe(t.target,this.blockClass,this.blockSelector,!1);if(i&&n==="style"){let l=t.target,{width:a,height:u}=l.getBoundingClientRect(),c=this.attributeMap.get(t.target);c||(c={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(c),this.attributeMap.set(t.target,c)),c.attributes.rr_width=`${a}px`,c.attributes.rr_height=`${u}px`}if(i||o===t.oldValue)return;let s=this.attributeMap.get(t.target);if(r.tagName==="IFRAME"&&n==="src"&&!this.keepIframeSrcFn(o))if(!r.contentDocument)n="rr_src";else return;if(s||(s={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(t.target,s)),n==="type"&&r.tagName==="INPUT"&&(t.oldValue||"").toLowerCase()==="password"&&r.setAttribute("data-rr-is-password","true"),!xo(r.tagName,n))if(s.attributes[n]=Mo(this.doc,Oe(r.tagName),Oe(n),o),n==="style"){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}let l=this.unattachedDoc.createElement("span");t.oldValue&&l.setAttribute("style",t.oldValue);for(let a of Array.from(r.style)){let u=r.style.getPropertyValue(a),c=r.style.getPropertyPriority(a);u!==l.style.getPropertyValue(a)||c!==l.style.getPropertyPriority(a)?c===""?s.styleDiff[a]=u:s.styleDiff[a]=[u,c]:s._unchangedStyles[a]=[u,c]}for(let a of Array.from(l.style))r.style.getPropertyValue(a)===""&&(s.styleDiff[a]=!1)}else n==="open"&&r.tagName==="DIALOG"&&(r.matches("dialog:modal")?s.attributes.rr_open_mode="modal":s.attributes.rr_open_mode="non-modal");break}case"childList":{if(oe(t.target,this.blockClass,this.blockSelector,!0))return;if(t.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(t.target);return}t.addedNodes.forEach(r=>this.genAdds(r,t.target)),t.removedNodes.forEach(r=>{let n=this.mirror.getId(r),o=nt(t.target)?this.mirror.getId(M.host(t.target)):this.mirror.getId(t.target);oe(t.target,this.blockClass,this.blockSelector,!1)||kr(r,this.mirror,this.slimDOMOptions)||!Ha(r,this.mirror)||(this.addedSet.has(r)?(Ur(this.addedSet,r),this.droppedSet.add(r)):this.addedSet.has(t.target)&&n===-1||zo(t.target,this.mirror)||(this.movedSet.has(r)&&this.movedMap[go(n,o)]?Ur(this.movedSet,r):this.removes.push({parentId:o,id:n,isShadow:nt(t.target)&&ot(t.target)?!0:void 0})),this.mapRemoves.push(r))});break}}}),b(this,"genAdds",(t,r)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!(this.addedSet.has(t)||this.movedSet.has(t))){if(this.mirror.hasNode(t)){if(kr(t,this.mirror,this.slimDOMOptions))return;this.movedSet.add(t);let n=null;r&&this.mirror.hasNode(r)&&(n=this.mirror.getId(r)),n&&n!==-1&&(this.movedMap[go(this.mirror.getId(t),n)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);oe(t,this.blockClass,this.blockSelector,!1)||(M.childNodes(t).forEach(n=>this.genAdds(n)),Or(t)&&M.childNodes(M.shadowRoot(t)).forEach(n=>{this.processedNodeManager.add(n,this),this.genAdds(n,t)}))}})}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","maskAnchorHrefFn","blockImgSrcPattern","blockImgSrcFillOptions","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(r=>{this[r]=t[r]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}};function Ur(e,t){e.delete(t),M.childNodes(t).forEach(r=>Ur(e,r))}function yo(e,t,r){return e.length===0?!1:qa(e,t,r)}function qa(e,t,r){let n=M.parentNode(t);for(;n;){let o=r.getId(n);if(e.some(i=>i.id===o))return!0;n=M.parentNode(n)}return!1}function vo(e,t){return e.size===0?!1:Vo(e,t)}function Vo(e,t){let r=M.parentNode(t);return r?e.has(r)?!0:Vo(e,r):!1}var it;function $a(e){it=e}function Ya(){it=void 0}var O=e=>it?(...r)=>{try{return e(...r)}catch(n){if(it&&it(n)===!0)return;throw n}}:e,Ne=[];function lt(e){try{if("composedPath"in e){let t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch{}return e&&e.target}function jo(e,t){let r=new Pr;Ne.push(r),r.init(e);let n=new(Lo())(O(r.processMutations.bind(r)));return n.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),n}function Za({mousemoveCb:e,sampling:t,doc:r,mirror:n}){if(t.mousemove===!1)return()=>{};let o=typeof t.mousemove=="number"?t.mousemove:50,i=typeof t.mousemoveCallback=="number"?t.mousemoveCallback:500,s=[],l,a=at(O(d=>{let h=Date.now()-l;e(s.map(p=>(p.timeOffset-=h,p)),d),s=[],l=null}),i),u=O(at(O(d=>{let h=lt(d),{clientX:p,clientY:m}=Nr(d)?d.changedTouches[0]:d;l||(l=Wt()),s.push({x:p,y:m,id:n.getId(h),timeOffset:Wt()-l}),a(typeof DragEvent<"u"&&d instanceof DragEvent?x.Drag:d instanceof MouseEvent?x.MouseMove:x.TouchMove)}),o,{trailing:!1})),c=[ne("mousemove",u,r),ne("touchmove",u,r),ne("drag",u,r)];return O(()=>{c.forEach(d=>d())})}function Ka({mouseInteractionCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,sampling:i}){if(i.mouseInteraction===!1)return()=>{};let s=i.mouseInteraction===!0||i.mouseInteraction===void 0?{}:i.mouseInteraction,l=[],a=null,u=c=>d=>{let h=lt(d);if(oe(h,n,o,!0))return;let p=null,m=c;if("pointerType"in d){switch(d.pointerType){case"mouse":p=Se.Mouse;break;case"touch":p=Se.Touch;break;case"pen":p=Se.Pen;break}p===Se.Touch?ae[c]===ae.MouseDown?m="TouchStart":ae[c]===ae.MouseUp&&(m="TouchEnd"):Se.Pen}else Nr(d)&&(p=Se.Touch);p!==null?(a=p,(m.startsWith("Touch")&&p===Se.Touch||m.startsWith("Mouse")&&p===Se.Mouse)&&(p=null)):ae[c]===ae.Click&&(p=a,a=null);let f=Nr(d)?d.changedTouches[0]:d;if(!f)return;let v=r.getId(h),{clientX:S,clientY:y}=f;O(e)({type:ae[m],id:v,x:S,y,...p!==null&&{pointerType:p}})};return Object.keys(ae).filter(c=>Number.isNaN(Number(c))&&!c.endsWith("_Departed")&&s[c]!==!1).forEach(c=>{let d=Oe(c),h=u(c);if(window.PointerEvent)switch(ae[c]){case ae.MouseDown:case ae.MouseUp:d=d.replace("mouse","pointer");break;case ae.TouchStart:case ae.TouchEnd:return}l.push(ne(d,h,t))}),O(()=>{l.forEach(c=>c())})}function qo({scrollCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,sampling:i}){let s=O(at(O(l=>{let a=lt(l);if(!a||oe(a,n,o,!0))return;let u=r.getId(a);if(a===t&&t.defaultView){let c=Do(t.defaultView);e({id:u,x:c.left,y:c.top})}else e({id:u,x:a.scrollLeft,y:a.scrollTop})}),i.scroll||100));return ne("scroll",s,t)}function Xa({viewportResizeCb:e},{win:t}){let r=-1,n=-1,o=O(at(O(()=>{let i=Po(),s=Uo();(r!==i||n!==s)&&(e({width:Number(s),height:Number(i)}),r=i,n=s)}),200));return ne("resize",o,t)}var Ja=["INPUT","TEXTAREA","SELECT"],So=new WeakMap;function Qa({inputCb:e,doc:t,mirror:r,blockClass:n,blockSelector:o,ignoreClass:i,ignoreSelector:s,maskInputOptions:l,maskInputFn:a,sampling:u,userTriggeredOnInput:c}){function d(y){let g=lt(y),T=y.isTrusted,I=g&&g.tagName;if(g&&I==="OPTION"&&(g=M.parentElement(g)),!g||!I||Ja.indexOf(I)<0||oe(g,n,o,!0)||g.classList.contains(i)||s&&g.matches(s))return;let C=g.value,R=!1,E=Vr(g)||"";E==="radio"||E==="checkbox"?R=g.checked:(l[I.toLowerCase()]||l[E])&&(C=Ut({element:g,maskInputOptions:l,tagName:I,type:E,value:C,maskInputFn:a})),h(g,c?{text:C,isChecked:R,userTriggered:T}:{text:C,isChecked:R});let L=g.name;E==="radio"&&L&&R&&t.querySelectorAll(`input[type="radio"][name="${el(L)}"]`).forEach(z=>{if(z!==g){let X=z.value;h(z,c?{text:X,isChecked:!R,userTriggered:!1}:{text:X,isChecked:!R})}})}function h(y,g){let T=So.get(y);if(!T||T.text!==g.text||T.isChecked!==g.isChecked){So.set(y,g);let I=r.getId(y);O(e)({...g,id:I})}}let m=(u.input==="last"?["change"]:["input","change"]).map(y=>ne(y,O(d),t)),f=t.defaultView;if(!f)return()=>{m.forEach(y=>y())};let v=f.Object.getOwnPropertyDescriptor(f.HTMLInputElement.prototype,"value"),S=[[f.HTMLInputElement.prototype,"value"],[f.HTMLInputElement.prototype,"checked"],[f.HTMLSelectElement.prototype,"value"],[f.HTMLTextAreaElement.prototype,"value"],[f.HTMLSelectElement.prototype,"selectedIndex"],[f.HTMLOptionElement.prototype,"selected"]];return v&&v.set&&m.push(...S.map(y=>Vt(y[0],y[1],{set(){O(d)({target:this,isTrusted:!1})}},!1,f))),O(()=>{m.forEach(y=>y())})}function Bt(e){let t=[];function r(n,o){if(Nt("CSSGroupingRule")&&n.parentRule instanceof CSSGroupingRule||Nt("CSSMediaRule")&&n.parentRule instanceof CSSMediaRule||Nt("CSSSupportsRule")&&n.parentRule instanceof CSSSupportsRule||Nt("CSSConditionRule")&&n.parentRule instanceof CSSConditionRule){let s=Array.from(n.parentRule.cssRules).indexOf(n);o.unshift(s)}else if(n.parentStyleSheet){let s=Array.from(n.parentStyleSheet.cssRules).indexOf(n);o.unshift(s)}return o}return r(e,t)}function el(e){return e.replace(/["\\]/g,"\\$&")}function ke(e,t,r){let n,o;return e?(e.ownerNode?n=t.getId(e.ownerNode):o=r.getId(e),{styleId:o,id:n}):{}}function tl({styleSheetRuleCb:e,mirror:t,stylesheetManager:r},{win:n}){if(!n.CSSStyleSheet||!n.CSSStyleSheet.prototype)return()=>{};let o=n.CSSStyleSheet.prototype.insertRule;n.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:O((c,d,h)=>{let[p,m]=h,{id:f,styleId:v}=ke(d,t,r.styleMirror);return(f&&f!==-1||v&&v!==-1)&&e({id:f,styleId:v,adds:[{rule:p,index:m}]}),c.apply(d,h)})}),n.CSSStyleSheet.prototype.addRule=function(c,d,h=this.cssRules.length){let p=`${c} { ${d} }`;return n.CSSStyleSheet.prototype.insertRule.apply(this,[p,h])};let i=n.CSSStyleSheet.prototype.deleteRule;n.CSSStyleSheet.prototype.deleteRule=new Proxy(i,{apply:O((c,d,h)=>{let[p]=h,{id:m,styleId:f}=ke(d,t,r.styleMirror);return(m&&m!==-1||f&&f!==-1)&&e({id:m,styleId:f,removes:[{index:p}]}),c.apply(d,h)})}),n.CSSStyleSheet.prototype.removeRule=function(c){return n.CSSStyleSheet.prototype.deleteRule.apply(this,[c])};let s;n.CSSStyleSheet.prototype.replace&&(s=n.CSSStyleSheet.prototype.replace,n.CSSStyleSheet.prototype.replace=new Proxy(s,{apply:O((c,d,h)=>{let[p]=h,{id:m,styleId:f}=ke(d,t,r.styleMirror);return(m&&m!==-1||f&&f!==-1)&&e({id:m,styleId:f,replace:p}),c.apply(d,h)})}));let l;n.CSSStyleSheet.prototype.replaceSync&&(l=n.CSSStyleSheet.prototype.replaceSync,n.CSSStyleSheet.prototype.replaceSync=new Proxy(l,{apply:O((c,d,h)=>{let[p]=h,{id:m,styleId:f}=ke(d,t,r.styleMirror);return(m&&m!==-1||f&&f!==-1)&&e({id:m,styleId:f,replaceSync:p}),c.apply(d,h)})}));let a={};Ot("CSSGroupingRule")?a.CSSGroupingRule=n.CSSGroupingRule:(Ot("CSSMediaRule")&&(a.CSSMediaRule=n.CSSMediaRule),Ot("CSSConditionRule")&&(a.CSSConditionRule=n.CSSConditionRule),Ot("CSSSupportsRule")&&(a.CSSSupportsRule=n.CSSSupportsRule));let u={};return Object.entries(a).forEach(([c,d])=>{u[c]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(u[c].insertRule,{apply:O((h,p,m)=>{let[f,v]=m,{id:S,styleId:y}=ke(p.parentStyleSheet,t,r.styleMirror);return(S&&S!==-1||y&&y!==-1)&&e({id:S,styleId:y,adds:[{rule:f,index:[...Bt(p),v||0]}]}),h.apply(p,m)})}),d.prototype.deleteRule=new Proxy(u[c].deleteRule,{apply:O((h,p,m)=>{let[f]=m,{id:v,styleId:S}=ke(p.parentStyleSheet,t,r.styleMirror);return(v&&v!==-1||S&&S!==-1)&&e({id:v,styleId:S,removes:[{index:[...Bt(p),f]}]}),h.apply(p,m)})})}),O(()=>{n.CSSStyleSheet.prototype.insertRule=o,n.CSSStyleSheet.prototype.deleteRule=i,s&&(n.CSSStyleSheet.prototype.replace=s),l&&(n.CSSStyleSheet.prototype.replaceSync=l),Object.entries(a).forEach(([c,d])=>{d.prototype.insertRule=u[c].insertRule,d.prototype.deleteRule=u[c].deleteRule})})}function $o({mirror:e,stylesheetManager:t},r){var n,o,i;let s=null;r.nodeName==="#document"?s=e.getId(r):s=e.getId(M.host(r));let l=r.nodeName==="#document"?(n=r.defaultView)==null?void 0:n.Document:(i=(o=r.ownerDocument)==null?void 0:o.defaultView)==null?void 0:i.ShadowRoot,a=l?.prototype?Object.getOwnPropertyDescriptor(l?.prototype,"adoptedStyleSheets"):void 0;return s===null||s===-1||!l||!a?()=>{}:(Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get(){var u;return(u=a.get)==null?void 0:u.call(this)},set(u){var c;let d=(c=a.set)==null?void 0:c.call(this,u);if(s!==null&&s!==-1)try{t.adoptStyleSheets(u,s)}catch{}return d}}),O(()=>{Object.defineProperty(r,"adoptedStyleSheets",{configurable:a.configurable,enumerable:a.enumerable,get:a.get,set:a.set})}))}function rl({styleDeclarationCb:e,mirror:t,ignoreCSSAttributes:r,stylesheetManager:n},{win:o}){let i=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(i,{apply:O((l,a,u)=>{var c;let[d,h,p]=u;if(r.has(d))return i.apply(a,[d,h,p]);let{id:m,styleId:f}=ke((c=a.parentRule)==null?void 0:c.parentStyleSheet,t,n.styleMirror);return(m&&m!==-1||f&&f!==-1)&&e({id:m,styleId:f,set:{property:d,value:h,priority:p},index:Bt(a.parentRule)}),l.apply(a,u)})});let s=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(s,{apply:O((l,a,u)=>{var c;let[d]=u;if(r.has(d))return s.apply(a,[d]);let{id:h,styleId:p}=ke((c=a.parentRule)==null?void 0:c.parentStyleSheet,t,n.styleMirror);return(h&&h!==-1||p&&p!==-1)&&e({id:h,styleId:p,remove:{property:d},index:Bt(a.parentRule)}),l.apply(a,u)})}),O(()=>{o.CSSStyleDeclaration.prototype.setProperty=i,o.CSSStyleDeclaration.prototype.removeProperty=s})}function nl({mediaInteractionCb:e,blockClass:t,blockSelector:r,mirror:n,sampling:o,doc:i}){let s=O(a=>at(O(u=>{let c=lt(u);if(!c||oe(c,t,r,!0))return;let{currentTime:d,volume:h,muted:p,playbackRate:m,loop:f}=c;e({type:a,id:n.getId(c),currentTime:d,volume:h,muted:p,playbackRate:m,loop:f})}),o.media||500)),l=[ne("play",s(Ge.Play),i),ne("pause",s(Ge.Pause),i),ne("seeked",s(Ge.Seeked),i),ne("volumechange",s(Ge.VolumeChange),i),ne("ratechange",s(Ge.RateChange),i)];return O(()=>{l.forEach(a=>a())})}function ol({fontCb:e,doc:t}){let r=t.defaultView;if(!r)return()=>{};let n=[],o=new WeakMap,i=r.FontFace;r.FontFace=function(a,u,c){let d=new i(a,u,c);return o.set(d,{family:a,buffer:typeof u!="string",descriptors:c,fontSource:typeof u=="string"?u:JSON.stringify(Array.from(new Uint8Array(u)))}),d};let s=Ye(t.fonts,"add",function(l){return function(a){return setTimeout(O(()=>{let u=o.get(a);u&&(e(u),o.delete(a))}),0),l.apply(this,[a])}});return n.push(()=>{r.FontFace=i}),n.push(s),O(()=>{n.forEach(l=>l())})}function il(e){let{doc:t,mirror:r,blockClass:n,blockSelector:o,selectionCb:i}=e,s=!0,l=O(()=>{let a=t.getSelection();if(!a||s&&a?.isCollapsed)return;s=a.isCollapsed||!1;let u=[],c=a.rangeCount||0;for(let d=0;d<c;d++){let h=a.getRangeAt(d),{startContainer:p,startOffset:m,endContainer:f,endOffset:v}=h;oe(p,n,o,!0)||oe(f,n,o,!0)||u.push({start:r.getId(p),startOffset:m,end:r.getId(f),endOffset:v})}i({ranges:u})});return l(),ne("selectionchange",l)}function sl({doc:e,customElementCb:t}){let r=e.defaultView;return!r||!r.customElements?()=>{}:Ye(r.customElements,"define",function(o){return function(i,s,l){try{t({define:{name:i}})}catch{console.warn(`Custom element callback failed for ${i}`)}return o.apply(this,[i,s,l])}})}function al(e,t){let{mutationCb:r,mousemoveCb:n,mouseInteractionCb:o,scrollCb:i,viewportResizeCb:s,inputCb:l,mediaInteractionCb:a,styleSheetRuleCb:u,styleDeclarationCb:c,canvasMutationCb:d,fontCb:h,selectionCb:p,customElementCb:m}=e;e.mutationCb=(...f)=>{t.mutation&&t.mutation(...f),r(...f)},e.mousemoveCb=(...f)=>{t.mousemove&&t.mousemove(...f),n(...f)},e.mouseInteractionCb=(...f)=>{t.mouseInteraction&&t.mouseInteraction(...f),o(...f)},e.scrollCb=(...f)=>{t.scroll&&t.scroll(...f),i(...f)},e.viewportResizeCb=(...f)=>{t.viewportResize&&t.viewportResize(...f),s(...f)},e.inputCb=(...f)=>{t.input&&t.input(...f),l(...f)},e.mediaInteractionCb=(...f)=>{t.mediaInteaction&&t.mediaInteaction(...f),a(...f)},e.styleSheetRuleCb=(...f)=>{t.styleSheetRule&&t.styleSheetRule(...f),u(...f)},e.styleDeclarationCb=(...f)=>{t.styleDeclaration&&t.styleDeclaration(...f),c(...f)},e.canvasMutationCb=(...f)=>{t.canvasMutation&&t.canvasMutation(...f),d(...f)},e.fontCb=(...f)=>{t.font&&t.font(...f),h(...f)},e.selectionCb=(...f)=>{t.selection&&t.selection(...f),p(...f)},e.customElementCb=(...f)=>{t.customElement&&t.customElement(...f),m(...f)}}function ll(e,t={}){let r=e.doc.defaultView;if(!r)return()=>{};al(e,t);let n;e.recordDOM&&(n=jo(e,e.doc));let o=Za(e),i=Ka(e),s=qo(e),l=Xa(e,{win:r}),a=Qa(e),u=nl(e),c=()=>{},d=()=>{},h=()=>{},p=()=>{};e.recordDOM&&(c=tl(e,{win:r}),d=$o(e,e.doc),h=rl(e,{win:r}),e.collectFonts&&(p=ol(e)));let m=il(e),f=sl(e),v=[];for(let S of e.plugins)v.push(S.observer(S.callback,r,S.options));return O(()=>{Ne.forEach(S=>S.reset()),n?.disconnect(),o(),i(),s(),l(),a(),u(),c(),d(),h(),p(),m(),f(),v.forEach(S=>S())})}function Nt(e){return typeof window[e]<"u"}function Ot(e){return!!(typeof window[e]<"u"&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}var Ht=class{constructor(t){b(this,"iframeIdToRemoteIdMap",new WeakMap),b(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=t}getId(t,r,n,o){let i=n||this.getIdToRemoteIdMap(t),s=o||this.getRemoteIdToIdMap(t),l=i.get(r);return l||(l=this.generateIdFn(),i.set(r,l),s.set(l,r)),l}getIds(t,r){let n=this.getIdToRemoteIdMap(t),o=this.getRemoteIdToIdMap(t);return r.map(i=>this.getId(t,i,n,o))}getRemoteId(t,r,n){let o=n||this.getRemoteIdToIdMap(t);if(typeof r!="number")return r;let i=o.get(r);return i||-1}getRemoteIds(t,r){let n=this.getRemoteIdToIdMap(t);return r.map(o=>this.getRemoteId(t,o,n))}reset(t){if(!t){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){let r=this.iframeIdToRemoteIdMap.get(t);return r||(r=new Map,this.iframeIdToRemoteIdMap.set(t,r)),r}getRemoteIdToIdMap(t){let r=this.iframeRemoteIdToIdMap.get(t);return r||(r=new Map,this.iframeRemoteIdToIdMap.set(t,r)),r}},Fr=class{constructor(t){b(this,"iframes",new WeakMap),b(this,"crossOriginIframeMap",new WeakMap),b(this,"crossOriginIframeMirror",new Ht(_o)),b(this,"crossOriginIframeStyleMirror"),b(this,"crossOriginIframeRootIdMap",new WeakMap),b(this,"mirror"),b(this,"mutationCb"),b(this,"wrappedEmit"),b(this,"loadListener"),b(this,"stylesheetManager"),b(this,"recordCrossOriginIframes"),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ht(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,r){var n,o;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:r}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&((n=t.contentWindow)==null||n.addEventListener("message",this.handleMessage.bind(this))),(o=this.loadListener)==null||o.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){let r=t;if(r.data.type!=="rrweb"||r.origin!==r.data.origin||!t.source)return;let o=this.crossOriginIframeMap.get(t.source);if(!o)return;let i=this.transformCrossOriginEvent(o,r.data.event);i&&this.wrappedEmit(i,r.data.isCheckout)}transformCrossOriginEvent(t,r){var n;switch(r.type){case P.FullSnapshot:{this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(r.data.node,t);let o=r.data.node.id;return this.crossOriginIframeRootIdMap.set(t,o),this.patchRootIdOnNode(r.data.node,o),{timestamp:r.timestamp,type:P.IncrementalSnapshot,data:{source:x.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:r.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case P.Meta:case P.Load:case P.DomContentLoaded:return!1;case P.Plugin:return r;case P.Custom:return this.replaceIds(r.data.payload,t,["id","parentId","previousId","nextId"]),r;case P.IncrementalSnapshot:switch(r.data.source){case x.Mutation:return r.data.adds.forEach(o=>{this.replaceIds(o,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(o.node,t);let i=this.crossOriginIframeRootIdMap.get(t);i&&this.patchRootIdOnNode(o.node,i)}),r.data.removes.forEach(o=>{this.replaceIds(o,t,["parentId","id"])}),r.data.attributes.forEach(o=>{this.replaceIds(o,t,["id"])}),r.data.texts.forEach(o=>{this.replaceIds(o,t,["id"])}),r;case x.Drag:case x.TouchMove:case x.MouseMove:return r.data.positions.forEach(o=>{this.replaceIds(o,t,["id"])}),r;case x.ViewportResize:return!1;case x.MediaInteraction:case x.MouseInteraction:case x.Scroll:case x.CanvasMutation:case x.Input:return this.replaceIds(r.data,t,["id"]),r;case x.StyleSheetRule:case x.StyleDeclaration:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleId"]),r;case x.Font:return r;case x.Selection:return r.data.ranges.forEach(o=>{this.replaceIds(o,t,["start","end"])}),r;case x.AdoptedStyleSheet:return this.replaceIds(r.data,t,["id"]),this.replaceStyleIds(r.data,t,["styleIds"]),(n=r.data.styles)==null||n.forEach(o=>{this.replaceStyleIds(o,t,["styleId"])}),r}}return!1}replace(t,r,n,o){for(let i of o)!Array.isArray(r[i])&&typeof r[i]!="number"||(Array.isArray(r[i])?r[i]=t.getIds(n,r[i]):r[i]=t.getId(n,r[i]));return r}replaceIds(t,r,n){return this.replace(this.crossOriginIframeMirror,t,r,n)}replaceStyleIds(t,r,n){return this.replace(this.crossOriginIframeStyleMirror,t,r,n)}replaceIdOnNode(t,r){this.replaceIds(t,r,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach(n=>{this.replaceIdOnNode(n,r)})}patchRootIdOnNode(t,r){t.type!==K.Document&&!t.rootId&&(t.rootId=r),"childNodes"in t&&t.childNodes.forEach(n=>{this.patchRootIdOnNode(n,r)})}},zr=class{constructor(t){b(this,"shadowDoms",new WeakSet),b(this,"mutationCb"),b(this,"scrollCb"),b(this,"bypassOptions"),b(this,"mirror"),b(this,"restoreHandlers",[]),this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,r){if(!ot(t)||this.shadowDoms.has(t))return;this.shadowDoms.add(t);let n=jo({...this.bypassOptions,doc:r,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this},t);this.restoreHandlers.push(()=>n.disconnect()),this.restoreHandlers.push(qo({...this.bypassOptions,scrollCb:this.scrollCb,doc:t,mirror:this.mirror})),setTimeout(()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(M.host(t))),this.restoreHandlers.push($o({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))},0)}observeAttachShadow(t){!t.contentWindow||!t.contentDocument||this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,r){let n=this;this.restoreHandlers.push(Ye(t.prototype,"attachShadow",function(o){return function(i){let s=o.call(this,i),l=M.shadowRoot(this);return l&&Go(this)&&n.addShadowRoot(l,r),s}}))}reset(){this.restoreHandlers.forEach(t=>{try{t()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}},qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",cl=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(rt=0;rt<qe.length;rt++)cl[qe.charCodeAt(rt)]=rt;var rt,ul=function(e){var t=new Uint8Array(e),r,n=t.length,o="";for(r=0;r<n;r+=3)o+=qe[t[r]>>2],o+=qe[(t[r]&3)<<4|t[r+1]>>4],o+=qe[(t[r+1]&15)<<2|t[r+2]>>6],o+=qe[t[r+2]&63];return n%3===2?o=o.substring(0,o.length-1)+"=":n%3===1&&(o=o.substring(0,o.length-2)+"=="),o},Co=new Map;function dl(e,t){let r=Co.get(e);return r||(r=new Map,Co.set(e,r)),r.has(t)||r.set(t,[]),r.get(t)}var Yo=(e,t,r)=>{if(!e||!(Ko(e,t)||typeof e=="object"))return;let n=e.constructor.name,o=dl(r,n),i=o.indexOf(e);return i===-1&&(i=o.length,o.push(e)),i};function Lt(e,t,r){if(e instanceof Array)return e.map(n=>Lt(n,t,r));if(e===null)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){let n=e.constructor.name,o=ul(e);return{rr_type:n,base64:o}}else{if(e instanceof DataView)return{rr_type:e.constructor.name,args:[Lt(e.buffer,t,r),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement){let n=e.constructor.name,{src:o}=e;return{rr_type:n,src:o}}else if(e instanceof HTMLCanvasElement){let n="HTMLImageElement",o=e.toDataURL();return{rr_type:n,src:o}}else{if(e instanceof ImageData)return{rr_type:e.constructor.name,args:[Lt(e.data,t,r),e.width,e.height]};if(Ko(e,t)||typeof e=="object"){let n=e.constructor.name,o=Yo(e,t,r);return{rr_type:n,index:o}}}}return e}var Zo=(e,t,r)=>e.map(n=>Lt(n,t,r)),Ko=(e,t)=>!!["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(o=>typeof t[o]=="function").find(o=>e instanceof t[o]);function fl(e,t,r,n){let o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype);for(let s of i)try{if(typeof t.CanvasRenderingContext2D.prototype[s]!="function")continue;let l=Ye(t.CanvasRenderingContext2D.prototype,s,function(a){return function(...u){return oe(this.canvas,r,n,!0)||setTimeout(()=>{let c=Zo(u,t,this);e(this.canvas,{type:$e["2D"],property:s,args:c})},0),a.apply(this,u)}});o.push(l)}catch{let l=Vt(t.CanvasRenderingContext2D.prototype,s,{set(a){e(this.canvas,{type:$e["2D"],property:s,args:[a],setter:!0})}});o.push(l)}return()=>{o.forEach(s=>s())}}function hl(e){return e==="experimental-webgl"?"webgl":e}function bo(e,t,r,n){let o=[];try{let i=Ye(e.HTMLCanvasElement.prototype,"getContext",function(s){return function(l,...a){if(!oe(this,t,r,!0)){let u=hl(l);if("__context"in this||(this.__context=u),n&&["webgl","webgl2"].includes(u))if(a[0]&&typeof a[0]=="object"){let c=a[0];c.preserveDrawingBuffer||(c.preserveDrawingBuffer=!0)}else a.splice(0,1,{preserveDrawingBuffer:!0})}return s.apply(this,[l,...a])}});o.push(i)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(i=>i())}}function wo(e,t,r,n,o,i){let s=[],l=Object.getOwnPropertyNames(e);for(let a of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(a))try{if(typeof e[a]!="function")continue;let u=Ye(e,a,function(c){return function(...d){let h=c.apply(this,d);if(Yo(h,i,this),"tagName"in this.canvas&&!oe(this.canvas,n,o,!0)){let p=Zo(d,i,this),m={type:t,property:a,args:p};r(this.canvas,m)}return h}});s.push(u)}catch{let u=Vt(e,a,{set(c){r(this.canvas,{type:t,property:a,args:[c],setter:!0})}});s.push(u)}return s}function pl(e,t,r,n){let o=[];return o.push(...wo(t.WebGLRenderingContext.prototype,$e.WebGL,e,r,n,t)),typeof t.WebGL2RenderingContext<"u"&&o.push(...wo(t.WebGL2RenderingContext.prototype,$e.WebGL2,e,r,n,t)),()=>{o.forEach(i=>i())}}var Xo="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",ml=e=>Uint8Array.from(atob(e),t=>t.charCodeAt(0)),Eo=typeof window<"u"&&window.Blob&&new Blob([ml(Xo)],{type:"text/javascript;charset=utf-8"});function gl(e){let t;try{if(t=Eo&&(window.URL||window.webkitURL).createObjectURL(Eo),!t)throw"";let r=new Worker(t,{name:e?.name});return r.addEventListener("error",()=>{(window.URL||window.webkitURL).revokeObjectURL(t)}),r}catch{return new Worker("data:text/javascript;base64,"+Xo,{name:e?.name})}finally{t&&(window.URL||window.webkitURL).revokeObjectURL(t)}}var Wr=class{constructor(t){b(this,"pendingCanvasMutations",new Map),b(this,"rafStamps",{latestId:0,invokeId:null}),b(this,"mirror"),b(this,"mutationCb"),b(this,"resetObservers"),b(this,"frozen",!1),b(this,"locked",!1),b(this,"processMutation",(a,u)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(a)||this.pendingCanvasMutations.set(a,[]),this.pendingCanvasMutations.get(a).push(u)});let{sampling:r="all",win:n,blockClass:o,blockSelector:i,recordCanvas:s,dataURLOptions:l}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,s&&r==="all"&&this.initCanvasMutationObserver(n,o,i),s&&typeof r=="number"&&this.initCanvasFPSObserver(r,n,o,i,{dataURLOptions:l})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,r,n,o,i){let s=bo(r,n,o,!0),l=new Map,a=new gl;a.onmessage=m=>{let{id:f}=m.data;if(l.set(f,!1),!("base64"in m.data))return;let{base64:v,type:S,width:y,height:g}=m.data;this.mutationCb({id:f,type:$e["2D"],commands:[{property:"clearRect",args:[0,0,y,g]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:v}],type:S}]},0,0]}]})};let u=1e3/t,c=0,d,h=()=>{let m=[];return r.document.querySelectorAll("canvas").forEach(f=>{oe(f,n,o,!0)||m.push(f)}),m},p=m=>{if(c&&m-c<u){d=requestAnimationFrame(p);return}c=m,h().forEach(async f=>{var v;let S=this.mirror.getId(f);if(l.get(S)||f.width===0||f.height===0)return;if(l.set(S,!0),["webgl","webgl2"].includes(f.__context)){let g=f.getContext(f.__context);((v=g?.getContextAttributes())==null?void 0:v.preserveDrawingBuffer)===!1&&g.clear(g.COLOR_BUFFER_BIT)}let y=await createImageBitmap(f);a.postMessage({id:S,bitmap:y,width:f.width,height:f.height,dataURLOptions:i.dataURLOptions},[y])}),d=requestAnimationFrame(p)};d=requestAnimationFrame(p),this.resetObservers=()=>{s(),cancelAnimationFrame(d)}}initCanvasMutationObserver(t,r,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();let o=bo(t,r,n,!1),i=fl(this.processMutation.bind(this),t,r,n),s=pl(this.processMutation.bind(this),t,r,n);this.resetObservers=()=>{o(),i(),s()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){let t=r=>{this.rafStamps.latestId=r,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((t,r)=>{let n=this.mirror.getId(r);this.flushPendingCanvasMutationFor(r,n)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(t,r){if(this.frozen||this.locked)return;let n=this.pendingCanvasMutations.get(t);if(!n||r===-1)return;let o=n.map(s=>{let{type:l,...a}=s;return a}),{type:i}=n[0];this.mutationCb({id:r,type:i,commands:o}),this.pendingCanvasMutations.delete(t)}},Br=class{constructor(t){b(this,"trackedLinkElements",new WeakSet),b(this,"mutationCb"),b(this,"adoptedStyleSheetCb"),b(this,"styleMirror",new Lr),this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,r){"_cssText"in r.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:r.id,attributes:r.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,r){if(t.length===0)return;let n={id:r,styleIds:[]},o=[];for(let i of t){let s;this.styleMirror.has(i)?s=this.styleMirror.getId(i):(s=this.styleMirror.add(i),o.push({styleId:s,rules:Array.from(i.rules||CSSRule,(l,a)=>({rule:To(l,i.href),index:a}))})),n.styleIds.push(s)}o.length>0&&(n.styles=o),this.adoptedStyleSheetCb(n)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}},Hr=class{constructor(){b(this,"nodeMap",new WeakMap),b(this,"active",!1)}inOtherBuffer(t,r){let n=this.nodeMap.get(t);return n&&Array.from(n).some(o=>o!==r)}add(t,r){this.active||(this.active=!0,requestAnimationFrame(()=>{this.nodeMap=new WeakMap,this.active=!1})),this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(r))}destroy(){}},$,Dt,_r,Gt=!1;try{if(Array.from([1],e=>e*2)[0]!==2){let e=document.createElement("iframe");document.body.appendChild(e),Array.from=((oo=e.contentWindow)==null?void 0:oo.Array.from)||Array.from,document.body.removeChild(e)}}catch(e){console.debug("Unable to override Array.from",e)}var fe=sa();function ge(e={}){let{emit:t,checkoutEveryNms:r,checkoutEveryNth:n,blockClass:o="rr-block",blockSelector:i=null,ignoreClass:s="rr-ignore",ignoreSelector:l=null,maskTextClass:a="rr-mask",maskTextSelector:u=null,inlineStylesheet:c=!0,maskAllInputs:d,maskInputOptions:h,slimDOMOptions:p,maskInputFn:m,maskTextFn:f,maskAnchorHrefFn:v,blockImgSrcPattern:S=null,blockImgSrcFillOptions:y={backgroundColor:"#F6F7F9",strokeColor:"#E9EBEF",strokeWidth:"1px"},hooks:g,packFn:T,sampling:I={},dataURLOptions:C={},mousemoveWait:R,recordDOM:E=!0,recordCanvas:L=!1,recordCrossOriginIframes:z=!1,recordAfter:X=e.recordAfter==="DOMContentLoaded"?e.recordAfter:"load",userTriggeredOnInput:U=!1,collectFonts:J=!1,inlineImages:H=!1,plugins:W,keepIframeSrcFn:A=()=>!1,ignoreCSSAttributes:_=new Set([]),errorHandler:Y}=e;$a(Y);let k=z?window.parent===window:!0,D=!1;if(!k)try{window.parent.document&&(D=!1)}catch{D=!0}if(k&&!t)throw new Error("emit function is required");if(!k&&!D)return()=>{};R!==void 0&&I.mousemove===void 0&&(I.mousemove=R),fe.reset();let G=d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:h!==void 0?h:{password:!0},Z=p===!0||p==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:p==="all",headMetaDescKeywords:p==="all",headTitleMutations:p==="all"}:p||{};Ga();let re,se=0,Q=N=>{for(let de of W||[])de.eventProcessor&&(N=de.eventProcessor(N));return T&&!D&&(N=T(N)),N};$=(N,de)=>{var j;let q=N;if(q.timestamp=Wt(),(j=Ne[0])!=null&&j.isFrozen()&&q.type!==P.FullSnapshot&&!(q.type===P.IncrementalSnapshot&&q.data.source===x.Mutation)&&Ne.forEach(me=>me.unfreeze()),k)t?.(Q(q),de);else if(D){let me={type:"rrweb",event:Q(q),origin:window.location.origin,isCheckout:de};window.parent.postMessage(me,"*")}if(q.type===P.FullSnapshot)re=q,se=0;else if(q.type===P.IncrementalSnapshot){if(q.data.source===x.Mutation&&q.data.isAttachIframe)return;se++;let me=n&&se>=n,B=r&&q.timestamp-re.timestamp>r;(me||B)&&Dt(!0)}};let Pe=N=>{$({type:P.IncrementalSnapshot,data:{source:x.Mutation,...N}})},Xe=N=>$({type:P.IncrementalSnapshot,data:{source:x.Scroll,...N}}),Ue=N=>$({type:P.IncrementalSnapshot,data:{source:x.CanvasMutation,...N}}),nr=N=>$({type:P.IncrementalSnapshot,data:{source:x.AdoptedStyleSheet,...N}}),he=new Br({mutationCb:Pe,adoptedStyleSheetCb:nr}),pe=new Fr({mirror:fe,mutationCb:Pe,stylesheetManager:he,recordCrossOriginIframes:z,wrappedEmit:$});for(let N of W||[])N.getMirror&&N.getMirror({nodeMirror:fe,crossOriginIframeMirror:pe.crossOriginIframeMirror,crossOriginIframeStyleMirror:pe.crossOriginIframeStyleMirror});let Fe=new Hr;_r=new Wr({recordCanvas:L,mutationCb:Ue,win:window,blockClass:o,blockSelector:i,mirror:fe,sampling:I.canvas,dataURLOptions:C});let gt=new zr({mutationCb:Pe,scrollCb:Xe,bypassOptions:{blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:u,inlineStylesheet:c,maskInputOptions:G,dataURLOptions:C,maskTextFn:f,maskInputFn:m,maskAnchorHrefFn:v,blockImgSrcPattern:S,blockImgSrcFillOptions:y,recordCanvas:L,inlineImages:H,sampling:I,slimDOMOptions:Z,iframeManager:pe,stylesheetManager:he,canvasManager:_r,keepIframeSrcFn:A,processedNodeManager:Fe},mirror:fe});Dt=(N=!1)=>{if(!E)return;$({type:P.Meta,data:{href:window.location.href,width:Uo(),height:Po()}},N),he.reset(),gt.init(),Ne.forEach(j=>j.lock());let de=Ma(document,{mirror:fe,blockClass:o,blockSelector:i,maskTextClass:a,maskTextSelector:u,inlineStylesheet:c,maskAllInputs:G,maskTextFn:f,maskInputFn:m,maskAnchorHrefFn:v,blockImgSrcPattern:S,blockImgSrcFillOptions:y,slimDOM:Z,dataURLOptions:C,recordCanvas:L,inlineImages:H,onSerialize:j=>{Wo(j,fe)&&pe.addIframe(j),Bo(j,fe)&&he.trackLinkElement(j),Or(j)&&gt.addShadowRoot(M.shadowRoot(j),document)},onIframeLoad:(j,q)=>{pe.attachIframe(j,q),gt.observeAttachShadow(j)},onStylesheetLoad:(j,q)=>{he.attachLinkElement(j,q)},keepIframeSrcFn:A});if(!de)return console.warn("Failed to snapshot the document");$({type:P.FullSnapshot,data:{node:de,initialOffset:Do(window)}},N),Ne.forEach(j=>j.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&he.adoptStyleSheets(document.adoptedStyleSheets,fe.getId(document))};try{let N=[],de=q=>{var me;return O(ll)({mutationCb:Pe,mousemoveCb:(B,or)=>$({type:P.IncrementalSnapshot,data:{source:or,positions:B}}),mouseInteractionCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.MouseInteraction,...B}}),scrollCb:Xe,viewportResizeCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.ViewportResize,...B}}),inputCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.Input,...B}}),mediaInteractionCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.MediaInteraction,...B}}),styleSheetRuleCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.StyleSheetRule,...B}}),styleDeclarationCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.StyleDeclaration,...B}}),canvasMutationCb:Ue,fontCb:B=>$({type:P.IncrementalSnapshot,data:{source:x.Font,...B}}),selectionCb:B=>{$({type:P.IncrementalSnapshot,data:{source:x.Selection,...B}})},customElementCb:B=>{$({type:P.IncrementalSnapshot,data:{source:x.CustomElement,...B}})},blockClass:o,ignoreClass:s,ignoreSelector:l,maskTextClass:a,maskTextSelector:u,maskInputOptions:G,inlineStylesheet:c,sampling:I,recordDOM:E,recordCanvas:L,inlineImages:H,userTriggeredOnInput:U,collectFonts:J,doc:q,maskInputFn:m,maskTextFn:f,maskAnchorHrefFn:v,blockImgSrcPattern:S,blockImgSrcFillOptions:y,keepIframeSrcFn:A,blockSelector:i,slimDOMOptions:Z,dataURLOptions:C,mirror:fe,iframeManager:pe,stylesheetManager:he,shadowDomManager:gt,processedNodeManager:Fe,canvasManager:_r,ignoreCSSAttributes:_,plugins:((me=W?.filter(B=>B.observer))==null?void 0:me.map(B=>({observer:B.observer,options:B.options,callback:or=>$({type:P.Plugin,data:{plugin:B.name,payload:or}})})))||[]},g)};pe.addLoadListener(q=>{try{N.push(de(q.contentDocument))}catch(me){console.warn(me)}});let j=()=>{Dt(),N.push(de(document)),Gt=!0};return document.readyState==="interactive"||document.readyState==="complete"?j():(N.push(ne("DOMContentLoaded",()=>{$({type:P.DomContentLoaded,data:{}}),X==="DOMContentLoaded"&&j()})),N.push(ne("load",()=>{$({type:P.Load,data:{}}),X==="load"&&j()},window))),()=>{N.forEach(q=>q()),Fe.destroy(),Gt=!1,Ya()}}catch(N){console.warn(N)}}ge.addCustomEvent=(e,t)=>{if(!Gt)throw new Error("please add custom event after start recording");$({type:P.Custom,data:{tag:e,payload:t}})};ge.freezePage=()=>{Ne.forEach(e=>e.freeze())};ge.takeFullSnapshot=e=>{if(!Gt)throw new Error("please take full snapshot after start recording");Dt(e)};ge.mirror=fe;var Ro;(function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"})(Ro||(Ro={}));var te=(e=>(e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e))(te||{}),Ce=(e=>(e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e[e.CustomElement=16]="CustomElement",e))(Ce||{}),$r=(e=>(e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e))($r||{});function jt(e,t){if(!t)return;let r=new URL(e),n={};for(let[o,i]of r.searchParams)t.includes(o)&&(n[o]=i);return Object.keys(n).length>0?n:void 0}var yl="Adora.URLChange",Jo="Adora.Cohort",vl="Adora.AddCohort",Sl="Adora.Click";var Yr=["onclick","ondblclick","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onchange","onfocus","onblur","onscroll","onselect","onsubmit","onkeydown","onkeypress","onkeyup","onload","onunload"];function Qo({dom0EventHandlers:e,delay:t,timestamp:r}){return{type:te.Custom,data:{tag:Sl,payload:{dom0EventHandlers:e}},delay:t,timestamp:r}}function ct({payload:e,delay:t,timestamp:r}){return{type:te.Custom,data:{tag:vl,payload:e},delay:t,timestamp:r}}function ei({href:e,delay:t,timestamp:r}){return{type:te.Custom,data:{tag:yl,payload:{href:e}},delay:t,timestamp:r}}function ti(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Zr(e,t){let r="^",n=0;for(;n<e.length;){let o=e[n];if(o==="*")e[n+1]==="*"?(r+=".*",n+=2,n<e.length&&e[n]==="/"&&n++):(r+="[^/]*",n++);else if(o==="?")r+="[^/]",n++;else if(o==="["){let i=e.indexOf("]",n+1);if(i===-1)r+=ti(o),n++;else{let s=e.slice(n+1,i);s.startsWith("!")&&(s=`^${s.slice(1)}`),r+=`[${s}]`,n=i+1}}else r+=ti(o),n++}return t?.partial||(r+="$"),new RegExp(r)}function qt(e,t){return Zr(t).test(e)}function $t(e){throw new Error(`This code path should be unreachable: ${e}`)}function Cl(e){throw new Error(`This code path should be unreachable: ${e}`)}function Ze(e,t){let r=t.replace||t.path;switch(t.type){case"regexp":{let n=(t.path.startsWith("^")?"":"^")+t.path+(!t.path.endsWith("$")&&!t.partial?"$":""),o=new RegExp(n);return o.test(e)?t.partial?e.replace(o,r):r:void 0}case"wildcard":case void 0:if(t.partial){let n=Zr(t.path,{partial:!0});return n.test(e)?e.replace(n,r):void 0}return qt(e,t.path)?r:void 0;default:Cl(t.type)}}function Kr(e){try{return new URL(e),!0}catch{return!1}}function bl(e){return(e.startsWith("http://")||e.startsWith("https://"))&&(e=e.replace(/^https?:\/\//,"")),e.endsWith("/")&&(e=e.substring(0,e.length-1)),e=e.replace(/:\d+$/,""),e}function Yt(e,t){if(!t||t==="")return!1;if(t==="*")return!0;let r=bl(t);return e===r}function ri(e,t){if(Ze(e,t)!==void 0)return t.action!=="block"}function Xr(e,t){let r=e.pathname,n=e.hostname,o=t.rules.filter(s=>Yt(n,s.domain));if(o.length>0){let s=o.find(l=>l.path==="**");if(!s)return t.defaultAction==="allow";for(let l of o){if(l.path==="**")continue;let a=ri(r,l);if(a!==void 0)return a}return s.action==="allow"}let i=t.rules.filter(s=>!s.domain);for(let s of i){let l=ri(r,s);if(l!==void 0)return l}return t.defaultAction==="allow"}function ni(e,t,r){let n=Ze(t,r);if(n!==void 0&&r.action==="replace"){let o=new URL(e.toString());return o.pathname=n,o}}function Jr(e,t){let{pathname:r,hostname:n}=e,o=t.rules.filter(s=>Yt(n,s.domain));if(o.length>0)for(let s of o){if(s.path==="**")continue;let l=ni(e,r,s);if(l)return l}let i=t.rules.filter(s=>!s.domain);for(let s of i){let l=ni(e,r,s);if(l)return l}return e}function ce(e,t){if(!Kr(e))return{accepted:!1};let r=new URL(e);return Xr(r,t)?{accepted:!0,url:Jr(r,t)}:{accepted:!1}}function ut(e,t,r){let n=ce(e,r);if(!n.accepted||!n.url)return e;let{url:o}=n,i=wl(o.pathname,t.rules||[]),s=[];for(let l of o.searchParams.keys()){let a=El(l,i?.rules||[]);switch(a){case"accept":break;case"delete":s.push(l);break;case"anonymize":o.searchParams.set(l,"*");break;default:$t(a)}}for(let l of s)o.searchParams.delete(l);if(o.pathname.includes("%3F")){let l=o.pathname.split("/");l[l.length-1]=l[l.length-1].split("%3F")[0],o.pathname=l.join("/")}return o.hash.includes("=")&&(o.hash=""),o.toString()}function wl(e,t){for(let r of t)if(Ze(e,{path:r.path}))return r}function El(e,t){for(let r of t)if(qt(e,r.param))return r.anonymizeValue?"anonymize":"accept";return"delete"}function Rl(e){typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,0)}var Qr=class{constructor(t,r,n){this.org=t;this.recorder=r;this.events=[];this._estimatedByteSize=0;this._pendingEvents=[];this._sizeUpdateScheduled=!1;this.events=n,this._estimatedByteSize+=this.calculateEventsSize(n)}get estimatedByteSize(){return this._estimatedByteSize}calculateEventsSize(t){try{let r=JSON.stringify(t,this.getCircularReplacer());return Il(r)}catch(r){return w(`Error calculating event size: ${r}. Falling back to approximation.`),500}}getCircularReplacer(){let t=new WeakSet;return(r,n)=>{if(typeof n=="object"&&n!==null){if(t.has(n))return;t.add(n)}return n}}clearEvents(){this.events=[],this._estimatedByteSize=0,this._pendingEvents=[],this._sizeUpdateScheduled=!1}pushEvent({eventHref:t,event:r}){if(!ce(t,this.org.pathConfig).accepted){w(`URL not accepted: ${t}`);return}if(!this.recorder.isRecording){w("Dropping event - recorder is not recording");return}this.events.push(r),this._pendingEvents.push(r),this._sizeUpdateScheduled||(this._sizeUpdateScheduled=!0,Rl(()=>{this._estimatedByteSize+=this.calculateEventsSize(this._pendingEvents),this._pendingEvents=[],this._sizeUpdateScheduled=!1}))}getEvents(){return this.events}},Zt=class{constructor(t,r,n,o,i){this.org=t;this.eventStorage=r;this.getHref=n;this.eventStore=new Qr(t,o,i)}get estimatedSerializedByteSize(){return this.eventStore.estimatedByteSize}clear(){this.eventStore.clearEvents(),this.eventStorage.removeEvents()}getEvents(){return this.eventStore.getEvents()}onVisibilityChange(t){t||this.eventStorage.setEvents(this.getEvents())}append(t){let r=this.getHref();if(t.type===te.Meta)t.data.href=ut(t.data.href,this.org.allowedQueryParams,this.org.pathConfig),this.lastHref=this.getHref();else if(this.lastHref&&r!==this.lastHref){w(`URL changed from ${this.lastHref} to ${r}, adding artificial meta event for ${this.getHref()}`),this.eventStore.pushEvent({eventHref:r,event:ei({href:ut(r,this.org.allowedQueryParams,this.org.pathConfig),delay:t.delay,timestamp:t.timestamp})});let n=jt(r,this.org.customQueryParamsCohorts);n&&this.eventStore.pushEvent({eventHref:r,event:ct({payload:{userCohorts:n,source:"query_params"},timestamp:t.timestamp,delay:t.delay})}),this.lastHref=this.getHref()}if(t.type===te.IncrementalSnapshot&&t.data.source===Ce.MouseInteraction&&t.data.type===$r.Click){let n=ge.mirror.getNode(t.data.id);if(n){let o=en(n),i=Qo({dom0EventHandlers:o,delay:t.delay,timestamp:t.timestamp});this.eventStore.pushEvent({eventHref:r,event:i})}}this.eventStore.pushEvent({eventHref:r,event:t})}};function Il(e){return new Blob([e]).size}function en(e){let t=[];for(let r=0;r<Yr.length;r++){let o=Yr[r];typeof e[o]=="function"&&t.push(o)}return t}var ue=Uint8Array,ie=Uint16Array,pt=Uint32Array,an=new ue([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ln=new ue([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),oi=new ue([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),li=function(e,t){for(var r=new ie(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var o=new pt(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)o[i]=i-r[n]<<5|n;return[r,o]},ci=li(an,2),Al=ci[0],rn=ci[1];Al[28]=258,rn[258]=28;var ui=li(ln,0),du=ui[0],ii=ui[1],nn=new ie(32768);for(F=0;F<32768;++F)be=(F&43690)>>>1|(F&21845)<<1,be=(be&52428)>>>2|(be&13107)<<2,be=(be&61680)>>>4|(be&3855)<<4,nn[F]=((be&65280)>>>8|(be&255)<<8)>>>1;var be,F,ht=function(e,t,r){for(var n=e.length,o=0,i=new ie(t);o<n;++o)++i[e[o]-1];var s=new ie(t);for(o=0;o<t;++o)s[o]=s[o-1]+i[o-1]<<1;var l;if(r){l=new ie(1<<t);var a=15-t;for(o=0;o<n;++o)if(e[o])for(var u=o<<4|e[o],c=t-e[o],d=s[e[o]-1]++<<c,h=d|(1<<c)-1;d<=h;++d)l[nn[d]>>>a]=u}else for(l=new ie(n),o=0;o<n;++o)l[o]=nn[s[e[o]-1]++]>>>15-e[o];return l},Le=new ue(288);for(F=0;F<144;++F)Le[F]=8;var F;for(F=144;F<256;++F)Le[F]=9;var F;for(F=256;F<280;++F)Le[F]=7;var F;for(F=280;F<288;++F)Le[F]=8;var F,Kt=new ue(32);for(F=0;F<32;++F)Kt[F]=5;var F,Tl=ht(Le,9,0);var kl=ht(Kt,5,0);var di=function(e){return(e/8>>0)+(e&7&&1)},fi=function(e,t,r){(r==null||r>e.length)&&(r=e.length);var n=new(e instanceof ie?ie:e instanceof pt?pt:ue)(r-t);return n.set(e.subarray(t,r)),n};var we=function(e,t,r){r<<=t&7;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8},dt=function(e,t,r){r<<=t&7;var n=t/8>>0;e[n]|=r,e[n+1]|=r>>>8,e[n+2]|=r>>>16},tn=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var o=r.length,i=r.slice();if(!o)return[new ue(0),0];if(o==1){var s=new ue(r[0].s+1);return s[r[0].s]=1,[s,1]}r.sort(function(I,C){return I.f-C.f}),r.push({s:-1,f:25001});var l=r[0],a=r[1],u=0,c=1,d=2;for(r[0]={s:-1,f:l.f+a.f,l,r:a};c!=o-1;)l=r[r[u].f<r[d].f?u++:d++],a=r[u!=c&&r[u].f<r[d].f?u++:d++],r[c++]={s:-1,f:l.f+a.f,l,r:a};for(var h=i[0].s,n=1;n<o;++n)i[n].s>h&&(h=i[n].s);var p=new ie(h+1),m=on(r[c-1],p,0);if(m>t){var n=0,f=0,v=m-t,S=1<<v;for(i.sort(function(C,R){return p[R.s]-p[C.s]||C.f-R.f});n<o;++n){var y=i[n].s;if(p[y]>t)f+=S-(1<<m-p[y]),p[y]=t;else break}for(f>>>=v;f>0;){var g=i[n].s;p[g]<t?f-=1<<t-p[g]++-1:++n}for(;n>=0&&f;--n){var T=i[n].s;p[T]==t&&(--p[T],++f)}m=t}return[new ue(p),m]},on=function(e,t,r){return e.s==-1?Math.max(on(e.l,t,r+1),on(e.r,t,r+1)):t[e.s]=r},si=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ie(++t),n=0,o=e[0],i=1,s=function(a){r[n++]=a},l=1;l<=t;++l)if(e[l]==o&&l!=t)++i;else{if(!o&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(o),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(o);i=1,o=e[l]}return[r.subarray(0,n),t]},ft=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},sn=function(e,t,r){var n=r.length,o=di(t+2);e[o]=n&255,e[o+1]=n>>>8,e[o+2]=e[o]^255,e[o+3]=e[o+1]^255;for(var i=0;i<n;++i)e[o+i+4]=r[i];return(o+4+n)*8},ai=function(e,t,r,n,o,i,s,l,a,u,c){we(t,c++,r),++o[256];for(var d=tn(o,15),h=d[0],p=d[1],m=tn(i,15),f=m[0],v=m[1],S=si(h),y=S[0],g=S[1],T=si(f),I=T[0],C=T[1],R=new ie(19),E=0;E<y.length;++E)R[y[E]&31]++;for(var E=0;E<I.length;++E)R[I[E]&31]++;for(var L=tn(R,7),z=L[0],X=L[1],U=19;U>4&&!z[oi[U-1]];--U);var J=u+5<<3,H=ft(o,Le)+ft(i,Kt)+s,W=ft(o,h)+ft(i,f)+s+14+3*U+ft(R,z)+(2*R[16]+3*R[17]+7*R[18]);if(J<=H&&J<=W)return sn(t,c,e.subarray(a,a+u));var A,_,Y,k;if(we(t,c,1+(W<H)),c+=2,W<H){A=ht(h,p,0),_=h,Y=ht(f,v,0),k=f;var D=ht(z,X,0);we(t,c,g-257),we(t,c+5,C-1),we(t,c+10,U-4),c+=14;for(var E=0;E<U;++E)we(t,c+3*E,z[oi[E]]);c+=3*U;for(var G=[y,I],Z=0;Z<2;++Z)for(var re=G[Z],E=0;E<re.length;++E){var se=re[E]&31;we(t,c,D[se]),c+=z[se],se>15&&(we(t,c,re[E]>>>5&127),c+=re[E]>>>12)}}else A=Tl,_=Le,Y=kl,k=Kt;for(var E=0;E<l;++E)if(n[E]>255){var se=n[E]>>>18&31;dt(t,c,A[se+257]),c+=_[se+257],se>7&&(we(t,c,n[E]>>>23&31),c+=an[se]);var Q=n[E]&31;dt(t,c,Y[Q]),c+=k[Q],Q>3&&(dt(t,c,n[E]>>>5&8191),c+=ln[Q])}else dt(t,c,A[n[E]]),c+=_[n[E]];return dt(t,c,A[256]),c+_[256]},_l=new pt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Ml=function(e,t,r,n,o,i){var s=e.length,l=new ue(n+s+5*(1+Math.floor(s/7e3))+o),a=l.subarray(n,l.length-o),u=0;if(!t||s<8)for(var c=0;c<=s;c+=65535){var d=c+65535;d<s?u=sn(a,u,e.subarray(c,d)):(a[c]=i,u=sn(a,u,e.subarray(c,s)))}else{for(var h=_l[t-1],p=h>>>13,m=h&8191,f=(1<<r)-1,v=new ie(32768),S=new ie(f+1),y=Math.ceil(r/3),g=2*y,T=function(N){return(e[N]^e[N+1]<<y^e[N+2]<<g)&f},I=new pt(25e3),C=new ie(288),R=new ie(32),E=0,L=0,c=0,z=0,X=0,U=0;c<s;++c){var J=T(c),H=c&32767,W=S[J];if(v[H]=W,S[J]=H,X<=c){var A=s-c;if((E>7e3||z>24576)&&A>423){u=ai(e,a,0,I,C,R,L,z,U,c-U,u),z=E=L=0,U=c;for(var _=0;_<286;++_)C[_]=0;for(var _=0;_<30;++_)R[_]=0}var Y=2,k=0,D=m,G=H-W&32767;if(A>2&&J==T(c-G))for(var Z=Math.min(p,A)-1,re=Math.min(32767,c),se=Math.min(258,A);G<=re&&--D&&H!=W;){if(e[c+Y]==e[c+Y-G]){for(var Q=0;Q<se&&e[c+Q]==e[c+Q-G];++Q);if(Q>Y){if(Y=Q,k=G,Q>Z)break;for(var Pe=Math.min(G,Q-2),Xe=0,_=0;_<Pe;++_){var Ue=c-G+_+32768&32767,nr=v[Ue],he=Ue-nr+32768&32767;he>Xe&&(Xe=he,W=Ue)}}}H=W,W=v[H],G+=H-W+32768&32767}if(k){I[z++]=268435456|rn[Y]<<18|ii[k];var pe=rn[Y]&31,Fe=ii[k]&31;L+=an[pe]+ln[Fe],++C[257+pe],++R[Fe],X=c+Y,++E}else I[z++]=e[c],++C[e[c]]}}u=ai(e,a,i,I,C,R,L,z,U,c-U,u)}return fi(l,0,n+di(u)+o)},xl=function(){var e=1,t=0;return{p:function(r){for(var n=e,o=t,i=r.length,s=0;s!=i;){for(var l=Math.min(s+5552,i);s<l;++s)n+=r[s],o+=n;n%=65521,o%=65521}e=n,t=o},d:function(){return(e>>>8<<16|(t&255)<<8|t>>>8)+((e&255)<<23)*2}}},Nl=function(e,t,r,n,o){return Ml(e,t.level==null?6:t.level,t.mem==null?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):12+t.mem,r,n,!o)},Ol=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Ll=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;e[0]=120,e[1]=n<<6|(n?32-2*n:1)};function hi(e,t){t===void 0&&(t={});var r=xl();r.p(e);var n=Nl(e,t,2,4);return Ll(n,t),Ol(n,n.length-4,r.d()),n}function cn(e,t){var r=e.length;if(!t&&typeof TextEncoder<"u")return new TextEncoder().encode(e);for(var n=new ue(e.length+(e.length>>>1)),o=0,i=function(u){n[o++]=u},s=0;s<r;++s){if(o+5>n.length){var l=new ue(o+8+(r-s<<1));l.set(n),n=l}var a=e.charCodeAt(s);a<128||t?i(a):a<2048?(i(192|a>>>6),i(128|a&63)):a>55295&&a<57344?(a=65536+(a&1047552)|e.charCodeAt(++s)&1023,i(240|a>>>18),i(128|a>>>12&63),i(128|a>>>6&63),i(128|a&63)):(i(224|a>>>12),i(128|a>>>6&63),i(128|a&63))}return fi(n,0,o)}function un(e,t){var r="";if(!t&&typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var n=0;n<e.length;){var o=e[n++];o<128||t?r+=String.fromCharCode(o):o<224?r+=String.fromCharCode((o&31)<<6|e[n++]&63):o<240?r+=String.fromCharCode((o&15)<<12|(e[n++]&63)<<6|e[n++]&63):(o=((o&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,r+=String.fromCharCode(55296|o>>10,56320|o&1023))}return r}var dn="v1";var fn=e=>{let t={...e,v:dn};return un(hi(cn(JSON.stringify(t))),!0)};function pi(e){let t=new URL(e),r={};for(let[n,o]of t.searchParams)switch(n){case"utm_source":case"utm_medium":case"utm_campaign":case"utm_term":case"utm_content":r[`UTM@@${n}`]=o;break}return Object.keys(r).length>0?r:void 0}var mi=3*1024*1024,gi=5e3,Xt=class{constructor(t,r,n,o,i,s,l){this.window=t;this.storage=r;this.eventHolder=n;this.recorder=o;this.api=i;this.organization=s;this.windowGetters=l;this.lastSendTime=-1;this.lastAutoCohorts=void 0;this.fastpathToken=void 0;this.isSending=!1;o.setOnEvent(a=>this.onEvent(a))}onEvent(t){if(t.type===te.FullSnapshot){let i,s=_t(this.window,this.organization.cohortsBootstrapConfig),l=pi(this.windowGetters.getHref()),a=jt(this.windowGetters.getHref(),this.organization.customQueryParamsCohorts),u=wr(this.window);this.lastAutoCohorts=u,(l||s||u||a)&&(i=ct({payload:{userCohorts:{...s||{},...u||{},...l||{},...a||{}},source:"window_getters"},delay:t.delay,timestamp:t.timestamp})),i&&this.eventHolder.append(i),this.eventHolder.append(t),this.clearAndSaveEvents();return}else if(t.type===te.IncrementalSnapshot&&t.data.source===Ce.Mutation){let i=wr(this.window);i&&(!this.lastAutoCohorts||Object.keys(i).length!==Object.keys(this.lastAutoCohorts).length)&&(w("auto cohorts different, appending new event",i),this.eventHolder.append(ct({payload:{userCohorts:i,source:"window_getters"},delay:t.delay,timestamp:t.timestamp}))),this.lastAutoCohorts=i}this.eventHolder.append(t);let r=this.eventHolder.estimatedSerializedByteSize,o=Date.now()-this.lastSendTime;r>mi&&o>=gi&&(w(`MAX_EVENT_BYTE_SIZE and timeSinceLastSend exceeded: ${r} > ${mi} and ${o} >= ${gi}`),this.clearAndSaveEvents())}async clearAndSaveEvents(t){if(this.isSending)return;let r=this.windowGetters.getHref();if(!ce(r,this.organization.pathConfig).accepted)return;let o=t||this.eventHolder.getEvents();if(o.length!==0){this.isSending=!0,this.eventHolder.clear();try{w("saving events...");let i=await this.prepareAndSendEvents(o);switch(w("save events result",i.type),i.type){case"success":break;case"recreate-session":await this.recreateSession(i.session);break;case"no-session":this.storage.removeSession(),this.eventHolder.clear();break;case"unknown-failure":w("unknown failure sending events, will retry");break;case"rate-limit-exceeded":this.storage.removeSession(),this.eventHolder.clear();break;default:$t(i)}}catch(i){w("error saving events",i)}finally{this.isSending=!1}}}async prepareAndSendEvents(t){this.lastSendTime=Date.now();let r=this.storage.getSession();if(!r)return{type:"no-session"};if(r.eventPostUrl&&r.eventPostToken){let i=JSON.parse(atob(r.eventPostToken.split(".")[1]));if(i&&Date.now()>i.lastEventAt-10*1e3){w("refreshing token as it is about to expire");let s=await this.refreshToken(r);if(s.type!=="success")return s;if(r=this.storage.getSession(),!r)return{type:"no-session"}}}let n=r.compressionType==="RRWEB_PACK"?t.map(i=>fn(i)):t,o=await this.api.saveSessionEvents({sessionId:r.id,events:n,metadata:{url:ut(this.windowGetters.getHref(),this.organization.allowedQueryParams,this.organization.pathConfig)},eventPostUrl:r.eventPostUrl,eventPostToken:r.eventPostToken,fastpathToken:this.fastpathToken});if(!o)return{type:"unknown-failure"};if(o.error)switch(o.error.code){case"SessionNotFound":case"SessionAlreadySynced":return{type:"recreate-session",session:r};case"RateLimitExceeded":return{type:"rate-limit-exceeded"}}if(!o.data)return{type:"unknown-failure"};if(o.data&&"code"in o.data)switch(o.data.code){case"TOKEN_REFRESH":{w("refreshing token as it expired on the worker");let i=await this.refreshToken(r);return i.type!=="success"?i:this.prepareAndSendEvents(t)}}if(this.fastpathToken=o.data.fastpathToken,o.response.status<200||o.response.status>201)throw new Error(`got status ${o.response.status}`);return{type:"success"}}async refreshToken(t){let r=await this.api.refreshEventToken({sessionId:t.id});if(!r)return{type:"unknown-failure"};if(r.error)switch(r.error.code){case"SessionNotFound":case"SessionAlreadySynced":return{type:"recreate-session",session:t};case"RateLimitExceeded":return{type:"rate-limit-exceeded"}}return r.data?(this.storage.setSession({...t,eventPostToken:r.data.token}),{type:"success"}):{type:"unknown-failure"}}async recreateSession(t){w("recreating sessions");let r=this.recorder.isRecording;this.recorder.setRecording(!1),this.storage.removeSession(),this.fastpathToken=void 0;try{w("recreating session...");let n=await this.api.startSession({orgId:t.settings.orgId,language:t.settings.language||this.windowGetters.getLanguage(),domain:new URL(this.windowGetters.getHref()).hostname,userCohorts:t.settings.userCohorts||{},uid:t.settings.uid,devicePixelRatio:this.windowGetters.getDevicePixelRatio(),adoraUserId:t.adoraUserId,documentReferrer:t.documentReferrer,snippetVersion:It});if(!n||n.error)return;if(n.response.status!==201){w("session not created, aborting");return}if(!n.data||!("session"in n.data)){w("malformed session, exiting");return}let o=Rt(n.data),i=zn(t,o);this.storage.setSession(i),this.eventHolder.clear(),r&&this.recorder.setRecording(!0)}catch{}}};var Qt=class{constructor(t){this._options=t;this._buckets={};this._refillBuckets=()=>{Object.keys(this._buckets).forEach(t=>{let r=this._getBucket(t)+this._refillRate;r>=this._bucketSize?delete this._buckets[t]:this._setBucket(t,r)})};this._getBucket=t=>this._buckets[String(t)];this._setBucket=(t,r)=>{this._buckets[String(t)]=r};this.consumeRateLimit=t=>{let r=this._getBucket(t)??this._bucketSize;if(r=Math.max(r-1,0),r===0)return!0;this._setBucket(t,r);let n=r===0;return n&&this._onBucketRateLimited?.(t),n};this._onBucketRateLimited=this._options._onBucketRateLimited,this._bucketSize=Jt(this._options.bucketSize,0,100),this._refillRate=Jt(this._options.refillRate,0,this._bucketSize),this._refillInterval=Jt(this._options.refillInterval,0,864e5),this._removeInterval=setInterval(()=>{this._refillBuckets()},this._refillInterval)}stop(){this._removeInterval&&(clearInterval(this._removeInterval),this._removeInterval=void 0)}};function Jt(e,t,r,n){return t>r&&(t=r),Dl(e)?e>r?r:e<t?t:e:Jt(n||r,t,r)}var Dl=e=>toString.call(e)==="[object Number]";var er=class{constructor(t,r={}){this._rrweb=t;this._options=r;this._loggedTracker={};this._onNodeRateLimited=t=>{if(!this._loggedTracker[t]){this._loggedTracker[t]=!0;let r=this._getNode(t);this._options.onBlockedNode?.(t,r)}};this._getNodeOrRelevantParent=t=>{let r=this._getNode(t);if(r?.nodeName!=="svg"&&r instanceof Element){let n=r.closest("svg");if(n)return[this._rrweb.mirror.getId(n),n]}return[t,r]};this._getNode=t=>this._rrweb.mirror.getNode(t);this._numberOfChanges=t=>(t.removes?.length??0)+(t.attributes?.length??0)+(t.texts?.length??0)+(t.adds?.length??0);this.throttleMutations=t=>{if(t.type!==te.IncrementalSnapshot||t.data.source!==Ce.Mutation)return t;let r=t.data,n=this._numberOfChanges(r);r.attributes&&(r.attributes=r.attributes.filter(i=>{let[s]=this._getNodeOrRelevantParent(i.id);return this._rateLimiter.consumeRateLimit(s)?!1:i}));let o=this._numberOfChanges(r);if(!(o===0&&n!==o))return t};this._rateLimiter=new Qt({bucketSize:this._options.bucketSize??100,refillRate:this._options.refillRate??10,refillInterval:1e3,_onBucketRateLimited:this._onNodeRateLimited})}reset(){this._loggedTracker={}}stop(){this._rateLimiter.stop(),this.reset()}};var Ke,yi=()=>{if(Ke!==void 0)return Ke;try{return Ke=document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0,w("adora script - isWebpSupported? - ",Ke),Ke}catch{return Ke=!1,!1}};function Pl(e){return JSON.stringify(e,(t,r)=>{if(!(t==="id"||t==="parentId"||t==="nextId"))return r})}var tr=class{constructor(t,r,n,o){this.limitedCanvasRecording=t;this.canvasRecordingEnabled=r;this.org=n;this.rrwebRecorder=o;this.startable=!0;this.lastMutationFingerprint=null;w("new recorder")}setOnEvent(t){this.onEvent=t}get args(){let t=this.org.blockedCSSClasses.length>0?`|(${this.org.blockedCSSClasses.join(")|(")})`:"",r=this.org.maskedCSSClasses&&this.org.maskedCSSClasses?.length>0?`|(${this.org.maskedCSSClasses?.join(")|(")})`:"",n=yi()?"image/webp":this.limitedCanvasRecording?"image/jpeg":"image/png";return{emit:o=>{if(!this.onEvent)throw new Error("onEvent must be assigned before starting recording");if(o.type===te.FullSnapshot&&(this.mutationThrottler?.reset(),this.lastMutationFingerprint=null),o.type===te.IncrementalSnapshot&&o.data.source===Ce.Mutation){let s=o.data;if(s.adds&&s.adds.length>0){let l=Pl(o.data);if(this.lastMutationFingerprint===l){w("dropping duplicate mutation event (Safari workaround)");return}this.lastMutationFingerprint=l}}let i=this.mutationThrottler?this.mutationThrottler.throttleMutations(o):o;i&&this.onEvent(i)},userTriggeredOnInput:!0,blockClass:new RegExp(`(adora-block)|(rr-block|fs-exclude|ph-no-capture)${t}`),blockSelector:"[data-adora-block]",maskTextClass:new RegExp(`(adora-mask)|(rr-mask|fs-mask)${r}`),maskAllInputs:!0,maskInputFn:(o,i)=>vi(this.org,i)?o:"*".repeat(o.length),maskTextFn:(o,i)=>i&&this.org.maskByDefault&&i.closest('button,a,div[role="button"],div[role*="menuitem"],input[type="button"],input[type="submit"],input[type="reset"]')||i&&vi(this.org,i)?o:o.replace(/[\S]/g,"*"),maskTextSelector:this.org?.maskByDefault?"*":'[data-adora-mask="true"]',recordCanvas:this.canvasRecordingEnabled,sampling:this.canvasRecordingEnabled?{canvas:this.limitedCanvasRecording?1:2}:void 0,dataURLOptions:this.canvasRecordingEnabled?{type:n,quality:.6}:{}}}recordChangeCustomCohort(t){w("sending custom cohort change",t),this.rrwebRecorder.addCustomEvent(Jo,t)}recordCLS(t){this.rrwebRecorder.addCustomEvent("CLS",t)}recordINP(t){this.rrwebRecorder.addCustomEvent("INP",t)}recordLCP(t){this.rrwebRecorder.addCustomEvent("LCP",t)}recordVisibilityChange(t){this.rrwebRecorder.addCustomEvent("Adora.VisibilityChange",{visibilityState:t})}recordFocusChange(t){this.rrwebRecorder.addCustomEvent("Adora.FocusChange",{focusState:t})}get isRecording(){return this.rrwebRecorder.isRecording}setRecording(t){if(w("setRecording",`requested status: ${t}`,`current status ${this.rrwebRecorder.isRecording}`),this.rrwebRecorder.isRecording!==t){if(t){this.startRecording();return}this.stopRecording()}}startRecording(){if(this.isRecording)throw new Error("recording already in progress!");if(!this.startable){w("recorder is not startable, returning");return}this.mutationThrottler=new er(this.rrwebRecorder,{bucketSize:100,refillRate:10,onBlockedNode:(t,r)=>{w("mutation throttler blocked node",{id:t,node:r})}}),this.rrwebRecorder.record(this.args)}stopRecording(){this.mutationThrottler?.stop(),this.mutationThrottler=void 0,this.lastMutationFingerprint=null,this.rrwebRecorder.stop()}stopFutureRecordings(){this.startable=!1}};function vi(e,t){if(t.classList.contains("adora-mask-element"))return!1;if(t.classList.contains("adora-unmask-element"))return!0;let r=t.closest(".adora-unmask"),n=t.closest("[data-adora-unmask]"),o=t.closest(".adora-mask"),i=null;if(r&&n?i=r.contains(n)?n:r:i=r||n,i&&(!o||o.contains(i)))return!0;for(let s of e.unmaskSelectors){let l=t.closest(s);if(l&&(!o||o.contains(l)))return!0}return!1}var rr=class{constructor(){this._isRecording=!1}get isRecording(){return this._isRecording}get mirror(){return ge.mirror}record(t){if(w("record",{stopFn:typeof this.stopFn,isRecording:this._isRecording}),this.stopFn!==void 0&&this.stop(),this._isRecording=!0,this.stopFn=ge(t),!this.stopFn)throw new Error("recorder could not successfully start")}stop(){this._isRecording=!1,this.stopFn&&(this.stopFn(),this.stopFn=void 0)}addCustomEvent(t,r){if(!this._isRecording)return w("WARNING! attempting to add custom event with recording off"),!1;try{ge.addCustomEvent(t,r)}catch(n){return w("trying to record an event even though",n),!1}return!0}};var Si=5e3;function Ci({sessionType:e}){w("initialize recording");let t=new Ie(e,new ve),r=t.getSession();if(!r)return;let n=Ee(r.settings.backendRegion||"ap-southeast-2"),o=new Et(e,new ve),i=o.getEvents();o.removeEvents();let s=()=>window.location.href,l=()=>window.navigator.language,a=()=>window.devicePixelRatio,u=new rr,c=new tr(r.limitedCanvasRecording??!1,r.canvasRecordingEnabled??!1,r.organization,u),d=new Zt(r.organization,o,s,c,i||[]),h=new Xt(window,t,d,c,n,r.organization,{getHref:s,getLanguage:l,getDevicePixelRatio:a}),p=window.location.href;ce(p,r.organization.pathConfig).accepted?(w("starting recording..."),c.setRecording(!0)):w("recording did not start as current URL is blocked");let f=_t(window,r.organization.cohortsBootstrapConfig);c.isRecording&&(c.recordChangeCustomCohort({uid:r.settings.uid,userCohorts:r.settings.userCohorts?{...f,...r.settings.userCohorts}:{}}),t.setSession(r)),Xn(I=>{c.isRecording&&c.recordCLS(I)}),eo(I=>{c.isRecording&&c.recordINP(I)}),to(I=>{c.isRecording&&c.recordLCP(I)});let v=()=>{h.clearAndSaveEvents(d.getEvents())},S=window.setInterval(v,Si);window.addEventListener("blur",()=>{c.recordFocusChange("blur")}),window.addEventListener("focus",()=>{c.recordFocusChange("focus")}),document.addEventListener("visibilitychange",()=>{if(w(`detected a visibility change to ${document.visibilityState}`),c.isRecording&&c.recordVisibilityChange(document.visibilityState),document.visibilityState==="hidden"){S&&(w("clearing the saveInterval"),clearInterval(S),S=void 0),d.onVisibilityChange(!1);return}S||(w("resuming the saveInterval"),S=window.setInterval(v,Si))});let y=p,g=new MutationObserver(()=>{if(d&&window.location.href!==y){let I=ce(window.location.href,r.organization.pathConfig);w(`url changed detected, status: ${I.accepted}`),c.setRecording(I.accepted),y=window.location.href}});return g.observe(document,{subtree:!0,childList:!0}),{recorder:c,eventSync:h,urlChangeObserverDispose:()=>{g.disconnect()}}}var bi=e=>Ci(e);var De=!1,wi="_adora_user_id",Ei="_adora_rate_limited",ye,mt,hn="stopped",Ri=()=>{w("startRecording",`adoraIsRunning: ${De}`),hn==="started"&&(ye=bi({sessionType:"adoraSessionScript"}))},Ii=1e3*60*30,Ul=async({properties:e,userCohorts:t,...r})=>{let n=r;hn="started";let o={...t||{},...e||{}};if(w("adora start",{adoraIsRunning:De,uid:n.uid,userCohorts:o}),typeof window.sessionStorage!="object"){w("SSR detected");return}if(Object.keys(o).length>0){n.userCohorts={};for(let[d,h]of Object.entries(o))h!==void 0?n.userCohorts[d]=h:w("found undefined user cohorts key",{key:d})}let i=new Ie("adoraSessionScript",new ve),s=i.getSession();if(s){w("session detected; finding if changes should be written");let d=!1;if(n.uid&&s.settings.uid!==n.uid&&(w("detected uid change"),s.settings.uid=n.uid,i.setSession(s),d=!0),n.userCohorts&&Object.keys(n.userCohorts).length>0){w("detected user cohorts");let h=structuredClone(s.settings.userCohorts);On(h,n.userCohorts)||(w("detected user cohorts have been changed"),s.settings.userCohorts=n.userCohorts,i.setSession(s),d=!0)}d&&ye?.recorder&&ye?.recorder.isRecording&&(w("writing cohort change to recorder"),ye?.recorder.recordChangeCustomCohort({uid:s.settings.uid,userCohorts:s.settings.userCohorts?{...s.settings.userCohorts}:{}}))}let l=window;if(De===!0||l.__adora_running__===!0)return;De=!0,l.__adora_running__=!0;let a=i.lastRateLimitedTimestamp;if(a!==void 0){if(Date.now()-a<Ii){w("exiting as the session has been rate limited recently");return}i.clearLastRateLimitedTimestamp()}if(Qe.get(Ei)){w("exiting as the domain has been rate limited recently");return}if(s){w("start recording for existing session"),Ri();return}let u=!1,c=async(d,h)=>{if(w("start status",{started:u,region:n.backendRegion}),u)return;u=!0;let p=await Wn("adoraSessionScript",h,n);if(p.type==="error"){p.code==="RateLimitExceeded"&&(w("setting expiration on local storage"),i.setLastRateLimitedTimestamp(Date.now()),d&&(w("setting expiration cookie"),Qe.set(Ei,d,{expires:new Date(Date.now()+Ii),domain:d})));return}Ri()};w("launching session preload");try{let h=await(n.backendUrl?new ze(n.backendUrl):Ee(n.backendRegion||"ap-southeast-2")).getOrganizationRouting({orgId:n.orgId});if(!h||h.error){w("error getting organization routing");return}w("got region",h.data.region),n.backendRegion=h.data.region;let m=await Ee(n.backendRegion||"ap-southeast-2").sessionPreload({orgId:n.orgId});w("session preload resolved");let f=window.location.href;if(m){if(m.error){w("error preloading",m.error);return}let v=Un(m.data);if("scheduledDowntime"in v){w("scheduled downtime; exiting");return}let{organization:S}=v;w("session preload success");let y=Qe.get(wi),g;w("existing adora user id cookie:",y);for(let I of S.cookieDomains)(window.location.hostname.toLowerCase()===I||window.location.hostname.toLowerCase().endsWith(`.${I}`))&&(g=I,y||(y=Dn(),Qe.set(wi,y,{domain:I,expires:new Date(Date.now()+365*24*60*60*1e3)}),w("setting adoraUserId cookie on domain",y)));w("using adora user id:",y),ce(f,S.pathConfig).accepted?(w("at an unblocked URL, starting adora"),await c(g,y)):(w("at an blocked URL, waiting for unblocked URL to start adora"),mt&&mt.disconnect(),mt=new MutationObserver((I,C)=>{if(f!==window.location.href){let R=window.location.href,E=ce(R,S.pathConfig);if(w(`url changed detected during blocked state, status: ${E.accepted}`),E.accepted){w("disconnecting observer"),C.disconnect(),w("scheduling adora to start"),c(g,y);return}f=R}}),mt.observe(document,{subtree:!0,childList:!0}))}}catch(d){w("Error in adoraStart:",d)}},Fl=async()=>{hn="stopped",w("adora stop",{adoraIsRunning:De}),ye&&(ye.recorder.setRecording(!1),ye.recorder.stopFutureRecordings(),ye.urlChangeObserverDispose(),await ye.eventSync.clearAndSaveEvents()),mt?.disconnect(),De=!1,window.__adora_running__=!1,ye=void 0};return Ni(zl);})();
/*! Bundled license information:

js-cookie/dist/js.cookie.mjs:
  (*! js-cookie v3.0.5 | MIT *)

uuidv7/dist/index.js:
  (**
   * uuidv7: A JavaScript implementation of UUID version 7
   *
   * Copyright 2021-2024 LiosK
   *
   * @license Apache-2.0
   * @packageDocumentation
   *)
*/
// Expose functions directly on window (not under a namespace)
if (typeof window !== 'undefined' && window.__adoraExports__) {
  window.adoraStart = window.__adoraExports__.adoraStart;
  window.adoraStop = window.__adoraExports__.adoraStop;
  // Use getter to create reactive reference to adoraIsRunning
  Object.defineProperty(window, 'adoraIsRunning', {
    get: function() {
      return window.__adoraExports__.adoraIsRunning;
    },
    configurable: true
  });
}
//# sourceMappingURL=adora-start.temp.js.map
